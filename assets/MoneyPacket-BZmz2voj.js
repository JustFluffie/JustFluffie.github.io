import{a6 as E,r as d,_ as R,c as b,x as U,G as $,a7 as D,y as K,k as L,f as c,o as r,g as T,i as P,d as u,e as t,S as q,t as v,U as G,n as B,w as H,A as O,O as W,a1 as j,T as J}from"./index-BP9G-Bgn.js";const me=E("chat-wallet",()=>{const n=d(0);return{balance:n,recharge:s=>{const a=parseFloat(s);return!isNaN(a)&&a>0?(n.value+=a,!0):!1},consume:s=>{const a=parseFloat(s);return!isNaN(a)&&a>0&&n.value>=a?(n.value-=a,!0):!1},income:s=>{const a=parseFloat(s);return!isNaN(a)&&a>0?(n.value+=a,!0):!1}}},{persist:!0}),Q={key:0,class:"transfer-modal"},X={class:"app-header transfer-header"},Y={class:"title"},Z={key:0,class:"target-section"},_={class:"target-info"},ee={class:"target-text"},te={class:"transfer-to"},se=["src"],ae={key:1,class:"target-avatar-placeholder"},ne={key:1,class:"target-section",style:{visibility:"hidden"}},le={class:"amount-card"},oe={class:"amount-label"},ie={class:"amount-input-wrapper"},re={key:0,class:"cursor"},ue={key:0,class:"note-section"},de={key:1,class:"note-input-row"},ve={class:"number-keyboard"},ce={class:"keyboard-grid"},fe={__name:"MoneyPacket",props:{visible:{type:Boolean,default:!1},targetName:{type:String,default:""},targetAvatar:{type:String,default:""},mode:{type:String,default:"transfer",validator:n=>["transfer","recharge"].includes(n)}},emits:["update:visible","confirm"],setup(n,{emit:C}){const h=n,f=C,s=d(""),a=d(""),k=d(!1),m=d(null),y=d(!0),p=d(!1),g=d(null),S=b(()=>!!m.value),F=b(()=>s.value),M=()=>(m.value=document.querySelector("#phone-screen-container"),!!m.value);U(()=>{$(()=>{M()&&(k.value=!0)})}),D(()=>{k.value=!1});const N=b(()=>{const i=parseFloat(s.value);return!isNaN(i)&&i>0});K(()=>h.visible,i=>{i&&(s.value="",a.value="",y.value=!0)});const x=()=>{f("update:visible",!1)},V=()=>{y.value=!0},z=()=>{p.value=!0,$(()=>{g.value&&g.value.focus()})},w=()=>{p.value=!1},o=i=>{if(i==="."){if(s.value.includes("."))return;if(s.value===""){s.value="0.";return}}if(s.value.includes(".")){const e=s.value.split(".");if(e[1]&&e[1].length>=2)return}if(!(!s.value.includes(".")&&i!=="."&&s.value.length>=8)){if(s.value==="0"&&i!=="."){s.value=i;return}s.value+=i}},A=()=>{s.value.length>0&&(s.value=s.value.slice(0,-1))},I=()=>{N.value&&(f("confirm",{amount:parseFloat(s.value).toFixed(2),note:a.value}),x())};return(i,e)=>k.value&&S.value?(r(),L(J,{key:0,to:"#phone-screen-container"},[T(j,{name:"slide-up"},{default:P(()=>[n.visible?(r(),u("div",Q,[t("div",X,[t("div",{class:"back-btn",onClick:x},[T(q,{name:"back-btn"})]),t("div",Y,v(n.mode==="recharge"?"充值":""),1),e[12]||(e[12]=t("div",{class:"action-btn"},null,-1))]),n.mode==="transfer"?(r(),u("div",Z,[t("div",_,[t("div",ee,[t("div",te,"转账给 "+v(n.targetName),1)])]),n.targetAvatar?(r(),u("img",{key:0,src:n.targetAvatar,class:"target-avatar"},null,8,se)):(r(),u("div",ae,[...e[13]||(e[13]=[t("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[t("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",fill:"#999"})],-1)])]))])):(r(),u("div",ne,[...e[14]||(e[14]=[t("div",{class:"target-info"},[t("div",{class:"target-text"},[t("div",{class:"transfer-to"},"充值")])],-1)])])),t("div",le,[t("div",oe,v(n.mode==="recharge"?"充值金额":"转账金额"),1),t("div",ie,[e[15]||(e[15]=t("span",{class:"currency-symbol"},"¥",-1)),t("div",{class:"amount-display",onClick:V},[G(v(F.value||"")+" ",1),y.value?(r(),u("span",re,"|")):c("",!0)])]),e[16]||(e[16]=t("div",{class:"amount-divider"},null,-1)),n.mode==="transfer"?(r(),u("div",ue,[p.value?(r(),u("div",de,[H(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l),class:"base-input note-input",placeholder:"添加转账说明",maxlength:"20",ref_key:"noteInputRef",ref:g,onBlur:w,onKeyup:W(w,["enter"])},null,544),[[O,a.value]])])):(r(),u("div",{key:0,class:"note-label-row",onClick:z},[t("span",{class:B(["note-text",{"has-note":a.value}])},v(a.value||"添加转账说明"),3)]))])):c("",!0)]),t("div",ve,[t("div",ce,[t("div",{class:"key-btn",onClick:e[1]||(e[1]=l=>o("1"))},"1"),t("div",{class:"key-btn",onClick:e[2]||(e[2]=l=>o("2"))},"2"),t("div",{class:"key-btn",onClick:e[3]||(e[3]=l=>o("3"))},"3"),t("div",{class:"key-btn delete-btn",onClick:A},[...e[17]||(e[17]=[t("svg",{viewBox:"0 0 24 24",width:"22",height:"22"},[t("path",{d:"M22 3H7c-.69 0-1.23.35-1.59.88L0 12l5.41 8.11c.36.53.9.89 1.59.89h15c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-3 12.59L17.59 17 14 13.41 10.41 17 9 15.59 12.59 12 9 8.41 10.41 7 14 10.59 17.59 7 19 8.41 15.41 12 19 15.59z",fill:"#333"})],-1)])]),t("div",{class:"key-btn",onClick:e[4]||(e[4]=l=>o("4"))},"4"),t("div",{class:"key-btn",onClick:e[5]||(e[5]=l=>o("5"))},"5"),t("div",{class:"key-btn",onClick:e[6]||(e[6]=l=>o("6"))},"6"),t("div",{class:B(["key-btn transfer-key",{disabled:!N.value}]),onClick:I},v(n.mode==="recharge"?"确定":"转账"),3),t("div",{class:"key-btn",onClick:e[7]||(e[7]=l=>o("7"))},"7"),t("div",{class:"key-btn",onClick:e[8]||(e[8]=l=>o("8"))},"8"),t("div",{class:"key-btn",onClick:e[9]||(e[9]=l=>o("9"))},"9"),t("div",{class:"key-btn zero-btn",onClick:e[10]||(e[10]=l=>o("0"))},"0"),t("div",{class:"key-btn",onClick:e[11]||(e[11]=l=>o("."))},".")])])])):c("",!0)]),_:1})])):c("",!0)}},ye=R(fe,[["__scopeId","data-v-29e4591c"]]);export{ye as M,me as u};
