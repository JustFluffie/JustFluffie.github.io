import{cf as ve,r as m,cg as q,_ as me,q as be,V as he,Y as ge,t as ke,x as fe,H as we,y as _e,c as K,z as F,l as ye,h as M,j as s,a6 as xe,o as k,d as e,f as V,B as i,w as B,A as U,b as w,e as S,F as L,C as W,c2 as Pe,n as A,M as Y,ch as Ce}from"./index-CypFzVNd.js";import{C as Z}from"./CustomSelect-B_xcPtJs.js";const Se=ve("backup",()=>{const I=m(""),o=m(""),u=m(!1),g=m(null);function b(l={chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0,presets:!0}){return new Promise(v=>{setTimeout(()=>{const n={},h=localStorage.getItem("aiPhoneSingleChatData");if(h)try{const p=q.decompressFromUTF16(h),r=JSON.parse(p||h),c={};let T=!1;if(l.chat&&(c.messages=r.messages,T=!0),l.characters&&(c.characters=r.characters,c.userPersonas=r.userPersonas,c.favorites=r.favorites,T=!0),l.appearance&&(c.bubblePresets=r.bubblePresets,c.stickers=r.stickers,T=!0),T){const x=JSON.stringify(c),P=q.compressToUTF16(x);n.aiPhoneSingleChatData=P}}catch(p){console.error("Error processing single chat data for backup",p)}if(l.chat){const p=localStorage.getItem("aiPhoneMomentsData");p&&(n.aiPhoneMomentsData=p)}l.settings&&["api_imageHostProvider","api_imgbbApiKey","api_catboxUserHash","aiPhoneGlobalBackgroundActivity","aiPhoneGlobalProactiveScope","aiPhoneGlobalProactiveInterval","aiPhoneGlobalProactiveCooldown","aiPhoneGlobalProactiveDailyLimit","aiPhoneGlobalTriggerMode","aiPhoneGlobalProactiveIdleTime"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(n[r]=c)}),l.appearance&&["aiPhoneThemePresets","aiPhoneCurrentThemePreset","aiPhoneFontPresets","aiPhoneCurrentFontPreset","aiPhoneCssPresets","aiPhoneCurrentCssPreset"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(n[r]=c)}),l.worldbook&&["worldBooks","worldBookNextId"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(n[r]=c)}),l.presets&&["api_presets","api_activePresetName"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(n[r]=c)}),v(JSON.stringify(n,null,2))},0)})}async function j(){if(I.value=localStorage.getItem("github_token")||"",!I.value){alert("请先设置 GitHub Token！");return}try{const l=await fetch("https://api.github.com/user/repos",{method:"POST",headers:{Authorization:`token ${I.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({name:"phone-backup",private:!0,description:"Backup for Phone Vue App"})});if(l.ok){const v=await l.json();o.value=v.full_name,alert(`仓库 ${v.full_name} 创建成功！即将开始备份...`),await _()}else{if(l.status===401){alert("创建仓库失败: GitHub Token 无效或过期 (401)。请检查设置。");return}const v=await l.json();if(v.errors&&v.errors[0].message==="name already exists on this account"){const n=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${I.value}`}});if(n.ok){const h=await n.json();o.value=`${h.login}/phone-backup`,alert(`仓库已存在，已自动关联到 ${o.value}。即将开始备份...`),await _();return}}alert(`创建仓库失败: ${v.message}`)}}catch(l){console.error("Create repo failed:",l),alert(`创建仓库出错: ${l.message}`)}}async function _(){if(I.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!I.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(u.value){alert("正在备份中，请稍候...");return}u.value=!0,alert("正在准备备份数据...");try{const l=await b();alert("数据准备完成，开始上传...");const v="phone_backup.json",[n,h]=o.value.split("/"),p=`https://api.github.com/repos/${n}/${h}/contents/${v}`;let r;try{const y=await fetch(p,{headers:{Authorization:`token ${I.value}`,Accept:"application/vnd.github.v3+json"}});if(y.status===401)throw new Error("GitHub Token 无效或过期 (401)。请检查设置。");y.status===404?console.log("备份文件不存在，将创建新文件。"):y.ok&&(r=(await y.json()).sha)}catch(y){if(y.message.includes("GitHub Token"))throw y}const c=`Backup from phone-vue-app: ${new Date().toISOString()}`,x=new TextEncoder().encode(l),P=Array.from(x).map(y=>String.fromCharCode(y)).join(""),D=btoa(P),G={message:c,content:D,sha:r},N=await fetch(p,{method:"PUT",headers:{Authorization:`token ${I.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(G)});if(N.ok)g.value=new Date,alert("备份成功！");else{if(N.status===401){alert("备份失败: GitHub Token 无效或过期 (401)。请检查设置。");return}const y=await N.json();console.error("GitHub API Error:",y),alert(`备份失败: ${y.message||"未知错误"}`)}}catch(l){console.error("Backup to GitHub failed:",l),alert(`备份过程中发生错误: ${l.message}`)}finally{u.value=!1}}async function C(){alert("从 GitHub 恢复的功能尚未实现。")}async function $(l){try{alert("正在生成备份文件...");const v=await b(l),n=new Blob([v],{type:"application/json"}),h=URL.createObjectURL(n),p=document.createElement("a");p.href=h,p.download=`JF-Phone_backup_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(h),alert("备份文件已开始下载！")}catch(v){console.error("Export backup failed:",v),alert(`导出备份文件时出错: ${v.message}`)}}function H(){const l=document.createElement("input");l.type="file",l.accept="application/json",l.onchange=v=>{const n=v.target.files[0];if(!n)return;const h=new FileReader;h.onload=p=>{try{const r=JSON.parse(p.target.result);if(confirm("这将覆盖所有当前数据，确定要导入吗？")){localStorage.clear();for(const c in r)Object.hasOwnProperty.call(r,c)&&localStorage.setItem(c,r[c]);alert("数据导入成功！请刷新页面以应用更改。")}}catch(r){console.error("Import backup failed:",r),alert(`导入失败，请确保文件格式正确: ${r.message}`)}},h.readAsText(n)},l.click()}return{githubToken:I,githubRepo:o,isBackingUp:u,lastBackupTime:g,backupToGitHub:_,restoreFromGitHub:C,exportBackupFile:$,importBackupFile:H,createBackupRepo:j}}),Te={class:"card"},Be={class:"card-title"},Ae={class:"card-content"},Ie={class:"api-item-row"},Ue={style:{flex:"1","min-width":"0"}},$e={class:"api-item-col"},He={class:"form-label",for:"api-url"},Ne=["placeholder"],De={class:"api-item-col"},Ge={class:"form-label",for:"api-key"},je=["placeholder"],Me={class:"api-item-row"},Ee={class:"list-item-title",style:{"font-weight":"normal","white-space":"nowrap"}},Fe={style:{flex:"1",display:"flex",gap:"10px","align-items":"center","min-width":"0"}},Oe={style:{flex:"1","min-width":"0",position:"relative"}},Re={key:0,value:"",disabled:""},Ve=["value"],Ke={class:"card"},Le={class:"card-title"},ze={class:"card-title-note",style:{padding:"0 16px 10px","margin-top":"-10px",color:"var(--danger-color)"}},Je={class:"card-content"},qe={class:"api-item-row"},We={class:"list-item-content"},Ye={class:"list-item-title"},Ze={class:"list-item-subtitle"},Qe={class:"api-item-row"},Xe={class:"list-item-content"},et={class:"list-item-title"},tt={class:"api-item-row"},ot={class:"list-item-content"},st={class:"list-item-title"},at={class:"api-item-row"},it={class:"list-item-content"},lt={class:"list-item-title"},nt={class:"api-item-row"},rt={class:"list-item-content"},ct={class:"list-item-title"},dt={class:"api-item-row"},pt={class:"list-item-content"},ut={class:"list-item-title"},vt={class:"list-item-subtitle"},mt={class:"mode-selector"},bt={key:0,class:"api-item-row"},ht={class:"list-item-content"},gt={class:"list-item-title"},kt={class:"list-item-subtitle"},ft={class:"card"},wt={class:"card-title"},_t={class:"card-content"},yt={class:"api-item-row"},xt={class:"list-item-content"},Pt={class:"list-item-title"},Ct={class:"list-item-subtitle"},St={class:"api-item-row"},Tt={class:"list-item-content"},Bt={class:"list-item-title"},At={class:"list-item-subtitle"},It={class:"card"},Ut={class:"card-title"},$t={class:"card-content"},Ht={class:"api-item-col"},Nt={class:"form-label",for:"github-token"},Dt={class:"input-hint"},Gt={style:{display:"flex",gap:"10px"}},jt=["placeholder"],Mt={class:"api-item-col"},Et={class:"form-label",for:"github-repo"},Ft={style:{display:"flex",gap:"10px"}},Ot=["placeholder"],Rt=["disabled"],Vt={class:"api-item-row"},Kt=["disabled"],Lt={key:0,style:{"font-size":"12px",color:"var(--text-tertiary)","margin-top":"10px"}},zt={class:"card"},Jt={class:"card-title"},qt={class:"card-content"},Wt={class:"api-item-row"},Yt={class:"list-item-content",style:{flex:"1","min-width":"0"}},Zt={class:"list-item-title"},Qt={class:"list-item-subtitle"},Xt={style:{width:"120px","flex-shrink":"0"}},eo={class:"api-item-col"},to={class:"form-label",for:"imgbb-api-key"},oo={class:"input-hint"},so={style:{display:"flex",gap:"10px"}},ao=["placeholder"],io={class:"api-item-col"},lo={class:"form-label",for:"catbox-hash"},no={class:"input-hint"},ro={style:{display:"flex",gap:"10px"}},co=["placeholder"],po={class:"card"},uo={class:"card-title"},vo={class:"card-content"},mo={style:{"font-size":"13px",color:"var(--text-tertiary)","margin-bottom":"15px"}},bo={class:"api-item-row",style:{"border-bottom":"none","padding-bottom":"0"}},ho={class:"scope-list"},go={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},ko={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},fo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},wo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},_o={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},yo={class:"scope-list",style:{"max-height":"300px","overflow-y":"auto"}},xo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},Po={class:"scope-name"},Co=["onClick"],So={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},To={class:"scope-name"},Bo={__name:"API",setup(I){const{t:o}=be(),u=he(),g=ge(),b=Se(),j=ke(),_=fe(),C=we(),$=m(""),H=m(""),l=m(""),v=m(!1),n=m([]),h=m(5),p=m(30),r=m(10),c=m("always"),T=m(15),x=m(""),P=m(""),D=m("catbox"),G=m(""),N=m(""),y=m([{value:"none",label:"无"},{value:"catbox",label:"Catbox"},{value:"imgbb",label:"ImgBB"}]);_e(()=>{v.value=g.globalBackgroundActivity,n.value=[...g.globalProactiveScope||[]],h.value=g.globalProactiveInterval,p.value=g.globalProactiveCooldown,r.value=g.globalProactiveDailyLimit,c.value=g.globalTriggerMode,T.value=g.globalProactiveIdleTime,x.value=localStorage.getItem("github_token")||"",P.value=localStorage.getItem("github_repo")||"",D.value=u.imageHostProvider,G.value=u.imgbbApiKey,N.value=u.catboxUserHash});const z=K(()=>u.presets.find(d=>d.name===u.activePresetName)||null);F(z,d=>{d&&($.value=d.apiKey,H.value=d.apiUrl,l.value=d.model)},{immediate:!0,deep:!0}),F([$,H,l],()=>{u.activePresetName&&u.addPreset(u.activePresetName,{apiKey:$.value,apiUrl:H.value,model:l.value})}),F([v,n,h,p,r,c,T],()=>{g.globalBackgroundActivity=v.value,g.globalProactiveScope=n.value,g.globalProactiveInterval=h.value,g.globalProactiveCooldown=p.value,g.globalProactiveDailyLimit=r.value,g.globalTriggerMode=c.value,g.globalProactiveIdleTime=T.value},{deep:!0}),F([x,P],()=>{b.githubToken=x.value,b.githubRepo=P.value,localStorage.setItem("github_token",x.value),localStorage.setItem("github_repo",P.value)}),F([D,G,N],()=>{u.imageHostProvider=D.value,u.imgbbApiKey=G.value,u.catboxUserHash=N.value},{deep:!0});function Q(){_.showToast(o("api.toast.settingsSaved"))}function X(){_.showInput(o("api.prompt.saveAsPreset"),"",d=>{d&&(u.addPreset(d,{apiKey:$.value,apiUrl:H.value,model:l.value}),_.showToast(o("api.toast.presetSaved",{name:d})))},o("api.prompt.enterPresetName"))}function ee(){_.showConfirm(o("api.confirm.deletePreset"),o("api.confirm.deletePresetMsg",{name:u.activePresetName}),()=>{u.deletePreset(u.activePresetName),_.showToast(o("api.toast.presetDeleted"))})}async function te(){const d={apiUrl:H.value,apiKey:$.value};await u.fetchModels(d)}const oe=K(()=>{switch(C.permission){case"granted":return o("api.notificationsGranted");case"denied":return o("api.notificationsDenied");default:return o("api.notificationsDefault")}}),se=()=>{C.permission!=="granted"?C.requestPermission():C.desktopNotificationsEnabled=!C.desktopNotificationsEnabled},ae=()=>{if(!C.desktopNotificationsEnabled){_.showToast("请先开启“桌面通知”开关。","warning");return}if(C.permission!=="granted"){_.showToast("浏览器通知权限未授予，请点击开关重新授权。","warning");return}_.showToast("测试通知已发送，请检查系统通知。"),C.triggerNotification("测试通知","如果看到此消息，说明桌面通知功能正常。","/pwa-192x192.png",()=>{console.log("Test notification clicked!")})},ie=async()=>{b.githubToken=x.value,await b.createBackupRepo(),P.value=b.githubRepo},le=async()=>{b.githubToken=x.value,b.githubRepo=P.value,await b.backupToGitHub()};function ne(){window.open("https://github.com/settings/tokens/new?scopes=repo&description=Phone%20App%20Backup","_blank")}function re(){window.open("https://api.imgbb.com/","_blank")}function ce(){window.open("https://catbox.moe/user/","_blank")}function de(){_.showConfirm("确认清除所有数据？","此操作将永久删除所有本地存储的数据（包括聊天记录、API设置、背景图片等）。应用将重置为初始状态。请确保您已备份重要数据。",async()=>{localStorage.clear();try{await Ce.clear()}catch(d){console.error("Error clearing localforage:",d)}try{u.$reset(),g.$reset(),b.$reset(),j.$reset(),_.$reset(),C.$reset()}catch(d){console.error("Error resetting stores:",d)}window.location.reload()},{messageStyle:{color:"#FF3B30"},confirmText:"delete"})}const O=m(!1),f=m({chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0,presets:!0});function E(d){if(d==="worldbook"){const t=!f.value.worldbook;f.value.worldbook=t,f.value.presets=t}else f.value[d]=!f.value[d]}function pe(){b.exportBackupFile(f.value),O.value=!1}const R=m(!1),ue=K(()=>{const d=n.value||[];return d.includes("all")?o("api.scopeAll"):d.length===0?o("api.scopeNone"):o("api.scopeSelected",{count:d.length})});function J(d){const t=n.value;if(d==="all")t.includes("all")?n.value=[]:n.value=["all"];else if(t.includes("all"))n.value=[d];else{const a=t.indexOf(d);a>-1?t.splice(a,1):t.push(d),j.characters.length>0&&t.length===j.characters.length&&(n.value=["all"])}}return(d,t)=>(k(),ye(xe,{title:s(o)("api.title")},{action:M(()=>[e("button",{class:"header-save-btn",onClick:Q},i(s(o)("save")),1)]),default:M(()=>[e("div",Te,[e("div",Be,i(s(o)("api.globalConfig")),1),e("div",Ae,[e("div",Ie,[e("div",Ue,[V(Z,{"model-value":s(u).activePresetName,options:s(u).presets.map(a=>({value:a.name,label:a.name})),"onUpdate:modelValue":t[0]||(t[0]=a=>s(u).switchPreset(a)),textAlign:"left",style:{width:"100%"}},null,8,["model-value","options"])]),e("button",{class:"btn btn-secondary btn-sm",onClick:X},i(s(o)("api.saveAs")),1),e("button",{class:"btn btn-danger-light btn-sm",onClick:ee},i(s(o)("delete")),1)]),e("div",$e,[e("label",He,i(s(o)("api.apiUrl")),1),B(e("input",{type:"text",id:"api-url",class:"base-input","onUpdate:modelValue":t[1]||(t[1]=a=>H.value=a),placeholder:s(o)("api.apiUrlPlaceholder"),autocomplete:"new-password"},null,8,Ne),[[U,H.value]])]),e("div",De,[e("label",Ge,i(s(o)("api.apiKey")),1),B(e("input",{type:"password",id:"api-key",class:"base-input","onUpdate:modelValue":t[2]||(t[2]=a=>$.value=a),placeholder:s(o)("api.apiKeyPlaceholder"),autocomplete:"new-password"},null,8,je),[[U,$.value]])]),e("div",Me,[e("div",Ee,i(s(o)("api.model")),1),e("div",Fe,[e("div",Oe,[B(e("select",{class:"native-select","onUpdate:modelValue":t[3]||(t[3]=a=>l.value=a)},[s(u).models.length===0?(k(),w("option",Re,i(s(o)("api.modelPlaceholder")),1)):S("",!0),(k(!0),w(L,null,W(s(u).models,a=>(k(),w("option",{key:a,value:a},i(a),9,Ve))),128))],512),[[Pe,l.value]]),t[29]||(t[29]=e("div",{class:"select-arrow"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1))]),e("button",{class:"btn btn-secondary btn-sm",onClick:te,style:{"white-space":"nowrap"}},i(s(o)("api.fetch")),1)])])])]),e("div",Ke,[e("div",Le,i(s(o)("api.backgroundActivity")),1),e("div",ze,i(s(o)("api.backgroundActivityWarning")),1),e("div",Je,[e("div",qe,[e("div",We,[e("div",Ye,i(s(o)("api.proactiveMessages")),1),e("div",Ze,i(s(o)("api.proactiveMessagesDesc")),1)]),e("div",{class:A(["toggle-switch",{active:v.value}]),onClick:t[4]||(t[4]=a=>v.value=!v.value)},null,2)]),v.value?(k(),w(L,{key:0},[e("div",Qe,[e("div",Xe,[e("div",et,i(s(o)("api.scope")),1)]),e("div",{class:"scope-selector",onClick:t[5]||(t[5]=a=>R.value=!0)},[e("span",null,i(ue.value),1),t[30]||(t[30]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1))])]),e("div",tt,[e("div",ot,[e("div",st,i(s(o)("api.interval")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>h.value=a),class:"base-input base-input-short",placeholder:"5",autocomplete:"new-password"},null,512),[[U,h.value,void 0,{number:!0}]])]),e("div",at,[e("div",it,[e("div",lt,i(s(o)("api.cooldown")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>p.value=a),class:"base-input base-input-short",placeholder:"30",autocomplete:"new-password"},null,512),[[U,p.value,void 0,{number:!0}]])]),e("div",nt,[e("div",rt,[e("div",ct,i(s(o)("api.dailyLimit")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>r.value=a),class:"base-input base-input-short",placeholder:"10",autocomplete:"new-password"},null,512),[[U,r.value,void 0,{number:!0}]])]),e("div",dt,[e("div",pt,[e("div",ut,i(s(o)("api.triggerMode")),1),e("div",vt,i(s(o)("api.triggerModeIdleHint")),1)]),e("div",mt,[e("div",{class:A(["mode-option",{active:c.value==="idle"}]),onClick:t[9]||(t[9]=a=>c.value="idle")},i(s(o)("api.triggerModeIdle")),3),e("div",{class:A(["mode-option",{active:c.value==="always"}]),onClick:t[10]||(t[10]=a=>c.value="always")},i(s(o)("api.triggerModeAlways")),3)])]),c.value==="idle"?(k(),w("div",bt,[e("div",ht,[e("div",gt,i(s(o)("api.idleTime")),1),e("div",kt,i(s(o)("api.idleTimeDesc")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=a=>T.value=a),class:"base-input base-input-short",placeholder:"15",autocomplete:"new-password"},null,512),[[U,T.value,void 0,{number:!0}]])])):S("",!0)],64)):S("",!0)])]),e("div",ft,[e("div",wt,i(s(o)("api.notificationSettings")),1),e("div",_t,[e("div",yt,[e("div",xt,[e("div",Pt,i(s(o)("api.desktopNotifications")),1),e("div",Ct,i(oe.value),1)]),e("div",{class:A(["toggle-switch",{active:s(C).desktopNotificationsEnabled}]),onClick:se},null,2)]),e("div",St,[e("div",Tt,[e("div",Bt,i(s(o)("api.testNotification")),1),e("div",At,i(s(o)("api.testNotificationDesc")),1)]),e("button",{class:"btn btn-secondary btn-sm",onClick:ae},i(s(o)("api.test")),1)])])]),e("div",It,[e("div",Ut,i(s(o)("api.githubBackup")),1),e("div",$t,[e("div",Ht,[e("label",Nt,i(s(o)("api.githubToken")),1),e("div",Dt,i(s(o)("api.githubTokenHint")),1),e("div",Gt,[B(e("input",{type:"password",id:"github-token",class:"base-input small-placeholder","onUpdate:modelValue":t[12]||(t[12]=a=>x.value=a),placeholder:s(o)("api.githubTokenPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,jt),[[U,x.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ne},i(s(o)("api.getToken")),1)])]),e("div",Mt,[e("label",Et,i(s(o)("api.repoAddress")),1),e("div",Ft,[B(e("input",{type:"text",id:"github-repo",class:"base-input","onUpdate:modelValue":t[13]||(t[13]=a=>P.value=a),placeholder:s(o)("api.repoAddressPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Ot),[[U,P.value]]),P.value?S("",!0):(k(),w("button",{key:0,class:"btn btn-secondary btn-sm",onClick:ie,disabled:!x.value},i(s(o)("api.createRepo")),9,Rt))])]),e("div",Vt,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:le,disabled:s(b).isBackingUp},i(s(b).isBackingUp?s(o)("api.backingUp"):s(o)("api.backupNow")),9,Kt),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[14]||(t[14]=(...a)=>s(b).restoreFromGitHub&&s(b).restoreFromGitHub(...a))},i(s(o)("api.restoreBackup")),1)]),s(b).lastBackupTime?(k(),w("p",Lt,i(s(o)("api.lastBackup"))+" "+i(new Date(s(b).lastBackupTime).toLocaleString()),1)):S("",!0)])]),e("div",zt,[e("div",Jt,i(s(o)("api.imageHost")),1),e("div",qt,[e("div",Wt,[e("div",Yt,[e("div",Zt,i(s(o)("api.defaultImageHost")),1),e("div",Qt,i(s(o)("api.defaultImageHostDesc")),1)]),e("div",Xt,[V(Z,{"model-value":D.value,options:y.value,"onUpdate:modelValue":t[15]||(t[15]=a=>D.value=a),textAlign:"right"},null,8,["model-value","options"])])]),e("div",eo,[e("label",to,i(s(o)("api.imgbbApiKey")),1),e("div",oo,i(s(o)("api.imgbbApiKeyHint")),1),e("div",so,[B(e("input",{type:"password",id:"imgbb-api-key",class:"base-input small-placeholder","onUpdate:modelValue":t[16]||(t[16]=a=>G.value=a),placeholder:s(o)("api.imgbbApiKeyPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,ao),[[U,G.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:re},i(s(o)("api.getImgbbApiKey")),1)])]),e("div",io,[e("label",lo,i(s(o)("api.catboxUserHash")),1),e("div",no,i(s(o)("api.catboxUserHashHint")),1),e("div",ro,[B(e("input",{type:"text",id:"catbox-hash",class:"base-input small-placeholder","onUpdate:modelValue":t[17]||(t[17]=a=>N.value=a),placeholder:s(o)("api.catboxUserHashPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,co),[[U,N.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ce},i(s(o)("api.getCatboxUserHash")),1)])])])]),e("div",po,[e("div",uo,i(s(o)("api.dataBackup")),1),e("div",vo,[e("p",mo,i(s(o)("api.dataBackupDesc")),1),e("div",bo,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[18]||(t[18]=a=>O.value=!0)},i(s(o)("api.exportBackupFile")),1),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[19]||(t[19]=(...a)=>s(b).importBackupFile&&s(b).importBackupFile(...a))},i(s(o)("api.importBackupFile")),1)])])]),e("div",{class:"danger-zone"},[e("button",{class:"btn btn-danger big-btn",onClick:de},[...t[31]||(t[31]=[e("div",{class:"danger-btn-content"},[e("div",{class:"danger-btn-title"},"清除所有数据"),e("div",{class:"danger-btn-desc"},"此操作将清除所有聊天记录、设置和本地数据，且无法恢复")],-1)])])]),V(Y,{visible:O.value,"onUpdate:visible":t[25]||(t[25]=a=>O.value=a),title:"导出选项",bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:pe},"确认导出")]),default:M(()=>[e("div",ho,[e("div",{class:"scope-item",onClick:t[20]||(t[20]=a=>E("chat"))},[e("div",{class:A(["scope-checkbox",{checked:f.value.chat}])},[f.value.chat?(k(),w("svg",go,[...t[32]||(t[32]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),t[33]||(t[33]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"聊天数据"),e("span",{class:"scope-desc"},"包含聊天记录和朋友圈")],-1))]),e("div",{class:"scope-item",onClick:t[21]||(t[21]=a=>E("characters"))},[e("div",{class:A(["scope-checkbox",{checked:f.value.characters}])},[f.value.characters?(k(),w("svg",ko,[...t[34]||(t[34]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),t[35]||(t[35]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"角色数据"),e("span",{class:"scope-desc"},"包含角色卡片、用户人设和收藏")],-1))]),e("div",{class:"scope-item",onClick:t[22]||(t[22]=a=>E("settings"))},[e("div",{class:A(["scope-checkbox",{checked:f.value.settings}])},[f.value.settings?(k(),w("svg",fo,[...t[36]||(t[36]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),t[37]||(t[37]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"应用设置"),e("span",{class:"scope-desc"},"包含图床、后台活动等设置")],-1))]),e("div",{class:"scope-item",onClick:t[23]||(t[23]=a=>E("appearance"))},[e("div",{class:A(["scope-checkbox",{checked:f.value.appearance}])},[f.value.appearance?(k(),w("svg",wo,[...t[38]||(t[38]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),t[39]||(t[39]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"外观主题"),e("span",{class:"scope-desc"},"包含主题、字体、气泡样式")],-1))]),e("div",{class:"scope-item",onClick:t[24]||(t[24]=a=>E("worldbook"))},[e("div",{class:A(["scope-checkbox",{checked:f.value.worldbook}])},[f.value.worldbook?(k(),w("svg",_o,[...t[40]||(t[40]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),t[41]||(t[41]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"世界书/预设"),e("span",{class:"scope-desc"},"包含世界书和API预设")],-1))])])]),_:1},8,["visible"]),V(Y,{visible:R.value,"onUpdate:visible":t[28]||(t[28]=a=>R.value=a),title:s(o)("api.selectScope"),bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:t[27]||(t[27]=a=>R.value=!1)},i(s(o)("confirm")),1)]),default:M(()=>[e("div",yo,[e("div",{class:"scope-item",onClick:t[26]||(t[26]=a=>J("all"))},[e("div",{class:A(["scope-checkbox",{checked:n.value&&n.value.includes("all")}])},[n.value&&n.value.includes("all")?(k(),w("svg",xo,[...t[42]||(t[42]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),e("span",Po,i(s(o)("api.scopeAll")),1)]),(k(!0),w(L,null,W(s(j).characters,a=>(k(),w("div",{key:a.id,class:"scope-item",onClick:Ao=>J(a.id)},[e("div",{class:A(["scope-checkbox",{checked:n.value&&n.value.includes(a.id)}])},[n.value&&n.value.includes(a.id)?(k(),w("svg",So,[...t[43]||(t[43]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):S("",!0)],2),e("span",To,i(a.name),1)],8,Co))),128))])]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},$o=me(Bo,[["__scopeId","data-v-6d596d88"]]);export{$o as default};
