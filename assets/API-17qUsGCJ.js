import{cf as ve,r as m,cg as q,_ as me,m as he,U as be,X as ge,s as ke,t as fe,G as we,v as _e,c as K,x as F,e as ye,w as M,j as s,a5 as xe,o as k,f as e,g as V,A as i,y as B,z as U,b as f,d as C,F as L,B as W,c2 as Pe,n as T,M as X,ch as Ce}from"./index-C5HJzI5F.js";import{C as Z}from"./CustomSelect-DXc3A-vj.js";const Se=ve("backup",()=>{const A=m(""),o=m(""),p=m(!1),g=m(null);function h(n={chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0}){return new Promise(v=>{setTimeout(()=>{const l={},b=localStorage.getItem("aiPhoneSingleChatData");if(b)try{const u=q.decompressFromUTF16(b),r=JSON.parse(u||b),c={};let S=!1;if(n.chat&&(c.messages=r.messages,S=!0),n.characters&&(c.characters=r.characters,c.userPersonas=r.userPersonas,c.favorites=r.favorites,S=!0),n.appearance&&(c.bubblePresets=r.bubblePresets,c.stickers=r.stickers,S=!0),S){const _=JSON.stringify(c),y=q.compressToUTF16(_);l.aiPhoneSingleChatData=y}}catch(u){console.error("Error processing single chat data for backup",u)}if(n.chat){const u=localStorage.getItem("aiPhoneMomentsData");u&&(l.aiPhoneMomentsData=u)}n.settings&&["api_presets","api_activePresetName","api_imageHostProvider","api_imgbbApiKey","api_catboxUserHash","aiPhoneGlobalBackgroundActivity","aiPhoneGlobalProactiveScope","aiPhoneGlobalProactiveInterval","aiPhoneGlobalProactiveCooldown","aiPhoneGlobalProactiveDailyLimit","aiPhoneGlobalTriggerMode","aiPhoneGlobalProactiveIdleTime"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(l[r]=c)}),n.appearance&&["aiPhoneThemePresets","aiPhoneCurrentThemePreset","aiPhoneFontPresets","aiPhoneCurrentFontPreset","aiPhoneCssPresets","aiPhoneCurrentCssPreset"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(l[r]=c)}),n.worldbook&&["worldBooks","worldBookNextId"].forEach(r=>{const c=localStorage.getItem(r);c!==null&&(l[r]=c)}),v(JSON.stringify(l,null,2))},0)})}async function G(){if(A.value=localStorage.getItem("github_token")||"",!A.value){alert("请先设置 GitHub Token！");return}try{const n=await fetch("https://api.github.com/user/repos",{method:"POST",headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({name:"phone-backup",private:!0,description:"Backup for Phone Vue App"})});if(n.ok){const v=await n.json();o.value=v.full_name,alert(`仓库 ${v.full_name} 创建成功！即将开始备份...`),await w()}else{const v=await n.json();if(v.errors&&v.errors[0].message==="name already exists on this account"){const l=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${A.value}`}});if(l.ok){const b=await l.json();o.value=`${b.login}/phone-backup`,alert(`仓库已存在，已自动关联到 ${o.value}。即将开始备份...`),await w();return}}alert(`创建仓库失败: ${v.message}`)}}catch(n){console.error("Create repo failed:",n),alert(`创建仓库出错: ${n.message}`)}}async function w(){if(A.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!A.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(p.value){alert("正在备份中，请稍候...");return}p.value=!0,alert("正在准备备份数据...");try{const n=await h();alert("数据准备完成，开始上传...");const v="phone_backup.json",[l,b]=o.value.split("/"),u=`https://api.github.com/repos/${l}/${b}/contents/${v}`;let r;try{const I=await fetch(u,{headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json"}});I.ok&&(r=(await I.json()).sha)}catch{}const c=`Backup from phone-vue-app: ${new Date().toISOString()}`,_=new TextEncoder().encode(n),y=Array.from(_).map(I=>String.fromCharCode(I)).join(""),H=btoa(y),j={message:c,content:H,sha:r},D=await fetch(u,{method:"PUT",headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(j)});if(D.ok)g.value=new Date,alert("备份成功！");else{const I=await D.json();console.error("GitHub API Error:",I),alert(`备份失败: ${I.message}`)}}catch(n){console.error("Backup to GitHub failed:",n),alert(`备份过程中发生错误: ${n.message}`)}finally{p.value=!1}}async function P(){alert("从 GitHub 恢复的功能尚未实现。")}async function $(n){try{alert("正在生成备份文件...");const v=await h(n),l=new Blob([v],{type:"application/json"}),b=URL.createObjectURL(l),u=document.createElement("a");u.href=b,u.download=`phone_backup_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(b),alert("备份文件已开始下载！")}catch(v){console.error("Export backup failed:",v),alert(`导出备份文件时出错: ${v.message}`)}}function N(){const n=document.createElement("input");n.type="file",n.accept="application/json",n.onchange=v=>{const l=v.target.files[0];if(!l)return;const b=new FileReader;b.onload=u=>{try{const r=JSON.parse(u.target.result);if(confirm("这将覆盖所有当前数据，确定要导入吗？")){localStorage.clear();for(const c in r)Object.hasOwnProperty.call(r,c)&&localStorage.setItem(c,r[c]);alert("数据导入成功！请刷新页面以应用更改。")}}catch(r){console.error("Import backup failed:",r),alert(`导入失败，请确保文件格式正确: ${r.message}`)}},b.readAsText(l)},n.click()}return{githubToken:A,githubRepo:o,isBackingUp:p,lastBackupTime:g,backupToGitHub:w,restoreFromGitHub:P,exportBackupFile:$,importBackupFile:N,createBackupRepo:G}}),Be={class:"card"},Te={class:"card-title"},Ae={class:"card-content"},Ie={class:"api-item-row"},Ue={style:{flex:"1","min-width":"0"}},$e={class:"api-item-col"},Ne={class:"form-label",for:"api-url"},De=["placeholder"],He={class:"api-item-col"},je={class:"form-label",for:"api-key"},Ge=["placeholder"],Me={class:"api-item-row"},Ee={class:"list-item-title",style:{"font-weight":"normal","white-space":"nowrap"}},Fe={style:{flex:"1",display:"flex",gap:"10px","align-items":"center","min-width":"0"}},Oe={style:{flex:"1","min-width":"0",position:"relative"}},Re={key:0,value:"",disabled:""},Ve=["value"],Ke={class:"card"},Le={class:"card-title"},ze={class:"card-title-note",style:{padding:"0 16px 10px","margin-top":"-10px",color:"var(--danger-color)"}},Je={class:"card-content"},qe={class:"api-item-row"},We={class:"list-item-content"},Xe={class:"list-item-title"},Ze={class:"list-item-subtitle"},Qe={class:"api-item-row"},Ye={class:"list-item-content"},et={class:"list-item-title"},tt={class:"api-item-row"},ot={class:"list-item-content"},st={class:"list-item-title"},at={class:"api-item-row"},it={class:"list-item-content"},lt={class:"list-item-title"},nt={class:"api-item-row"},rt={class:"list-item-content"},ct={class:"list-item-title"},dt={class:"api-item-row"},pt={class:"list-item-content"},ut={class:"list-item-title"},vt={class:"list-item-subtitle"},mt={class:"mode-selector"},ht={key:0,class:"api-item-row"},bt={class:"list-item-content"},gt={class:"list-item-title"},kt={class:"list-item-subtitle"},ft={class:"card"},wt={class:"card-title"},_t={class:"card-content"},yt={class:"api-item-row"},xt={class:"list-item-content"},Pt={class:"list-item-title"},Ct={class:"list-item-subtitle"},St={class:"api-item-row"},Bt={class:"list-item-content"},Tt={class:"list-item-title"},At={class:"list-item-subtitle"},It={class:"card"},Ut={class:"card-title"},$t={class:"card-content"},Nt={class:"api-item-col"},Dt={class:"form-label",for:"github-token"},Ht={class:"input-hint"},jt={style:{display:"flex",gap:"10px"}},Gt=["placeholder"],Mt={class:"api-item-col"},Et={class:"form-label",for:"github-repo"},Ft={style:{display:"flex",gap:"10px"}},Ot=["placeholder"],Rt=["disabled"],Vt={class:"api-item-row"},Kt=["disabled"],Lt={key:0,style:{"font-size":"12px",color:"var(--text-tertiary)","margin-top":"10px"}},zt={class:"card"},Jt={class:"card-title"},qt={class:"card-content"},Wt={class:"api-item-row"},Xt={class:"list-item-content",style:{flex:"1","min-width":"0"}},Zt={class:"list-item-title"},Qt={class:"list-item-subtitle"},Yt={style:{width:"120px","flex-shrink":"0"}},eo={class:"api-item-col"},to={class:"form-label",for:"imgbb-api-key"},oo={class:"input-hint"},so={style:{display:"flex",gap:"10px"}},ao=["placeholder"],io={class:"api-item-col"},lo={class:"form-label",for:"catbox-hash"},no={class:"input-hint"},ro={style:{display:"flex",gap:"10px"}},co=["placeholder"],po={class:"card"},uo={class:"card-title"},vo={class:"card-content"},mo={style:{"font-size":"13px",color:"var(--text-tertiary)","margin-bottom":"15px"}},ho={class:"api-item-row",style:{"border-bottom":"none","padding-bottom":"0"}},bo={class:"scope-list"},go={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},ko={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},fo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},wo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},_o={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},yo={class:"scope-list",style:{"max-height":"300px","overflow-y":"auto"}},xo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},Po={class:"scope-name"},Co=["onClick"],So={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},Bo={class:"scope-name"},To={__name:"API",setup(A){const{t:o}=he(),p=be(),g=ge(),h=Se(),G=ke(),w=fe(),P=we(),$=m(""),N=m(""),n=m(""),v=m(!1),l=m([]),b=m(5),u=m(30),r=m(10),c=m("always"),S=m(15),_=m(""),y=m(""),H=m("catbox"),j=m(""),D=m(""),I=m([{value:"none",label:"无"},{value:"catbox",label:"Catbox"},{value:"imgbb",label:"ImgBB"}]);_e(()=>{v.value=g.globalBackgroundActivity,l.value=[...g.globalProactiveScope||[]],b.value=g.globalProactiveInterval,u.value=g.globalProactiveCooldown,r.value=g.globalProactiveDailyLimit,c.value=g.globalTriggerMode,S.value=g.globalProactiveIdleTime,_.value=localStorage.getItem("github_token")||"",y.value=localStorage.getItem("github_repo")||"",H.value=p.imageHostProvider,j.value=p.imgbbApiKey,D.value=p.catboxUserHash});const z=K(()=>p.presets.find(d=>d.name===p.activePresetName)||null);F(z,d=>{d&&($.value=d.apiKey,N.value=d.apiUrl,n.value=d.model)},{immediate:!0,deep:!0}),F([$,N,n],()=>{p.activePresetName&&p.addPreset(p.activePresetName,{apiKey:$.value,apiUrl:N.value,model:n.value})}),F([v,l,b,u,r,c,S],()=>{g.globalBackgroundActivity=v.value,g.globalProactiveScope=l.value,g.globalProactiveInterval=b.value,g.globalProactiveCooldown=u.value,g.globalProactiveDailyLimit=r.value,g.globalTriggerMode=c.value,g.globalProactiveIdleTime=S.value},{deep:!0}),F([_,y],()=>{h.githubToken=_.value,h.githubRepo=y.value,localStorage.setItem("github_token",_.value),localStorage.setItem("github_repo",y.value)}),F([H,j,D],()=>{p.imageHostProvider=H.value,p.imgbbApiKey=j.value,p.catboxUserHash=D.value},{deep:!0});function Q(){w.showToast(o("api.toast.settingsSaved"))}function Y(){w.showInput(o("api.prompt.saveAsPreset"),"",d=>{d&&(p.addPreset(d,{apiKey:$.value,apiUrl:N.value,model:n.value}),w.showToast(o("api.toast.presetSaved",{name:d})))},o("api.prompt.enterPresetName"))}function ee(){w.showConfirm(o("api.confirm.deletePreset"),o("api.confirm.deletePresetMsg",{name:p.activePresetName}),()=>{p.deletePreset(p.activePresetName),w.showToast(o("api.toast.presetDeleted"))})}async function te(){const d={apiUrl:N.value,apiKey:$.value};await p.fetchModels(d)}const oe=K(()=>{switch(P.permission){case"granted":return o("api.notificationsGranted");case"denied":return o("api.notificationsDenied");default:return o("api.notificationsDefault")}}),se=()=>{P.permission!=="granted"?P.requestPermission():P.desktopNotificationsEnabled=!P.desktopNotificationsEnabled},ae=()=>{if(!P.desktopNotificationsEnabled){w.showToast("请先开启“桌面通知”开关。","warning");return}if(P.permission!=="granted"){w.showToast("浏览器通知权限未授予，请点击开关重新授权。","warning");return}w.showToast("测试通知已发送，请检查系统通知。"),P.triggerNotification("测试通知","如果看到此消息，说明桌面通知功能正常。","/pwa-192x192.png",()=>{console.log("Test notification clicked!")})},ie=async()=>{h.githubToken=_.value,await h.createBackupRepo(),y.value=h.githubRepo},le=async()=>{h.githubToken=_.value,h.githubRepo=y.value,await h.backupToGitHub()};function ne(){window.open("https://github.com/settings/tokens/new?scopes=repo&description=Phone%20App%20Backup","_blank")}function re(){window.open("https://api.imgbb.com/","_blank")}function ce(){window.open("https://catbox.moe/user/","_blank")}function de(){w.showConfirm("确认清除所有数据？","此操作将永久删除所有本地存储的数据（包括聊天记录、API设置、背景图片等）。应用将重置为初始状态。请确保您已备份重要数据。",async()=>{localStorage.clear();try{await Ce.clear()}catch(d){console.error("Error clearing localforage:",d)}try{p.$reset(),g.$reset(),h.$reset(),G.$reset(),w.$reset(),P.$reset()}catch(d){console.error("Error resetting stores:",d)}window.location.reload()},{messageStyle:{color:"#FF3B30"},confirmText:"delete"})}const O=m(!1),x=m({chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0});function E(d){x.value[d]=!x.value[d]}function pe(){h.exportBackupFile(x.value),O.value=!1}const R=m(!1),ue=K(()=>{const d=l.value||[];return d.includes("all")?o("api.scopeAll"):d.length===0?o("api.scopeNone"):o("api.scopeSelected",{count:d.length})});function J(d){const t=l.value;if(d==="all")t.includes("all")?l.value=[]:l.value=["all"];else if(t.includes("all"))l.value=[d];else{const a=t.indexOf(d);a>-1?t.splice(a,1):t.push(d),G.characters.length>0&&t.length===G.characters.length&&(l.value=["all"])}}return(d,t)=>(k(),ye(xe,{title:s(o)("api.title")},{action:M(()=>[e("button",{class:"header-save-btn",onClick:Q},i(s(o)("save")),1)]),default:M(()=>[e("div",Be,[e("div",Te,i(s(o)("api.globalConfig")),1),e("div",Ae,[e("div",Ie,[e("div",Ue,[V(Z,{"model-value":s(p).activePresetName,options:s(p).presets.map(a=>({value:a.name,label:a.name})),"onUpdate:modelValue":t[0]||(t[0]=a=>s(p).switchPreset(a)),textAlign:"left",style:{width:"100%"}},null,8,["model-value","options"])]),e("button",{class:"btn btn-secondary btn-sm",onClick:Y},i(s(o)("api.saveAs")),1),e("button",{class:"btn btn-danger-light btn-sm",onClick:ee},i(s(o)("delete")),1)]),e("div",$e,[e("label",Ne,i(s(o)("api.apiUrl")),1),B(e("input",{type:"text",id:"api-url",class:"base-input","onUpdate:modelValue":t[1]||(t[1]=a=>N.value=a),placeholder:s(o)("api.apiUrlPlaceholder"),autocomplete:"new-password"},null,8,De),[[U,N.value]])]),e("div",He,[e("label",je,i(s(o)("api.apiKey")),1),B(e("input",{type:"password",id:"api-key",class:"base-input","onUpdate:modelValue":t[2]||(t[2]=a=>$.value=a),placeholder:s(o)("api.apiKeyPlaceholder"),autocomplete:"new-password"},null,8,Ge),[[U,$.value]])]),e("div",Me,[e("div",Ee,i(s(o)("api.model")),1),e("div",Fe,[e("div",Oe,[B(e("select",{class:"native-select","onUpdate:modelValue":t[3]||(t[3]=a=>n.value=a)},[s(p).models.length===0?(k(),f("option",Re,i(s(o)("api.modelPlaceholder")),1)):C("",!0),(k(!0),f(L,null,W(s(p).models,a=>(k(),f("option",{key:a,value:a},i(a),9,Ve))),128))],512),[[Pe,n.value]]),t[29]||(t[29]=e("div",{class:"select-arrow"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1))]),e("button",{class:"btn btn-secondary btn-sm",onClick:te,style:{"white-space":"nowrap"}},i(s(o)("api.fetch")),1)])])])]),e("div",Ke,[e("div",Le,i(s(o)("api.backgroundActivity")),1),e("div",ze,i(s(o)("api.backgroundActivityWarning")),1),e("div",Je,[e("div",qe,[e("div",We,[e("div",Xe,i(s(o)("api.proactiveMessages")),1),e("div",Ze,i(s(o)("api.proactiveMessagesDesc")),1)]),e("div",{class:T(["toggle-switch",{active:v.value}]),onClick:t[4]||(t[4]=a=>v.value=!v.value)},null,2)]),v.value?(k(),f(L,{key:0},[e("div",Qe,[e("div",Ye,[e("div",et,i(s(o)("api.scope")),1)]),e("div",{class:"scope-selector",onClick:t[5]||(t[5]=a=>R.value=!0)},[e("span",null,i(ue.value),1),t[30]||(t[30]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1))])]),e("div",tt,[e("div",ot,[e("div",st,i(s(o)("api.interval")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>b.value=a),class:"base-input base-input-short",placeholder:"5",autocomplete:"new-password"},null,512),[[U,b.value,void 0,{number:!0}]])]),e("div",at,[e("div",it,[e("div",lt,i(s(o)("api.cooldown")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>u.value=a),class:"base-input base-input-short",placeholder:"30",autocomplete:"new-password"},null,512),[[U,u.value,void 0,{number:!0}]])]),e("div",nt,[e("div",rt,[e("div",ct,i(s(o)("api.dailyLimit")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>r.value=a),class:"base-input base-input-short",placeholder:"10",autocomplete:"new-password"},null,512),[[U,r.value,void 0,{number:!0}]])]),e("div",dt,[e("div",pt,[e("div",ut,i(s(o)("api.triggerMode")),1),e("div",vt,i(s(o)("api.triggerModeIdleHint")),1)]),e("div",mt,[e("div",{class:T(["mode-option",{active:c.value==="idle"}]),onClick:t[9]||(t[9]=a=>c.value="idle")},i(s(o)("api.triggerModeIdle")),3),e("div",{class:T(["mode-option",{active:c.value==="always"}]),onClick:t[10]||(t[10]=a=>c.value="always")},i(s(o)("api.triggerModeAlways")),3)])]),c.value==="idle"?(k(),f("div",ht,[e("div",bt,[e("div",gt,i(s(o)("api.idleTime")),1),e("div",kt,i(s(o)("api.idleTimeDesc")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=a=>S.value=a),class:"base-input base-input-short",placeholder:"15",autocomplete:"new-password"},null,512),[[U,S.value,void 0,{number:!0}]])])):C("",!0)],64)):C("",!0)])]),e("div",ft,[e("div",wt,i(s(o)("api.notificationSettings")),1),e("div",_t,[e("div",yt,[e("div",xt,[e("div",Pt,i(s(o)("api.desktopNotifications")),1),e("div",Ct,i(oe.value),1)]),e("div",{class:T(["toggle-switch",{active:s(P).desktopNotificationsEnabled}]),onClick:se},null,2)]),e("div",St,[e("div",Bt,[e("div",Tt,i(s(o)("api.testNotification")),1),e("div",At,i(s(o)("api.testNotificationDesc")),1)]),e("button",{class:"btn btn-secondary btn-sm",onClick:ae},i(s(o)("api.test")),1)])])]),e("div",It,[e("div",Ut,i(s(o)("api.githubBackup")),1),e("div",$t,[e("div",Nt,[e("label",Dt,i(s(o)("api.githubToken")),1),e("div",Ht,i(s(o)("api.githubTokenHint")),1),e("div",jt,[B(e("input",{type:"password",id:"github-token",class:"base-input small-placeholder","onUpdate:modelValue":t[12]||(t[12]=a=>_.value=a),placeholder:s(o)("api.githubTokenPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Gt),[[U,_.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ne},i(s(o)("api.getToken")),1)])]),e("div",Mt,[e("label",Et,i(s(o)("api.repoAddress")),1),e("div",Ft,[B(e("input",{type:"text",id:"github-repo",class:"base-input","onUpdate:modelValue":t[13]||(t[13]=a=>y.value=a),placeholder:s(o)("api.repoAddressPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Ot),[[U,y.value]]),y.value?C("",!0):(k(),f("button",{key:0,class:"btn btn-secondary btn-sm",onClick:ie,disabled:!_.value},i(s(o)("api.createRepo")),9,Rt))])]),e("div",Vt,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:le,disabled:s(h).isBackingUp},i(s(h).isBackingUp?s(o)("api.backingUp"):s(o)("api.backupNow")),9,Kt),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[14]||(t[14]=(...a)=>s(h).restoreFromGitHub&&s(h).restoreFromGitHub(...a))},i(s(o)("api.restoreBackup")),1)]),s(h).lastBackupTime?(k(),f("p",Lt,i(s(o)("api.lastBackup"))+" "+i(new Date(s(h).lastBackupTime).toLocaleString()),1)):C("",!0)])]),e("div",zt,[e("div",Jt,i(s(o)("api.imageHost")),1),e("div",qt,[e("div",Wt,[e("div",Xt,[e("div",Zt,i(s(o)("api.defaultImageHost")),1),e("div",Qt,i(s(o)("api.defaultImageHostDesc")),1)]),e("div",Yt,[V(Z,{"model-value":H.value,options:I.value,"onUpdate:modelValue":t[15]||(t[15]=a=>H.value=a),textAlign:"right"},null,8,["model-value","options"])])]),e("div",eo,[e("label",to,i(s(o)("api.imgbbApiKey")),1),e("div",oo,i(s(o)("api.imgbbApiKeyHint")),1),e("div",so,[B(e("input",{type:"password",id:"imgbb-api-key",class:"base-input small-placeholder","onUpdate:modelValue":t[16]||(t[16]=a=>j.value=a),placeholder:s(o)("api.imgbbApiKeyPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,ao),[[U,j.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:re},i(s(o)("api.getImgbbApiKey")),1)])]),e("div",io,[e("label",lo,i(s(o)("api.catboxUserHash")),1),e("div",no,i(s(o)("api.catboxUserHashHint")),1),e("div",ro,[B(e("input",{type:"text",id:"catbox-hash",class:"base-input small-placeholder","onUpdate:modelValue":t[17]||(t[17]=a=>D.value=a),placeholder:s(o)("api.catboxUserHashPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,co),[[U,D.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ce},i(s(o)("api.getCatboxUserHash")),1)])])])]),e("div",po,[e("div",uo,i(s(o)("api.dataBackup")),1),e("div",vo,[e("p",mo,i(s(o)("api.dataBackupDesc")),1),e("div",ho,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[18]||(t[18]=a=>O.value=!0)},i(s(o)("api.exportBackupFile")),1),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[19]||(t[19]=(...a)=>s(h).importBackupFile&&s(h).importBackupFile(...a))},i(s(o)("api.importBackupFile")),1)])])]),e("div",{class:"danger-zone"},[e("button",{class:"btn btn-danger big-btn",onClick:de},[...t[31]||(t[31]=[e("div",{class:"danger-btn-content"},[e("div",{class:"danger-btn-title"},"清除所有数据"),e("div",{class:"danger-btn-desc"},"此操作将清除所有聊天记录、设置和本地数据，且无法恢复")],-1)])])]),V(X,{visible:O.value,"onUpdate:visible":t[25]||(t[25]=a=>O.value=a),title:"导出选项",bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:pe},"确认导出")]),default:M(()=>[e("div",bo,[e("div",{class:"scope-item",onClick:t[20]||(t[20]=a=>E("chat"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.chat}])},[x.value.chat?(k(),f("svg",go,[...t[32]||(t[32]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[33]||(t[33]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"聊天数据"),e("span",{class:"scope-desc"},"包含聊天记录和朋友圈")],-1))]),e("div",{class:"scope-item",onClick:t[21]||(t[21]=a=>E("characters"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.characters}])},[x.value.characters?(k(),f("svg",ko,[...t[34]||(t[34]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[35]||(t[35]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"角色数据"),e("span",{class:"scope-desc"},"包含角色卡片、用户人设和收藏")],-1))]),e("div",{class:"scope-item",onClick:t[22]||(t[22]=a=>E("settings"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.settings}])},[x.value.settings?(k(),f("svg",fo,[...t[36]||(t[36]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[37]||(t[37]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"API设置"),e("span",{class:"scope-desc"},"包含API配置、图床、后台设置")],-1))]),e("div",{class:"scope-item",onClick:t[23]||(t[23]=a=>E("appearance"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.appearance}])},[x.value.appearance?(k(),f("svg",wo,[...t[38]||(t[38]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[39]||(t[39]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"外观主题"),e("span",{class:"scope-desc"},"包含主题、字体、气泡样式")],-1))]),e("div",{class:"scope-item",onClick:t[24]||(t[24]=a=>E("worldbook"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.worldbook}])},[x.value.worldbook?(k(),f("svg",_o,[...t[40]||(t[40]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[41]||(t[41]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"世界书"),e("span",{class:"scope-desc"},"包含世界书设定")],-1))])])]),_:1},8,["visible"]),V(X,{visible:R.value,"onUpdate:visible":t[28]||(t[28]=a=>R.value=a),title:s(o)("api.selectScope"),bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:t[27]||(t[27]=a=>R.value=!1)},i(s(o)("confirm")),1)]),default:M(()=>[e("div",yo,[e("div",{class:"scope-item",onClick:t[26]||(t[26]=a=>J("all"))},[e("div",{class:T(["scope-checkbox",{checked:l.value&&l.value.includes("all")}])},[l.value&&l.value.includes("all")?(k(),f("svg",xo,[...t[42]||(t[42]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),e("span",Po,i(s(o)("api.scopeAll")),1)]),(k(!0),f(L,null,W(s(G).characters,a=>(k(),f("div",{key:a.id,class:"scope-item",onClick:Ao=>J(a.id)},[e("div",{class:T(["scope-checkbox",{checked:l.value&&l.value.includes(a.id)}])},[l.value&&l.value.includes(a.id)?(k(),f("svg",So,[...t[43]||(t[43]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),e("span",Bo,i(a.name),1)],8,Co))),128))])]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},$o=me(To,[["__scopeId","data-v-b385cd7e"]]);export{$o as default};
