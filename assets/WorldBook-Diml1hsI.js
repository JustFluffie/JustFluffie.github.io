import{_ as $,k as N,O as z,P as M,c as E,r as D,d as R,w as _,y as a,a2 as T,o as h,f as d,a as y,b as k,e,S as c,C as A,z as p,n as C,M as H}from"./index-CQm37VZs.js";import{C as j}from"./CustomSelect-CgQLwaFj.js";import{d as I}from"./vuedraggable.umd-Be2tMMHD.js";const q={class:"card"},F={class:"card-header"},G={class:"book-drag-handle icon-btn"},J=["value","onInput","placeholder"],K={class:"header-controls"},L=["onClick"],Q={key:0,class:"card-content"},X={class:"content-controls"},Y={class:"priority-selector"},Z={class:"card-actions"},ee=["onClick"],oe=["onClick"],te={class:"entry-header"},le={class:"entry-drag-handle icon-btn"},ne=["value","onInput","placeholder"],ae={class:"entry-controls"},se=["onClick"],de=["onClick"],re={key:0,class:"entry-content"},ie=["value","onInput","placeholder"],ce=["value","onInput","placeholder"],ue={key:0,class:"empty-state"},pe={style:{"text-align":"center","padding-bottom":"25px"}},_e={__name:"WorldBook",setup(me){const{t}=N(),i=z(),{sortedWorldBooks:S}=M(i),O=E(()=>[{value:"1",label:t("worldbook.priorityOptions.high")},{value:"2",label:t("worldbook.priorityOptions.medium")},{value:"3",label:t("worldbook.priorityOptions.low")}]),w=l=>{switch(String(l)){case"1":return{label:t("worldbook.priorityOptions.high"),color:"red"};case"2":return{label:t("worldbook.priorityOptions.medium"),color:"blue"};case"3":return{label:t("worldbook.priorityOptions.low"),color:"green"};default:return{label:"",color:""}}},g=E({get:()=>S.value,set:l=>{}}),v=D(!1),f=D({type:null,bookIndex:null,entryIndex:null}),B=(l,s,o=null)=>{f.value={type:l,bookIndex:s,entryIndex:o},v.value=!0},P=()=>{const{type:l,bookIndex:s,entryIndex:o}=f.value;l==="book"?i.deleteWorldBook(s):l==="entry"&&i.deleteEntry(s,o),x()},x=()=>{v.value=!1,f.value={type:null,bookIndex:null,entryIndex:null}},V=(l,s)=>{i.updateBook(l,s)},b=(l,s,o)=>{i.updateEntry(l,s,o)},W=(l,s)=>{i.reorderEntries(l,{oldIndex:s.oldIndex,newIndex:s.newIndex})},U=l=>{i.onBookDragEnd({oldIndex:l.oldIndex,newIndex:l.newIndex})};return(l,s)=>(h(),R(T,{title:a(t)("worldbook.title")},{action:_(()=>[d(c,{name:"plus",onClick:a(i).addNewWorldBook,class:"header-action-icon"},null,8,["onClick"])]),default:_(()=>[d(a(I),{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=o=>g.value=o),"item-key":"id",handle:".book-drag-handle",onEnd:U},{item:_(({element:o,index:r})=>[e("div",q,[e("div",F,[e("button",G,[d(c,{name:"drag-handle"})]),w(o.priority).label?(h(),y("span",{key:0,style:A({color:w(o.priority).color,marginRight:"8px",fontWeight:"bold",fontSize:"1.2em"})},p(w(o.priority).label),5)):k("",!0),e("input",{type:"text",value:o.title,onInput:n=>V(r,{title:n.target.value}),placeholder:a(t)("worldbook.titlePlaceholder"),class:"book-title-input"},null,40,J),e("div",K,[e("button",{onClick:n=>V(r,{collapsed:!o.collapsed}),class:"collapse-btn icon-btn"},[d(c,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:o.collapsed}])},null,8,["class"])],8,L)])]),o.collapsed?k("",!0):(h(),y("div",Q,[e("div",X,[e("div",Y,[e("span",null,p(a(t)("worldbook.priority")),1),d(j,{class:"priority-custom-select",modelValue:String(o.priority),"onUpdate:modelValue":n=>a(i).setPriority(r,n),options:O.value,textAlign:"center"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Z,[e("button",{onClick:n=>a(i).addNewEntry(r),class:"add-entry-btn icon-btn"},[d(c,{name:"plus"})],8,ee),e("button",{onClick:n=>B("book",r),class:"delete-btn icon-btn"},[d(c,{name:"trash"})],8,oe)])]),d(a(I),{modelValue:o.entries,"onUpdate:modelValue":n=>o.entries=n,"item-key":"id",handle:".entry-drag-handle",onEnd:n=>W(r,n)},{item:_(({element:n,index:m})=>[e("div",{class:C(["entry-item",{disabled:!o.enabled}])},[e("div",te,[e("button",le,[d(c,{name:"drag-handle"})]),e("input",{type:"text",value:n.title,onInput:u=>b(r,m,{title:u.target.value}),placeholder:a(t)("worldbook.entryTitlePlaceholder"),class:"entry-title-input"},null,40,ne),e("div",ae,[e("button",{onClick:u=>B("entry",r,m),class:"delete-btn icon-btn"},[d(c,{name:"trash"})],8,se),e("button",{onClick:u=>b(r,m,{collapsed:!n.collapsed}),class:"collapse-btn icon-btn"},[d(c,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:n.collapsed}])},null,8,["class"])],8,de)])]),n.collapsed?k("",!0):(h(),y("div",re,[e("input",{type:"text",value:n.notes,onInput:u=>b(r,m,{notes:u.target.value}),placeholder:a(t)("worldbook.notesPlaceholder"),class:"base-input"},null,40,ie),e("textarea",{value:n.content,onInput:u=>b(r,m,{content:u.target.value}),placeholder:a(t)("worldbook.contentPlaceholder"),class:"base-input"},null,40,ce)]))],2)]),_:2},1032,["modelValue","onUpdate:modelValue","onEnd"])]))])]),_:1},8,["modelValue"]),g.value.length?k("",!0):(h(),y("div",ue,[e("p",null,p(a(t)("worldbook.empty")),1),e("p",null,p(a(t)("worldbook.emptyHint")),1)])),d(H,{visible:v.value,"onUpdate:visible":s[1]||(s[1]=o=>v.value=o),title:a(t)("worldbook.confirmDelete")},{footer:_(()=>[e("button",{onClick:x,class:"modal-btn cancel"},p(a(t)("cancel")),1),e("button",{onClick:P,class:"modal-btn danger"},p(a(t)("delete")),1)]),default:_(()=>[e("div",pe,p(a(t)("worldbook.confirmDeleteMsg")),1)]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},ye=$(_e,[["__scopeId","data-v-471f1422"]]);export{ye as default};
