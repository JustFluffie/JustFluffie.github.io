import{_ as st,k as at,m as lt,q as nt,R as ot,T as it,U as fe,V as ct,r as i,c as k,t as ye,s as dt,i as rt,a as d,e,f as v,z as o,y as a,n as m,S as x,w as U,W as V,I as ut,o as r,b as f,v as p,x as b,C as ke}from"./index-BhBAuxlH.js";import{C as ge}from"./CustomSelect-BZjKflgf.js";import{M as we}from"./MultiSelect-noJnmZB2.js";const vt={class:"chat-settings active"},ht={class:"app-header"},gt={class:"title"},mt={class:"action-btn"},pt={class:"app-content settings-content"},bt={class:"card"},_t={key:"roleInfo"},Ct={class:"card-content"},ft={class:"role-header-layout"},yt=["src"],kt={key:1,class:"role-avatar-placeholder"},wt={class:"role-inputs-wrapper"},St=["placeholder"],Pt=["placeholder"],Bt={class:"form-item-vertical"},It={class:"label-main",style:{"margin-bottom":"5px"}},xt=["placeholder"],Ut={class:"card"},Vt={key:"userInfo"},Tt={class:"card-content"},At={class:"settings-pure-item",style:{"border-bottom":"none"}},Dt={class:"settings-pure-label"},Mt={class:"user-header-layout"},$t=["src"],Nt={key:1,class:"role-avatar-placeholder"},Rt={class:"user-inputs-wrapper"},Ot={class:"user-actions-row"},zt=["placeholder"],Lt={class:"form-item-vertical"},jt={class:"label-main",style:{"margin-bottom":"5px"}},Wt=["placeholder"],Ft={class:"card"},qt={class:"card-title-remark"},Et={key:"backgroundActivity"},Ht={class:"card-content"},Gt={class:"settings-item-input"},Kt={class:"label-col"},Jt={class:"label-main"},Qt={class:"settings-pure-value"},Xt={class:"settings-item-input"},Yt={class:"label-col"},Zt={class:"label-main"},es={class:"label-sub"},ts={class:"mode-selector"},ss={key:0},as={class:"settings-item-input"},ls={class:"label-col"},ns={class:"label-main"},os={class:"label-sub"},is={class:"settings-item-input"},cs={class:"label-col"},ds={class:"label-main"},rs={class:"label-sub"},us={class:"settings-item-input"},vs={class:"label-col"},hs={class:"label-main"},gs={class:"label-sub"},ms={class:"settings-item-input"},ps={class:"label-col"},bs={class:"label-main"},_s={class:"label-sub"},Cs={class:"mode-selector"},fs={key:0,class:"settings-item-input"},ys={class:"label-col"},ks={class:"label-main"},ws={class:"label-sub"},Ss={class:"card"},Ps={key:"modeSettings"},Bs={class:"card-content"},Is={class:"settings-pure-item"},xs={class:"settings-pure-label"},Us={class:"mode-selector"},Vs={key:0,class:"settings-pure-item"},Ts={class:"settings-pure-label"},As={class:"settings-pure-item"},Ds={class:"settings-pure-label"},Ms={class:"settings-item-input"},$s={class:"label-col"},Ns={class:"label-main"},Rs={class:"label-sub"},Os={class:"reply-length-container"},zs=["placeholder"],Ls=["placeholder"],js={class:"card"},Ws={key:"summarySettings"},Fs={class:"card-content"},qs={class:"settings-item-input"},Es={class:"label-col"},Hs={class:"label-main"},Gs={class:"label-sub"},Ks={class:"form-item-vertical"},Js={class:"label-main",style:{"margin-bottom":"5px"}},Qs=["placeholder"],Xs={class:"settings-item-input"},Ys={class:"label-col"},Zs={class:"label-main"},ea={class:"label-sub"},ta={class:"settings-btn-row flex-distribute-children",style:{padding:"15px 0","border-bottom":"1px solid #f5f5f5"}},sa={class:"settings-item-input"},aa={class:"label-col"},la={class:"label-main"},na={class:"label-sub"},oa={class:"settings-pure-item"},ia={class:"settings-pure-label"},ca={class:"settings-pure-item"},da={class:"settings-pure-label"},ra={class:"settings-pure-value"},ua={class:"settings-pure-item"},va={class:"settings-pure-label"},ha={class:"settings-pure-value"},ga={class:"card"},ma={key:"bubbleSettings"},pa={class:"card-content"},ba={class:"settings-section-title"},_a={class:"settings-row-group"},Ca={class:"settings-pure-label",style:{width:"60px"}},fa={style:{flex:"1",margin:"0 10px"}},ya={class:"btn-group-mini"},ka=["disabled"],wa={class:"bubble-preview-container"},Sa={class:"bubble-preview-area"},Pa={class:"preview-msg-row left"},Ba={class:"preview-avatar char"},Ia=["src"],xa={key:1,class:"default-avatar"},Ua={class:"preview-msg-row right"},Va={class:"preview-avatar user"},Ta=["src"],Aa={key:1,class:"default-avatar"},Da={class:"settings-item-input"},Ma={class:"label-col"},$a={class:"label-main"},Na={class:"slider-container gray-slider"},Ra={class:"slider-value"},Oa={class:"form-item-vertical no-border"},za={class:"label-main",style:{"margin-bottom":"5px"}},La=["placeholder"],ja={class:"settings-section-title"},Wa={class:"settings-item-avatar",style:{"border-bottom":"none","margin-bottom":"0"}},Fa={class:"avatar-layout"},qa={class:"avatar-controls",style:{width:"100%"}},Ea={class:"card"},Ha={key:"videoSettings"},Ga={class:"card-content"},Ka={class:"video-settings-container"},Ja={class:"video-setting-col"},Qa={class:"settings-item-label center"},Xa=["src"],Ya={key:1,class:"default-avatar bg-placeholder"},Za={class:"video-setting-col"},el={class:"settings-item-label center"},tl=["src"],sl={key:1,class:"default-avatar bg-placeholder"},al={class:"card"},ll={key:"advancedSettings"},nl={class:"card-content"},ol={class:"settings-pure-item"},il={class:"settings-pure-label"},cl={class:"settings-pure-value"},dl={class:"danger-zone"},rl={class:"danger-btn-content"},ul={class:"danger-btn-title"},vl={class:"danger-btn-desc"},hl={class:"danger-btn-content"},gl={class:"danger-btn-title"},ml={class:"danger-btn-desc"},pl={class:"danger-btn-content"},bl={class:"danger-btn-title"},_l={class:"danger-btn-desc"},Cl={__name:"SingleChatSettings",props:{id:{type:String,required:!0}},setup(Se){const O=Se,{t}=at(),ie=rt(),c=lt(),u=nt(),me=ot(),Pe=it(),{sortedWorldBooks:Be}=fe(Pe),Ie=ct(),{sortedPresets:xe}=fe(Ie),h=i({roleInfo:!1,userInfo:!1,backgroundActivity:!1,modeSettings:!1,summarySettings:!1,bubbleSettings:!1,videoSettings:!1,advancedSettings:!1}),w=i(!1),T=i(""),G=i(""),K=i(""),J=i(""),_=i("default"),Q=i(""),X=i(""),A=i(""),y=i("default"),Y=i(5),Z=i(30),ee=i(10),D=i("always"),te=i(15),M=i(!0),se=i([]),ae=i([]),z=i(""),L=i(""),j=i(20),le=i(""),W=i(!1),ne=i(10),S=i(""),P=i(""),B=i(14),F=i(""),q=i(""),$=i(""),ce=i("default"),pe=i(0),N=i(!1),de=i(0),re=i(0),C=k(()=>c.getCharacter(O.id)),R=k(()=>{var l;return((l=C.value)==null?void 0:l.name)||t("chat.unknownCharacter")}),oe=k(()=>{var l;return(l=C.value)==null?void 0:l.avatar}),Ue=k(()=>[{value:"default",label:t("chat.singleChat.settings.defaultUserPersona")},...(c.userPersonas||[]).map(l=>({value:l.id,label:l.name}))]),Ve=k(()=>[{value:"default",label:t("chat.singleChat.settings.default")+"配置"},{value:"api1",label:"配置一"},{value:"api2",label:"配置二"}]),Te=k(()=>[{value:"",label:t("chat.singleChat.settings.custom")},...(c.bubblePresets||[]).map(l=>({value:l.id,label:l.name}))]),Ae=k(()=>y.value==="on"?!0:y.value==="off"?!1:me.globalBackgroundActivity),be=k(()=>{const l={fontSize:`${B.value}px`};if(!P.value)return l;const s={};return P.value.split(";").forEach(n=>{const g=n.split(":");if(g.length>=2){const E=g[0].trim(),H=g.slice(1).join(":").trim();E&&H&&(s[E]=H)}}),{...l,...s}}),De=k(()=>({avatar:t("chat.singleChat.settings.toast.setCharAvatar"),userPersonaAvatar:t("chat.singleChat.settings.toast.setUserAvatar"),chatBg:t("chat.singleChat.settings.toast.setChatBg"),videoBg:t("chat.singleChat.settings.toast.setCharImg"),userVideoImg:t("chat.singleChat.settings.toast.setUserImg")})[T.value]||t("chat.singleChat.settings.toast.upload"));ye(_,l=>{l&&he(l)}),ye(S,l=>{l&&Fe(l)}),dt(()=>{if(!C.value){ue();return}Le()});const I=l=>{h.value[l]=!h.value[l]},ue=()=>{ie.back()},Me=()=>{ie.push({name:"memory-bank",params:{charId:O.id}})},$e=()=>{T.value="avatar",w.value=!0},Ne=()=>{T.value="userPersonaAvatar",w.value=!0},Re=()=>{T.value="chatBg",w.value=!0},Oe=()=>{T.value="videoBg",w.value=!0},ze=()=>{T.value="userVideoImg",w.value=!0},Le=()=>{var H;const l=C.value;G.value=l.name,K.value=l.nickname||"",J.value=l.charPersona||"",_.value=l.userPersona||"default",he(_.value),y.value=l.backgroundActivityOverride||"default",Y.value=l.proactiveInterval||5,Z.value=l.proactiveCooldown||30,ee.value=l.proactiveDailyLimit||10,D.value=l.triggerMode||"always",te.value=l.proactiveIdleTime||15,M.value=l.isOnline!==!1,se.value=Array.isArray(l.preset)?l.preset:l.preset?[l.preset]:[],ae.value=l.worldbook||[];const[s,n]=(l.replyLength||(M.value?"10-50":"200-500")).split("-");z.value=s||"",L.value=n||"",j.value=l.summaryRange||20,le.value=l.summaryPrompt||"",W.value=l.autoSummary||!1,ne.value=l.memoryCount||10;const g=l.bubbleSettings||{};P.value=g.css||"",B.value=g.fontSize||14,F.value=l.chatBackground||"",q.value=l.videoBg||"",$.value=l.userVideoImg||"",ce.value=l.api||"default",pe.value=((H=l.npc)==null?void 0:H.length)||0,N.value=l.isBlocked||!1;const E=c.messages[O.id]||[];re.value=E.length,de.value=Math.ceil(E.reduce((et,tt)=>{var Ce;return et+(((Ce=tt.content)==null?void 0:Ce.length)||0)},0)*1.5)},ve=()=>{const l=C.value;l&&(Object.assign(l,{name:G.value.trim()||l.name,nickname:K.value.trim(),charPersona:J.value,userPersona:_.value,backgroundActivityOverride:y.value,proactiveInterval:Y.value,proactiveCooldown:Z.value,proactiveDailyLimit:ee.value,triggerMode:D.value,proactiveIdleTime:te.value,isOnline:M.value,preset:se.value,worldbook:ae.value,replyLength:`${z.value}-${L.value}`,summaryRange:j.value,summaryPrompt:le.value,autoSummary:W.value,memoryCount:ne.value,bubbleSettings:{css:P.value,fontSize:B.value},chatBackground:F.value,videoBg:q.value,userVideoImg:$.value,isBlocked:N.value}),c.saveData(),u.showToast(t("theme.toast.saveSuccess")))},he=l=>{const s=t("chat.singleChat.settings.defaultUserPersona");let n=c.userPersonas.find(g=>g.id===l)||{name:s,avatar:"",description:"",videoImg:""};Q.value=n.name===s?"":n.name,X.value=n.description||"",A.value=n.avatar||"",l!=="default"&&($.value=n.videoImg||"")},je=()=>{const l=Q.value.trim();if(!l)return u.showToast(t("chat.singleChat.settings.toast.personaNameRequired"),"error");const s={id:_.value==="default"?Date.now().toString():_.value,name:l,description:X.value,avatar:A.value,videoImg:$.value};if(_.value==="default")c.userPersonas.push(s),_.value=s.id,u.showToast(t("chat.singleChat.settings.toast.personaSaved"));else{const n=c.userPersonas.findIndex(g=>g.id===_.value);n!==-1&&(c.userPersonas[n]=s,u.showToast(t("chat.singleChat.settings.toast.personaUpdated")))}c.saveData()},We=()=>{if(_.value==="default")return u.showToast(t("chat.singleChat.settings.toast.defaultPersonaDelete"),"error");u.showConfirm(t("chat.singleChat.settings.toast.deletePersona"),t("chat.singleChat.settings.toast.confirmDeletePersona"),()=>{c.userPersonas=c.userPersonas.filter(l=>l.id!==_.value),c.characters.forEach(l=>{l.userPersona===_.value&&(l.userPersona="default")}),_.value="default",he("default"),c.saveData()})},Fe=l=>{if(!l)return;const s=c.bubblePresets.find(n=>n.id===l);s&&(P.value=s.css,B.value=s.fontSize)},qe=()=>{const l=prompt(t("chat.singleChat.settings.toast.presetNameRequired"));if(!l)return;const s={id:Date.now().toString(),name:l,css:P.value,fontSize:B.value};c.bubblePresets.push(s),c.saveData(),S.value=s.id,u.showToast(t("chat.singleChat.settings.toast.presetSaved"))},Ee=()=>{S.value&&u.showConfirm(t("chat.singleChat.settings.toast.deleteBubblePreset"),t("chat.singleChat.settings.toast.confirmDeleteBubblePreset"),()=>{c.bubblePresets=c.bubblePresets.filter(l=>l.id!==S.value),c.saveData(),S.value="",u.showToast(t("chat.singleChat.settings.toast.presetDeleted"))})},He=l=>{const s=typeof l=="string"?l:l.content,n=T.value,g={avatar:{obj:C.value,key:"avatar",toast:t("chat.singleChat.settings.toast.avatarUpdated")},userPersonaAvatar:{obj:A,key:"value",toast:t("chat.singleChat.settings.toast.avatarUrlSet")},chatBg:{obj:C.value,key:"chatBackground",toast:t("chat.singleChat.settings.toast.backgroundUpdated"),localRef:F},videoBg:{obj:C.value,key:"videoBg",toast:t("chat.singleChat.settings.toast.charImageUpdated"),localRef:q},userVideoImg:{obj:C.value,key:"userVideoImg",toast:t("chat.singleChat.settings.toast.userImageUpdated"),localRef:$}};g[n]&&(g[n].obj[g[n].key]=s,g[n].localRef&&(g[n].localRef.value=s),n!=="userPersonaAvatar"&&c.saveData(),u.showToast(g[n].toast)),w.value=!1},Ge=()=>{if(!F.value)return u.showToast(t("chat.singleChat.settings.toast.noBgToApply"));u.showConfirm(t("chat.singleChat.settings.toast.applyBgToAll"),t("chat.singleChat.settings.toast.confirmApplyBgToAll"),()=>{c.applyChatBackgroundToAll(F.value),u.showToast(t("chat.singleChat.settings.toast.appliedToAll"))})},_e=l=>{M.value=l,[z.value,L.value]=l?["10","50"]:["200","500"]},Ke=()=>{u.showConfirm(t("chat.singleChat.settings.confirmSummaryTitle"),t("chat.singleChat.settings.confirmSummaryMsg",{count:j.value}),()=>{const l=`[${t("chat.singleChat.settings.autoSummary")}] 与${R.value}进行了愉快的对话...`;C.value.memories||(C.value.memories=[]),C.value.memories.unshift({content:l,time:Date.now(),charName:R.value}),c.saveData(),u.showToast(t("chat.singleChat.settings.toast.summaryDone"))})},Je=()=>{u.showConfirm(t("chat.singleChat.settings.confirmBlockTitle",{name:R.value}),t("chat.singleChat.settings.confirmBlockMsg",{name:R.value}),()=>{N.value=!0,ve(),u.showToast(t("chat.singleChat.settings.toast.blocked"))},{messageStyle:{color:"#FF3B30",whiteSpace:"pre-wrap"},confirmText:"chat.singleChat.settings.block"})},Qe=()=>{N.value=!1,ve(),u.showToast(t("chat.singleChat.settings.toast.unblocked"))},Xe=()=>{u.showConfirm(t("chat.singleChat.settings.confirmClearTitle"),t("chat.singleChat.settings.confirmClearMsg",{name:R.value}),()=>{c.clearChatHistory(O.id),u.showToast(t("chat.singleChat.settings.toast.historyCleared")),re.value=0,de.value=0},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"chat.singleChat.settings.clear"})},Ye=()=>{N.value?Qe():Je()},Ze=()=>{u.showConfirm(t("chat.deleteCharacterTitle"),t("chat.deleteCharacterConfirm",{name:R.value}),()=>{c.deleteCharacter(O.id),u.showToast(t("chat.toast.deleteSuccess"),"success"),ue(),ie.push({name:"chat-list"})},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"delete"})};return(l,s)=>(r(),d("div",vt,[e("div",ht,[e("div",{class:"back-btn",onClick:ue},[...s[38]||(s[38]=[e("svg",{class:"svg-icon",viewBox:"0 0 24 24"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])]),e("div",gt,o(a(t)("chat.singleChat.settings.title")),1),e("div",mt,[e("button",{class:"header-save-btn",onClick:ve},o(a(t)("save")),1)])]),e("div",pt,[e("div",bt,[e("div",{class:"card-title",onClick:s[0]||(s[0]=n=>I("roleInfo"))},[e("span",null,o(a(t)("chat.singleChat.settings.roleInfo")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.roleInfo}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.roleInfo?f("",!0):(r(),d("div",_t,[e("div",Ct,[e("div",ft,[e("div",{class:"role-avatar-wrapper",onClick:$e},[oe.value?(r(),d("img",{key:0,src:oe.value,alt:"头像",class:"role-avatar-img"},null,8,yt)):(r(),d("div",kt,o(a(t)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",wt,[p(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=n=>G.value=n),class:"base-input",placeholder:a(t)("chat.singleChat.settings.roleNamePlaceholder")},null,8,St),[[b,G.value]]),p(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=n=>K.value=n),class:"base-input",placeholder:a(t)("chat.singleChat.settings.roleNicknamePlaceholder")},null,8,Pt),[[b,K.value]])])]),e("div",Bt,[e("div",It,o(a(t)("chat.singleChat.settings.rolePersona")),1),p(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=n=>J.value=n),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:a(t)("chat.singleChat.settings.rolePersonaPlaceholder")},null,8,xt),[[b,J.value]])])])]))]),_:1})]),e("div",Ut,[e("div",{class:"card-title",onClick:s[4]||(s[4]=n=>I("userInfo"))},[e("span",null,o(a(t)("chat.singleChat.settings.userInfo")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.userInfo}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.userInfo?f("",!0):(r(),d("div",Vt,[e("div",Tt,[e("div",At,[e("div",Dt,o(a(t)("chat.singleChat.settings.currentUserPersona")),1),v(ge,{options:Ue.value,modelValue:_.value,"onUpdate:modelValue":s[5]||(s[5]=n=>_.value=n)},null,8,["options","modelValue"])]),e("div",Mt,[e("div",{class:"user-avatar-wrapper",onClick:Ne},[A.value?(r(),d("img",{key:0,src:A.value,alt:"User",class:"role-avatar-img"},null,8,$t)):(r(),d("div",Nt,o(a(t)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",Rt,[e("div",Ot,[e("button",{class:"btn btn-secondary btn-mini-grow",onClick:je},o(a(t)("chat.singleChat.settings.savePersona")),1),e("button",{class:"btn btn-danger btn-mini-grow",onClick:We},o(a(t)("chat.singleChat.settings.deletePersona")),1)]),p(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=n=>Q.value=n),class:"base-input",placeholder:a(t)("chat.singleChat.settings.userNamePlaceholder")},null,8,zt),[[b,Q.value]])])]),e("div",Lt,[e("div",jt,o(a(t)("chat.singleChat.settings.userPersona")),1),p(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=n=>X.value=n),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:a(t)("chat.singleChat.settings.userPersonaPlaceholder")},null,8,Wt),[[b,X.value]])])])]))]),_:1})]),e("div",Ft,[e("div",{class:"card-title",onClick:s[8]||(s[8]=n=>I("backgroundActivity"))},[e("span",null,o(a(t)("chat.singleChat.settings.backgroundActivity")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.backgroundActivity}])},[v(x,{name:"chevron-down"})],2)]),e("div",qt,o(a(t)("chat.singleChat.settings.backgroundActivityWarning")),1),v(V,{name:"collapse"},{default:U(()=>[h.value.backgroundActivity?f("",!0):(r(),d("div",Et,[e("div",Ht,[e("div",Gt,[e("div",Kt,[e("div",Jt,o(a(t)("chat.singleChat.settings.globalSettings")),1)]),e("div",Qt,o(a(me).globalBackgroundActivity?a(t)("chat.singleChat.settings.globalOn"):a(t)("chat.singleChat.settings.globalOff")),1)]),e("div",Xt,[e("div",Yt,[e("div",Zt,o(a(t)("chat.singleChat.settings.overrideGlobal")),1),e("div",es,o(a(t)("chat.singleChat.settings.overrideGlobalDesc")),1)]),e("div",ts,[e("div",{class:m(["mode-option",{active:y.value==="default"}]),onClick:s[9]||(s[9]=n=>y.value="default")},o(a(t)("chat.singleChat.settings.default")),3),e("div",{class:m(["mode-option",{active:y.value==="on"}]),onClick:s[10]||(s[10]=n=>y.value="on")},o(a(t)("chat.singleChat.settings.on")),3),e("div",{class:m(["mode-option",{active:y.value==="off"}]),onClick:s[11]||(s[11]=n=>y.value="off")},o(a(t)("chat.singleChat.settings.off")),3)])]),Ae.value?(r(),d("div",ss,[e("div",as,[e("div",ls,[e("div",ns,o(a(t)("chat.singleChat.settings.interval")),1),e("div",os,o(a(t)("chat.singleChat.settings.intervalDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[12]||(s[12]=n=>Y.value=n),class:"base-input base-input-short",placeholder:"5"},null,512),[[b,Y.value,void 0,{number:!0}]])]),e("div",is,[e("div",cs,[e("div",ds,o(a(t)("chat.singleChat.settings.cooldown")),1),e("div",rs,o(a(t)("chat.singleChat.settings.cooldownDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[13]||(s[13]=n=>Z.value=n),class:"base-input base-input-short",placeholder:"30"},null,512),[[b,Z.value,void 0,{number:!0}]])]),e("div",us,[e("div",vs,[e("div",hs,o(a(t)("chat.singleChat.settings.dailyLimit")),1),e("div",gs,o(a(t)("chat.singleChat.settings.dailyLimitDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[14]||(s[14]=n=>ee.value=n),class:"base-input base-input-short",placeholder:"10"},null,512),[[b,ee.value,void 0,{number:!0}]])]),e("div",ms,[e("div",ps,[e("div",bs,o(a(t)("chat.singleChat.settings.triggerMode")),1),e("div",_s,o(a(t)("chat.singleChat.settings.triggerModeDesc")),1)]),e("div",Cs,[e("div",{class:m(["mode-option",{active:D.value==="idle"}]),onClick:s[15]||(s[15]=n=>D.value="idle")},o(a(t)("chat.singleChat.settings.idleMode")),3),e("div",{class:m(["mode-option",{active:D.value==="always"}]),onClick:s[16]||(s[16]=n=>D.value="always")},o(a(t)("chat.singleChat.settings.alwaysMode")),3)])]),D.value==="idle"?(r(),d("div",fs,[e("div",ys,[e("div",ks,o(a(t)("chat.singleChat.settings.idleTime")),1),e("div",ws,o(a(t)("chat.singleChat.settings.idleTimeDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[17]||(s[17]=n=>te.value=n),class:"base-input base-input-short",placeholder:"15"},null,512),[[b,te.value,void 0,{number:!0}]])])):f("",!0)])):f("",!0)])]))]),_:1})]),e("div",Ss,[e("div",{class:"card-title",onClick:s[18]||(s[18]=n=>I("modeSettings"))},[e("span",null,o(a(t)("chat.singleChat.settings.mode")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.modeSettings}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.modeSettings?f("",!0):(r(),d("div",Ps,[e("div",Bs,[e("div",Is,[e("div",xs,o(a(t)("chat.singleChat.settings.modeSelect")),1),e("div",Us,[e("div",{class:m(["mode-option",{active:M.value}]),onClick:s[19]||(s[19]=n=>_e(!0))},o(a(t)("chat.singleChat.settings.online")),3),e("div",{class:m(["mode-option",{active:!M.value}]),onClick:s[20]||(s[20]=n=>_e(!1))},o(a(t)("chat.singleChat.settings.offline")),3)])]),M.value?f("",!0):(r(),d("div",Vs,[e("div",Ts,o(a(t)("chat.singleChat.settings.linkPreset")),1),v(we,{modelValue:se.value,"onUpdate:modelValue":s[21]||(s[21]=n=>se.value=n),options:a(xe),labelKey:"title",valueKey:"id",childrenKey:"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])])),e("div",As,[e("div",Ds,o(a(t)("chat.singleChat.settings.linkWorldbook")),1),v(we,{modelValue:ae.value,"onUpdate:modelValue":s[22]||(s[22]=n=>ae.value=n),options:a(Be),"label-key":"title","value-key":"id","children-key":"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])]),e("div",Ms,[e("div",$s,[e("div",Ns,o(a(t)("chat.singleChat.settings.replyLength")),1),e("div",Rs,o(a(t)("chat.singleChat.settings.replyLengthDesc")),1)]),e("div",Os,[p(e("input",{type:"number","onUpdate:modelValue":s[23]||(s[23]=n=>z.value=n),class:"base-input base-input-mini",placeholder:a(t)("chat.singleChat.settings.min")},null,8,zs),[[b,z.value]]),s[39]||(s[39]=e("span",null,"-",-1)),p(e("input",{type:"number","onUpdate:modelValue":s[24]||(s[24]=n=>L.value=n),class:"base-input base-input-mini",placeholder:a(t)("chat.singleChat.settings.max")},null,8,Ls),[[b,L.value]])])])])]))]),_:1})]),e("div",js,[e("div",{class:"card-title",onClick:s[25]||(s[25]=n=>I("summarySettings"))},[e("span",null,o(a(t)("chat.singleChat.settings.summary")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.summarySettings}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.summarySettings?f("",!0):(r(),d("div",Ws,[e("div",Fs,[e("div",qs,[e("div",Es,[e("div",Hs,o(a(t)("chat.singleChat.settings.summaryRange")),1),e("div",Gs,o(a(t)("chat.singleChat.settings.summaryRangeDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[26]||(s[26]=n=>j.value=n),class:"base-input base-input-short",placeholder:"20"},null,512),[[b,j.value,void 0,{number:!0}]])]),e("div",Ks,[e("div",Js,o(a(t)("chat.singleChat.settings.summaryPrompt")),1),p(e("textarea",{"onUpdate:modelValue":s[27]||(s[27]=n=>le.value=n),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:a(t)("chat.singleChat.settings.summaryPromptPlaceholder")},null,8,Qs),[[b,le.value]])]),e("div",Xs,[e("div",Ys,[e("div",Zs,o(a(t)("chat.singleChat.settings.autoSummary")),1),e("div",ea,o(a(t)("chat.singleChat.settings.autoSummaryDesc")),1)]),e("div",{class:m(["toggle-switch",{active:W.value}]),onClick:s[28]||(s[28]=n=>W.value=!W.value)},null,2)]),e("div",ta,[e("button",{class:"btn btn-secondary",onClick:Ke},o(a(t)("chat.singleChat.settings.manualSummary")),1),e("button",{class:"btn btn-secondary",onClick:Me},o(a(t)("chat.singleChat.settings.viewSummary")),1)]),e("div",sa,[e("div",aa,[e("div",la,o(a(t)("chat.singleChat.settings.contextMemory")),1),e("div",na,o(a(t)("chat.singleChat.settings.contextMemoryDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[29]||(s[29]=n=>ne.value=n),class:"base-input base-input-short",placeholder:"10"},null,512),[[b,ne.value,void 0,{number:!0}]])]),e("div",oa,[e("div",ia,o(a(t)("chat.singleChat.settings.apiConfig")),1),v(ge,{options:Ve.value,modelValue:ce.value,"onUpdate:modelValue":s[30]||(s[30]=n=>ce.value=n)},null,8,["options","modelValue"])]),e("div",ca,[e("div",da,o(a(t)("chat.singleChat.settings.tokenCount")),1),e("div",ra,o(de.value),1)]),e("div",ua,[e("div",va,o(a(t)("chat.singleChat.settings.msgCount")),1),e("div",ha,o(re.value),1)])])]))]),_:1})]),e("div",ga,[e("div",{class:"card-title",onClick:s[31]||(s[31]=n=>I("bubbleSettings"))},[e("span",null,o(a(t)("chat.singleChat.settings.beautification")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.bubbleSettings}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.bubbleSettings?f("",!0):(r(),d("div",ma,[e("div",pa,[e("div",ba,o(a(t)("chat.singleChat.settings.bubble")),1),e("div",_a,[e("div",Ca,o(a(t)("chat.singleChat.settings.bubblePreset")),1),e("div",fa,[v(ge,{options:Te.value,modelValue:S.value,"onUpdate:modelValue":s[32]||(s[32]=n=>S.value=n)},null,8,["options","modelValue"])]),e("div",ya,[e("button",{class:"btn btn-secondary btn-mini",onClick:qe},o(a(t)("save")),1),e("button",{class:"btn btn-danger btn-mini",disabled:!S.value,onClick:Ee},o(a(t)("delete")),9,ka)])]),e("div",wa,[e("div",Sa,[e("div",Pa,[e("div",Ba,[oe.value?(r(),d("img",{key:0,src:oe.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Ia)):(r(),d("div",xa))]),e("div",{class:"preview-bubble char",style:ke(be.value)},o(a(t)("chat.singleChat.settings.bubblePreview")),5)]),e("div",Ua,[e("div",{class:"preview-bubble user",style:ke(be.value)},o(a(t)("chat.singleChat.settings.bubblePreview")),5),e("div",Va,[A.value?(r(),d("img",{key:0,src:A.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Ta)):(r(),d("div",Aa))])])])]),e("div",Da,[e("div",Ma,[e("div",$a,o(a(t)("chat.singleChat.settings.fontSize")),1)]),e("div",Na,[p(e("input",{type:"range","onUpdate:modelValue":s[33]||(s[33]=n=>B.value=n),min:"10",max:"30",step:"1"},null,512),[[b,B.value,void 0,{number:!0}]]),e("span",Ra,o(B.value),1)])]),e("div",Oa,[e("div",za,o(a(t)("chat.singleChat.settings.bubbleCss")),1),p(e("textarea",{"onUpdate:modelValue":s[34]||(s[34]=n=>P.value=n),class:"base-input",placeholder:a(t)("chat.singleChat.settings.cssPlaceholder"),style:{"font-family":"monospace",height:"120px"}},null,8,La),[[b,P.value]])]),s[40]||(s[40]=e("div",{class:"settings-divider"},null,-1)),e("div",ja,o(a(t)("chat.singleChat.settings.chatBackground")),1),e("div",Wa,[e("div",Fa,[e("div",qa,[e("button",{class:"btn btn-secondary",onClick:Re},o(a(t)("chat.singleChat.settings.setChatBackground")),1),e("button",{class:"btn btn-secondary",onClick:Ge,style:{"margin-top":"5px"}},o(a(t)("chat.singleChat.settings.applyToAll")),1)])])])])]))]),_:1})]),e("div",Ea,[e("div",{class:"card-title",onClick:s[35]||(s[35]=n=>I("videoSettings"))},[e("span",null,o(a(t)("chat.singleChat.settings.videoCall")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.videoSettings}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.videoSettings?f("",!0):(r(),d("div",Ha,[e("div",Ga,[e("div",Ka,[e("div",Ja,[e("div",Qa,o(a(t)("chat.singleChat.settings.characterImage")),1),e("div",{class:"video-preview",onClick:Oe},[q.value?(r(),d("img",{key:0,src:q.value,class:"bg-img"},null,8,Xa)):(r(),d("div",Ya,o(a(t)("chat.singleChat.settings.setImage")),1))])]),e("div",Za,[e("div",el,o(a(t)("chat.singleChat.settings.userImage")),1),e("div",{class:"video-preview",onClick:ze},[$.value?(r(),d("img",{key:0,src:$.value,class:"bg-img"},null,8,tl)):(r(),d("div",sl,o(a(t)("chat.singleChat.settings.setImage")),1))])])])])]))]),_:1})]),e("div",al,[e("div",{class:"card-title",onClick:s[36]||(s[36]=n=>I("advancedSettings"))},[e("span",null,o(a(t)("chat.singleChat.settings.advanced")),1),e("div",{class:m(["collapse-arrow",{collapsed:h.value.advancedSettings}])},[v(x,{name:"chevron-down"})],2)]),v(V,{name:"collapse"},{default:U(()=>[h.value.advancedSettings?f("",!0):(r(),d("div",ll,[e("div",nl,[e("div",ol,[e("div",il,o(a(t)("chat.singleChat.settings.linkedNpc")),1),e("div",cl,o(a(t)("chat.singleChat.settings.npcCount",{count:pe.value})),1),s[41]||(s[41]=e("div",{class:"settings-pure-arrow"},"›",-1))])])]))]),_:1})]),e("div",dl,[e("button",{class:"btn btn-danger big-btn",onClick:Ye},[e("div",rl,[e("div",ul,o(N.value?a(t)("chat.singleChat.settings.unblock"):a(t)("chat.singleChat.settings.blockCharacter")),1),e("div",vl,o(a(t)("chat.singleChat.settings.blockCharacterDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:Xe},[e("div",hl,[e("div",gl,o(a(t)("chat.singleChat.settings.clearHistory")),1),e("div",ml,o(a(t)("chat.singleChat.settings.clearHistoryDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:Ze},[e("div",pl,[e("div",bl,o(a(t)("chat.deleteCharacterTitle")),1),e("div",_l,o(a(t)("chat.deleteCharacterWarning")),1)])])])]),v(ut,{visible:w.value,"onUpdate:visible":s[37]||(s[37]=n=>w.value=n),type:"basic","biz-type":"avatar",title:De.value,onSendImage:He},null,8,["visible","title"])]))}},wl=st(Cl,[["__scopeId","data-v-bf458e89"]]);export{wl as default};
