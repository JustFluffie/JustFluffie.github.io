import{_ as rt,k as ut,m as vt,q as gt,U as ht,V as pt,O as we,W as mt,r as i,c as w,t as Se,s as bt,i as _t,a as u,e,f as v,z as o,y as l,n as _,S as A,w as C,X as M,I as Ct,M as Pe,o as g,b as f,v as p,x as m,C as Ie}from"./index-pecgbHBA.js";import{C as be}from"./CustomSelect-DPvCuSUR.js";import{M as Be}from"./MultiSelect-sMyY73yq.js";const ft={class:"chat-settings active"},yt={class:"app-header"},kt={class:"title"},wt={class:"action-btn"},St={class:"app-content settings-content"},Pt={class:"card"},It={key:"roleInfo"},Bt={class:"card-content"},xt={class:"role-header-layout"},Ut=["src"],Vt={key:1,class:"role-avatar-placeholder"},Tt={class:"role-inputs-wrapper"},At=["placeholder"],Mt=["placeholder"],Dt={class:"form-item-vertical"},zt={class:"label-main",style:{"margin-bottom":"5px"}},Rt=["placeholder"],$t={class:"card"},Nt={key:"userInfo"},Ot={class:"card-content"},Lt={class:"settings-pure-item",style:{"border-bottom":"none"}},Wt={class:"settings-pure-label"},jt={class:"user-header-layout"},Ft=["src"],qt={key:1,class:"role-avatar-placeholder"},Et={class:"user-inputs-wrapper"},Ht={class:"user-actions-row"},Gt=["placeholder"],Kt={class:"form-item-vertical"},Xt={class:"label-main",style:{"margin-bottom":"5px"}},Jt=["placeholder"],Qt={class:"card"},Yt={class:"card-title-remark"},Zt={key:"backgroundActivity"},es={class:"card-content"},ts={class:"settings-item-input"},ss={class:"label-col"},as={class:"label-main"},ls={class:"settings-pure-value"},ns={class:"settings-item-input"},os={class:"label-col"},is={class:"label-main"},cs={class:"label-sub"},ds={class:"mode-selector"},rs={key:0},us={class:"settings-item-input"},vs={class:"label-col"},gs={class:"label-main"},hs={class:"label-sub"},ps={class:"settings-item-input"},ms={class:"label-col"},bs={class:"label-main"},_s={class:"label-sub"},Cs={class:"settings-item-input"},fs={class:"label-col"},ys={class:"label-main"},ks={class:"label-sub"},ws={class:"settings-item-input"},Ss={class:"label-col"},Ps={class:"label-main"},Is={class:"label-sub"},Bs={class:"mode-selector"},xs={key:0,class:"settings-item-input"},Us={class:"label-col"},Vs={class:"label-main"},Ts={class:"label-sub"},As={class:"card"},Ms={key:"modeSettings"},Ds={class:"card-content"},zs={class:"settings-pure-item"},Rs={class:"settings-pure-label"},$s={class:"mode-selector"},Ns={key:0,class:"settings-pure-item"},Os={class:"settings-pure-label"},Ls={class:"settings-pure-item"},Ws={class:"settings-pure-label"},js={class:"settings-item-input"},Fs={class:"label-col"},qs={class:"label-main"},Es={class:"label-sub"},Hs={class:"reply-length-container"},Gs=["placeholder"],Ks=["placeholder"],Xs={class:"card"},Js={key:"summarySettings"},Qs={class:"card-content"},Ys={class:"settings-item-input"},Zs={class:"label-col"},ea={class:"label-main"},ta={class:"label-sub"},sa={class:"form-item-vertical"},aa={class:"label-main",style:{"margin-bottom":"5px"}},la=["placeholder"],na={class:"settings-item-input"},oa={class:"label-col"},ia={class:"label-main"},ca={class:"label-sub"},da={class:"settings-btn-row flex-distribute-children",style:{padding:"15px 0","border-bottom":"1px solid #f5f5f5"}},ra={class:"settings-item-input"},ua={class:"label-col"},va={class:"label-main"},ga={class:"label-sub"},ha={class:"settings-pure-item"},pa={class:"settings-pure-label"},ma={class:"settings-pure-item"},ba={class:"settings-pure-label"},_a={class:"settings-pure-value"},Ca={class:"settings-pure-item"},fa={class:"settings-pure-label"},ya={class:"settings-pure-value"},ka={class:"card"},wa={key:"bubbleSettings"},Sa={class:"card-content"},Pa={class:"settings-section-title"},Ia={class:"settings-row-group"},Ba={class:"settings-pure-label",style:{width:"60px"}},xa={style:{flex:"1",margin:"0 10px"}},Ua={class:"btn-group-mini"},Va=["disabled"],Ta={class:"bubble-preview-container"},Aa={class:"bubble-preview-area"},Ma={class:"preview-msg-row left"},Da={class:"preview-avatar char"},za=["src"],Ra={key:1,class:"default-avatar"},$a={class:"preview-msg-row right"},Na={class:"preview-avatar user"},Oa=["src"],La={key:1,class:"default-avatar"},Wa={class:"settings-item-input"},ja={class:"label-col"},Fa={class:"label-main"},qa={class:"slider-container gray-slider"},Ea={class:"slider-value"},Ha={class:"form-item-vertical no-border"},Ga={class:"label-main",style:{"margin-bottom":"5px"}},Ka=["placeholder"],Xa={class:"settings-section-title"},Ja={class:"settings-item-avatar",style:{"border-bottom":"none","margin-bottom":"0"}},Qa={class:"avatar-layout"},Ya={class:"avatar-controls",style:{width:"100%"}},Za={class:"card"},el={key:"videoSettings"},tl={class:"card-content"},sl={class:"video-settings-container"},al={class:"video-setting-col"},ll={class:"settings-item-label center"},nl=["src"],ol={key:1,class:"default-avatar bg-placeholder"},il={class:"video-setting-col"},cl={class:"settings-item-label center"},dl=["src"],rl={key:1,class:"default-avatar bg-placeholder"},ul={class:"card"},vl={key:"advancedSettings"},gl={class:"card-content"},hl={class:"settings-pure-item"},pl={class:"settings-pure-label"},ml={class:"settings-pure-value"},bl={class:"danger-zone"},_l={class:"danger-btn-content"},Cl={class:"danger-btn-title"},fl={class:"danger-btn-desc"},yl={class:"danger-btn-content"},kl={class:"danger-btn-title"},wl={class:"danger-btn-desc"},Sl={class:"danger-btn-content"},Pl={class:"danger-btn-title"},Il={class:"danger-btn-desc"},Bl={class:"modal-options centered-text"},xl={class:"option-text"},Ul={class:"option-text"},Vl={class:"option-text"},Tl=["placeholder"],Al={__name:"SingleChatSettings",props:{id:{type:String,required:!0}},setup(xe){const S=xe,{t}=ut(),ue=_t(),c=vt(),d=gt(),_e=ht(),Ue=pt(),{sortedWorldBooks:Ve}=we(Ue),Te=mt(),{sortedPresets:Ae}=we(Te),h=i({roleInfo:!1,userInfo:!1,backgroundActivity:!1,modeSettings:!1,summarySettings:!1,bubbleSettings:!1,videoSettings:!1,advancedSettings:!1}),P=i(!1),D=i(""),X=i(""),J=i(""),Q=i(""),b=i("default"),L=i(""),j=i(""),I=i(""),y=i("default"),Y=i(5),Z=i(30),ee=i(10),z=i("always"),te=i(15),R=i(!0),se=i([]),ae=i([]),F=i(""),q=i(""),le=i(20),ne=i(""),E=i(!1),oe=i(10),$=i(!1),H=i(!1),ie=i(""),B=i(""),x=i(""),U=i(14),G=i(""),K=i(""),N=i(""),ve=i("default"),Ce=i(0),W=i(!1),ge=i(0),ce=i(0),V=w(()=>c.getCharacter(S.id)),de=w(()=>{var n;return((n=V.value)==null?void 0:n.name)||t("chat.unknownCharacter")}),re=w(()=>{var n;return(n=V.value)==null?void 0:n.avatar}),Me=w(()=>[{value:"default",label:t("chat.singleChat.settings.defaultUserPersona")},...(c.userPersonas||[]).map(n=>({value:n.id,label:n.name}))]),De=w(()=>[{value:"default",label:t("chat.singleChat.settings.default")+"配置"},{value:"api1",label:"配置一"},{value:"api2",label:"配置二"}]),ze=w(()=>[{value:"",label:t("chat.singleChat.settings.custom")},...(c.bubblePresets||[]).map(n=>({value:n.id,label:n.name}))]),Re=w(()=>y.value==="on"?!0:y.value==="off"?!1:_e.globalBackgroundActivity),fe=w(()=>{const n={fontSize:`${U.value}px`};if(!x.value)return n;const s={};return x.value.split(";").forEach(a=>{const r=a.split(":");if(r.length>=2){const k=r[0].trim(),O=r.slice(1).join(":").trim();k&&O&&(s[k]=O)}}),{...n,...s}}),$e=w(()=>({avatar:t("chat.singleChat.settings.toast.setCharAvatar"),userPersonaAvatar:t("chat.singleChat.settings.toast.setUserAvatar"),chatBg:t("chat.singleChat.settings.toast.setChatBg"),videoBg:t("chat.singleChat.settings.toast.setCharImg"),userVideoImg:t("chat.singleChat.settings.toast.setUserImg")})[D.value]||t("chat.singleChat.settings.toast.upload"));Se(b,n=>{n&&me(n)}),Se(B,n=>{n&&Ge(n)}),bt(()=>{if(!V.value){he();return}qe()});const T=n=>{h.value[n]=!h.value[n]},he=()=>{ue.back()},Ne=()=>{ue.push({name:"memory-bank",params:{charId:S.id}})},Oe=()=>{D.value="avatar",P.value=!0},Le=()=>{D.value="userPersonaAvatar",P.value=!0},We=()=>{D.value="chatBg",P.value=!0},je=()=>{D.value="videoBg",P.value=!0},Fe=()=>{D.value="userVideoImg",P.value=!0},qe=()=>{var O;const n=V.value;X.value=n.name,J.value=n.nickname||"",Q.value=n.charPersona||"",b.value=n.userPersona||"default",me(b.value),y.value=n.backgroundActivityOverride||"default",Y.value=n.proactiveInterval||5,Z.value=n.proactiveCooldown||30,ee.value=n.proactiveDailyLimit||10,z.value=n.triggerMode||"always",te.value=n.proactiveIdleTime||15,R.value=n.isOnline!==!1,se.value=Array.isArray(n.preset)?n.preset:n.preset?[n.preset]:[],ae.value=n.worldbook||[];const[s,a]=(n.replyLength||(R.value?"10-50":"200-500")).split("-");F.value=s||"",q.value=a||"",le.value=n.summaryRange||20,ne.value=n.summaryPrompt||"",E.value=n.autoSummary||!1,oe.value=n.memoryCount||10;const r=n.bubbleSettings||{};x.value=r.css||"",U.value=r.fontSize||14,G.value=n.chatBackground||"",K.value=n.videoBg||"",N.value=n.userVideoImg||"",ve.value=n.api||"default",Ce.value=((O=n.npc)==null?void 0:O.length)||0,W.value=n.isBlocked||!1;const k=c.messages[S.id]||[];ce.value=k.length,ge.value=Math.ceil(k.reduce((ct,dt)=>{var ke;return ct+(((ke=dt.content)==null?void 0:ke.length)||0)},0)*1.5)},pe=()=>{const n=V.value;if(!n)return;const s=b.value;let a=c.userPersonas.find(r=>r.id===s);s==="default"&&(a||(a={id:"default",name:t("chat.singleChat.settings.defaultUserPersona"),avatar:"",description:"",videoImg:""},c.userPersonas.unshift(a))),a&&(a.id!=="default"&&L.value.trim()&&(a.name=L.value.trim()),a.description=j.value,a.avatar=I.value,a.videoImg=N.value),Object.assign(n,{name:X.value.trim()||n.name,nickname:J.value.trim(),charPersona:Q.value,userPersona:b.value,backgroundActivityOverride:y.value,proactiveInterval:Y.value,proactiveCooldown:Z.value,proactiveDailyLimit:ee.value,triggerMode:z.value,proactiveIdleTime:te.value,isOnline:R.value,preset:se.value,worldbook:ae.value,replyLength:`${F.value}-${q.value}`,summaryRange:le.value,summaryPrompt:ne.value,autoSummary:E.value,memoryCount:oe.value,bubbleSettings:{css:x.value,fontSize:U.value},chatBackground:G.value,videoBg:K.value,isBlocked:W.value}),c.saveData(),d.showToast(t("theme.toast.saveSuccess"))},me=n=>{const s=t("chat.singleChat.settings.defaultUserPersona");let a=c.userPersonas.find(r=>r.id===n)||{name:s,avatar:"",description:"",videoImg:""};L.value=a.name===s?"":a.name,j.value=a.description||"",I.value=a.avatar||"",n!=="default"&&(N.value=a.videoImg||"")},Ee=()=>{const n=L.value.trim();if(!n)return d.showToast(t("chat.singleChat.settings.toast.personaNameRequired"),"error");const s={id:b.value==="default"?Date.now().toString():b.value,name:n,description:j.value,avatar:I.value,videoImg:N.value};if(b.value==="default")c.userPersonas.push(s),b.value=s.id,d.showToast(t("chat.singleChat.settings.toast.personaSaved"));else{const a=c.userPersonas.findIndex(r=>r.id===b.value);a!==-1&&(c.userPersonas[a]=s,d.showToast(t("chat.singleChat.settings.toast.personaUpdated")))}c.saveData()},He=()=>{if(b.value==="default")return d.showToast(t("chat.singleChat.settings.toast.defaultPersonaDelete"),"error");d.showConfirm(t("chat.singleChat.settings.toast.deletePersona"),t("chat.singleChat.settings.toast.confirmDeletePersona"),()=>{c.userPersonas=c.userPersonas.filter(n=>n.id!==b.value),c.characters.forEach(n=>{n.userPersona===b.value&&(n.userPersona="default")}),b.value="default",me("default"),c.saveData()})},Ge=n=>{if(!n)return;const s=c.bubblePresets.find(a=>a.id===n);s&&(x.value=s.css,U.value=s.fontSize)},Ke=()=>{const n=prompt(t("chat.singleChat.settings.toast.presetNameRequired"));if(!n)return;const s={id:Date.now().toString(),name:n,css:x.value,fontSize:U.value};c.bubblePresets.push(s),c.saveData(),B.value=s.id,d.showToast(t("chat.singleChat.settings.toast.presetSaved"))},Xe=()=>{B.value&&d.showConfirm(t("chat.singleChat.settings.toast.deleteBubblePreset"),t("chat.singleChat.settings.toast.confirmDeleteBubblePreset"),()=>{c.bubblePresets=c.bubblePresets.filter(n=>n.id!==B.value),c.saveData(),B.value="",d.showToast(t("chat.singleChat.settings.toast.presetDeleted"))})},Je=n=>{const s=typeof n=="string"?n:n.content,a=D.value;if(a==="avatar"||a==="chatBg"||a==="videoBg"){const r={avatar:{obj:V.value,key:"avatar",toast:t("chat.singleChat.settings.toast.avatarUpdated")},chatBg:{obj:V.value,key:"chatBackground",toast:t("chat.singleChat.settings.toast.backgroundUpdated"),localRef:G},videoBg:{obj:V.value,key:"videoBg",toast:t("chat.singleChat.settings.toast.charImageUpdated"),localRef:K}};r[a]&&(r[a].obj[r[a].key]=s,r[a].localRef&&(r[a].localRef.value=s),c.saveData(),d.showToast(r[a].toast))}else(a==="userPersonaAvatar"||a==="userVideoImg")&&(a==="userPersonaAvatar"&&(I.value=s),a==="userVideoImg"&&(N.value=s),d.showToast(t("chat.singleChat.settings.toast.avatarUpdated")));P.value=!1},Qe=()=>{if(!G.value)return d.showToast(t("chat.singleChat.settings.toast.noBgToApply"));d.showConfirm(t("chat.singleChat.settings.toast.applyBgToAll"),t("chat.singleChat.settings.toast.confirmApplyBgToAll"),()=>{c.applyChatBackgroundToAll(G.value),d.showToast(t("chat.singleChat.settings.toast.appliedToAll"))})},ye=n=>{R.value=n,[F.value,q.value]=n?["10","50"]:["200","500"]},Ye=()=>{$.value=!0},Ze=()=>{$.value=!1,H.value=!0},et=async()=>{$.value=!1;const n=await c.summarizeMessages(S.id,{type:"recent"});d.showToast(n.message,n.success?"success":"error")},tt=async()=>{const[n,s]=ie.value.split("-").map(O=>O.trim()),a=parseInt(n,10),r=parseInt(s,10);if(isNaN(a)||isNaN(r)||a<=0||r<=0||a>r){d.showToast(t("chat.singleChat.settings.toast.invalidRange"),"error");return}const k=await c.summarizeMessages(S.id,{type:"range",start:a,end:r});d.showToast(k.message,k.success?"success":"error"),k.success&&(H.value=!1,ie.value="")},st=async()=>{$.value=!1;const n=await c.summarizeMessages(S.id,{type:"video"});d.showToast(n.message,n.success?"success":"error")},at=()=>{d.showConfirm(t("chat.singleChat.settings.confirmBlockTitle",{name:de.value}),t("chat.singleChat.settings.confirmBlockMsg",{name:de.value}),()=>{W.value=!0,pe(),d.showToast(t("chat.singleChat.settings.toast.blocked"))},{messageStyle:{color:"#FF3B30",whiteSpace:"pre-wrap"},confirmText:"chat.singleChat.settings.block"})},lt=()=>{W.value=!1,pe(),d.showToast(t("chat.singleChat.settings.toast.unblocked"))},nt=()=>{d.showConfirm(t("chat.singleChat.settings.confirmClearTitle"),t("chat.singleChat.settings.confirmClearMsg",{name:de.value}),()=>{c.clearChatHistory(S.id),d.showToast(t("chat.singleChat.settings.toast.historyCleared")),ce.value=0,ge.value=0},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"chat.singleChat.settings.clear"})},ot=()=>{W.value?lt():at()},it=()=>{d.showConfirm(t("chat.deleteCharacterTitle"),t("chat.deleteCharacterConfirm",{name:de.value}),()=>{c.deleteCharacter(S.id),d.showToast(t("chat.toast.deleteSuccess"),"success"),he(),ue.push({name:"chat-list"})},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"delete"})};return(n,s)=>(g(),u("div",ft,[e("div",yt,[e("div",{class:"back-btn",onClick:he},[...s[43]||(s[43]=[e("svg",{class:"svg-icon",viewBox:"0 0 24 24"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])]),e("div",kt,o(l(t)("chat.singleChat.settings.title")),1),e("div",wt,[e("button",{class:"header-save-btn",onClick:pe},o(l(t)("save")),1)])]),e("div",St,[e("div",Pt,[e("div",{class:"card-title",onClick:s[0]||(s[0]=a=>T("roleInfo"))},[e("span",null,o(l(t)("chat.singleChat.settings.roleInfo")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.roleInfo}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.roleInfo?f("",!0):(g(),u("div",It,[e("div",Bt,[e("div",xt,[e("div",{class:"role-avatar-wrapper",onClick:Oe},[re.value?(g(),u("img",{key:0,src:re.value,alt:"头像",class:"role-avatar-img"},null,8,Ut)):(g(),u("div",Vt,o(l(t)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",Tt,[p(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=a=>X.value=a),class:"base-input",placeholder:l(t)("chat.singleChat.settings.roleNamePlaceholder")},null,8,At),[[m,X.value]]),p(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=a=>J.value=a),class:"base-input",placeholder:l(t)("chat.singleChat.settings.roleNicknamePlaceholder")},null,8,Mt),[[m,J.value]])])]),e("div",Dt,[e("div",zt,o(l(t)("chat.singleChat.settings.rolePersona")),1),p(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>Q.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(t)("chat.singleChat.settings.rolePersonaPlaceholder")},null,8,Rt),[[m,Q.value]])])])]))]),_:1})]),e("div",$t,[e("div",{class:"card-title",onClick:s[4]||(s[4]=a=>T("userInfo"))},[e("span",null,o(l(t)("chat.singleChat.settings.userInfo")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.userInfo}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.userInfo?f("",!0):(g(),u("div",Nt,[e("div",Ot,[e("div",Lt,[e("div",Wt,o(l(t)("chat.singleChat.settings.currentUserPersona")),1),v(be,{options:Me.value,modelValue:b.value,"onUpdate:modelValue":s[5]||(s[5]=a=>b.value=a)},null,8,["options","modelValue"])]),e("div",jt,[e("div",{class:"user-avatar-wrapper",onClick:Le},[I.value?(g(),u("img",{key:0,src:I.value,alt:"User",class:"role-avatar-img"},null,8,Ft)):(g(),u("div",qt,o(l(t)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",Et,[e("div",Ht,[e("button",{class:"btn btn-secondary btn-mini-grow",onClick:Ee},o(l(t)("chat.singleChat.settings.savePersona")),1),e("button",{class:"btn btn-danger btn-mini-grow",onClick:He},o(l(t)("chat.singleChat.settings.deletePersona")),1)]),p(e("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=a=>L.value=a),class:"base-input",placeholder:l(t)("chat.singleChat.settings.userNamePlaceholder")},null,8,Gt),[[m,L.value]])])]),e("div",Kt,[e("div",Xt,o(l(t)("chat.singleChat.settings.userPersona")),1),p(e("textarea",{"onUpdate:modelValue":s[7]||(s[7]=a=>j.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(t)("chat.singleChat.settings.userPersonaPlaceholder")},null,8,Jt),[[m,j.value]])])])]))]),_:1})]),e("div",Qt,[e("div",{class:"card-title",onClick:s[8]||(s[8]=a=>T("backgroundActivity"))},[e("span",null,o(l(t)("chat.singleChat.settings.backgroundActivity")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.backgroundActivity}])},[v(A,{name:"chevron-down"})],2)]),e("div",Yt,o(l(t)("chat.singleChat.settings.backgroundActivityWarning")),1),v(M,{name:"collapse"},{default:C(()=>[h.value.backgroundActivity?f("",!0):(g(),u("div",Zt,[e("div",es,[e("div",ts,[e("div",ss,[e("div",as,o(l(t)("chat.singleChat.settings.globalSettings")),1)]),e("div",ls,o(l(_e).globalBackgroundActivity?l(t)("chat.singleChat.settings.globalOn"):l(t)("chat.singleChat.settings.globalOff")),1)]),e("div",ns,[e("div",os,[e("div",is,o(l(t)("chat.singleChat.settings.overrideGlobal")),1),e("div",cs,o(l(t)("chat.singleChat.settings.overrideGlobalDesc")),1)]),e("div",ds,[e("div",{class:_(["mode-option",{active:y.value==="default"}]),onClick:s[9]||(s[9]=a=>y.value="default")},o(l(t)("chat.singleChat.settings.default")),3),e("div",{class:_(["mode-option",{active:y.value==="on"}]),onClick:s[10]||(s[10]=a=>y.value="on")},o(l(t)("chat.singleChat.settings.on")),3),e("div",{class:_(["mode-option",{active:y.value==="off"}]),onClick:s[11]||(s[11]=a=>y.value="off")},o(l(t)("chat.singleChat.settings.off")),3)])]),Re.value?(g(),u("div",rs,[e("div",us,[e("div",vs,[e("div",gs,o(l(t)("chat.singleChat.settings.interval")),1),e("div",hs,o(l(t)("chat.singleChat.settings.intervalDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[12]||(s[12]=a=>Y.value=a),class:"base-input base-input-short",placeholder:"5"},null,512),[[m,Y.value,void 0,{number:!0}]])]),e("div",ps,[e("div",ms,[e("div",bs,o(l(t)("chat.singleChat.settings.cooldown")),1),e("div",_s,o(l(t)("chat.singleChat.settings.cooldownDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[13]||(s[13]=a=>Z.value=a),class:"base-input base-input-short",placeholder:"30"},null,512),[[m,Z.value,void 0,{number:!0}]])]),e("div",Cs,[e("div",fs,[e("div",ys,o(l(t)("chat.singleChat.settings.dailyLimit")),1),e("div",ks,o(l(t)("chat.singleChat.settings.dailyLimitDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[14]||(s[14]=a=>ee.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[m,ee.value,void 0,{number:!0}]])]),e("div",ws,[e("div",Ss,[e("div",Ps,o(l(t)("chat.singleChat.settings.triggerMode")),1),e("div",Is,o(l(t)("chat.singleChat.settings.triggerModeDesc")),1)]),e("div",Bs,[e("div",{class:_(["mode-option",{active:z.value==="idle"}]),onClick:s[15]||(s[15]=a=>z.value="idle")},o(l(t)("chat.singleChat.settings.idleMode")),3),e("div",{class:_(["mode-option",{active:z.value==="always"}]),onClick:s[16]||(s[16]=a=>z.value="always")},o(l(t)("chat.singleChat.settings.alwaysMode")),3)])]),z.value==="idle"?(g(),u("div",xs,[e("div",Us,[e("div",Vs,o(l(t)("chat.singleChat.settings.idleTime")),1),e("div",Ts,o(l(t)("chat.singleChat.settings.idleTimeDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[17]||(s[17]=a=>te.value=a),class:"base-input base-input-short",placeholder:"15"},null,512),[[m,te.value,void 0,{number:!0}]])])):f("",!0)])):f("",!0)])]))]),_:1})]),e("div",As,[e("div",{class:"card-title",onClick:s[18]||(s[18]=a=>T("modeSettings"))},[e("span",null,o(l(t)("chat.singleChat.settings.mode")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.modeSettings}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.modeSettings?f("",!0):(g(),u("div",Ms,[e("div",Ds,[e("div",zs,[e("div",Rs,o(l(t)("chat.singleChat.settings.modeSelect")),1),e("div",$s,[e("div",{class:_(["mode-option",{active:R.value}]),onClick:s[19]||(s[19]=a=>ye(!0))},o(l(t)("chat.singleChat.settings.online")),3),e("div",{class:_(["mode-option",{active:!R.value}]),onClick:s[20]||(s[20]=a=>ye(!1))},o(l(t)("chat.singleChat.settings.offline")),3)])]),R.value?f("",!0):(g(),u("div",Ns,[e("div",Os,o(l(t)("chat.singleChat.settings.linkPreset")),1),v(Be,{modelValue:se.value,"onUpdate:modelValue":s[21]||(s[21]=a=>se.value=a),options:l(Ae),labelKey:"title",valueKey:"id",childrenKey:"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])])),e("div",Ls,[e("div",Ws,o(l(t)("chat.singleChat.settings.linkWorldbook")),1),v(Be,{modelValue:ae.value,"onUpdate:modelValue":s[22]||(s[22]=a=>ae.value=a),options:l(Ve),"label-key":"title","value-key":"id","children-key":"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])]),e("div",js,[e("div",Fs,[e("div",qs,o(l(t)("chat.singleChat.settings.replyLength")),1),e("div",Es,o(l(t)("chat.singleChat.settings.replyLengthDesc")),1)]),e("div",Hs,[p(e("input",{type:"number","onUpdate:modelValue":s[23]||(s[23]=a=>F.value=a),class:"base-input base-input-mini",placeholder:l(t)("chat.singleChat.settings.min")},null,8,Gs),[[m,F.value]]),s[44]||(s[44]=e("span",null,"-",-1)),p(e("input",{type:"number","onUpdate:modelValue":s[24]||(s[24]=a=>q.value=a),class:"base-input base-input-mini",placeholder:l(t)("chat.singleChat.settings.max")},null,8,Ks),[[m,q.value]])])])])]))]),_:1})]),e("div",Xs,[e("div",{class:"card-title",onClick:s[25]||(s[25]=a=>T("summarySettings"))},[e("span",null,o(l(t)("chat.singleChat.settings.summary")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.summarySettings}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.summarySettings?f("",!0):(g(),u("div",Js,[e("div",Qs,[e("div",Ys,[e("div",Zs,[e("div",ea,o(l(t)("chat.singleChat.settings.summaryRange")),1),e("div",ta,o(l(t)("chat.singleChat.settings.summaryRangeDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[26]||(s[26]=a=>le.value=a),class:"base-input base-input-short",placeholder:"20"},null,512),[[m,le.value,void 0,{number:!0}]])]),e("div",sa,[e("div",aa,o(l(t)("chat.singleChat.settings.summaryPrompt")),1),p(e("textarea",{"onUpdate:modelValue":s[27]||(s[27]=a=>ne.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(t)("chat.singleChat.settings.summaryPromptPlaceholder")},null,8,la),[[m,ne.value]])]),e("div",na,[e("div",oa,[e("div",ia,o(l(t)("chat.singleChat.settings.autoSummary")),1),e("div",ca,o(l(t)("chat.singleChat.settings.autoSummaryDesc")),1)]),e("div",{class:_(["toggle-switch",{active:E.value}]),onClick:s[28]||(s[28]=a=>E.value=!E.value)},null,2)]),e("div",da,[e("button",{class:"btn btn-secondary",onClick:Ye},o(l(t)("chat.singleChat.settings.manualSummary")),1),e("button",{class:"btn btn-secondary",onClick:Ne},o(l(t)("chat.singleChat.settings.viewSummary")),1)]),e("div",ra,[e("div",ua,[e("div",va,o(l(t)("chat.singleChat.settings.contextMemory")),1),e("div",ga,o(l(t)("chat.singleChat.settings.contextMemoryDesc")),1)]),p(e("input",{type:"number","onUpdate:modelValue":s[29]||(s[29]=a=>oe.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[m,oe.value,void 0,{number:!0}]])]),e("div",ha,[e("div",pa,o(l(t)("chat.singleChat.settings.apiConfig")),1),v(be,{options:De.value,modelValue:ve.value,"onUpdate:modelValue":s[30]||(s[30]=a=>ve.value=a)},null,8,["options","modelValue"])]),e("div",ma,[e("div",ba,o(l(t)("chat.singleChat.settings.tokenCount")),1),e("div",_a,o(ge.value),1)]),e("div",Ca,[e("div",fa,o(l(t)("chat.singleChat.settings.msgCount")),1),e("div",ya,o(ce.value),1)])])]))]),_:1})]),e("div",ka,[e("div",{class:"card-title",onClick:s[31]||(s[31]=a=>T("bubbleSettings"))},[e("span",null,o(l(t)("chat.singleChat.settings.beautification")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.bubbleSettings}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.bubbleSettings?f("",!0):(g(),u("div",wa,[e("div",Sa,[e("div",Pa,o(l(t)("chat.singleChat.settings.bubble")),1),e("div",Ia,[e("div",Ba,o(l(t)("chat.singleChat.settings.bubblePreset")),1),e("div",xa,[v(be,{options:ze.value,modelValue:B.value,"onUpdate:modelValue":s[32]||(s[32]=a=>B.value=a)},null,8,["options","modelValue"])]),e("div",Ua,[e("button",{class:"btn btn-secondary btn-mini",onClick:Ke},o(l(t)("save")),1),e("button",{class:"btn btn-danger btn-mini",disabled:!B.value,onClick:Xe},o(l(t)("delete")),9,Va)])]),e("div",Ta,[e("div",Aa,[e("div",Ma,[e("div",Da,[re.value?(g(),u("img",{key:0,src:re.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,za)):(g(),u("div",Ra))]),e("div",{class:"preview-bubble char",style:Ie(fe.value)},o(l(t)("chat.singleChat.settings.bubblePreview")),5)]),e("div",$a,[e("div",{class:"preview-bubble user",style:Ie(fe.value)},o(l(t)("chat.singleChat.settings.bubblePreview")),5),e("div",Na,[I.value?(g(),u("img",{key:0,src:I.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,Oa)):(g(),u("div",La))])])])]),e("div",Wa,[e("div",ja,[e("div",Fa,o(l(t)("chat.singleChat.settings.fontSize")),1)]),e("div",qa,[p(e("input",{type:"range","onUpdate:modelValue":s[33]||(s[33]=a=>U.value=a),min:"10",max:"30",step:"1"},null,512),[[m,U.value,void 0,{number:!0}]]),e("span",Ea,o(U.value),1)])]),e("div",Ha,[e("div",Ga,o(l(t)("chat.singleChat.settings.bubbleCss")),1),p(e("textarea",{"onUpdate:modelValue":s[34]||(s[34]=a=>x.value=a),class:"base-input",placeholder:l(t)("chat.singleChat.settings.cssPlaceholder"),style:{"font-family":"monospace",height:"120px"}},null,8,Ka),[[m,x.value]])]),s[45]||(s[45]=e("div",{class:"settings-divider"},null,-1)),e("div",Xa,o(l(t)("chat.singleChat.settings.chatBackground")),1),e("div",Ja,[e("div",Qa,[e("div",Ya,[e("button",{class:"btn btn-secondary",onClick:We},o(l(t)("chat.singleChat.settings.setChatBackground")),1),e("button",{class:"btn btn-secondary",onClick:Qe,style:{"margin-top":"5px"}},o(l(t)("chat.singleChat.settings.applyToAll")),1)])])])])]))]),_:1})]),e("div",Za,[e("div",{class:"card-title",onClick:s[35]||(s[35]=a=>T("videoSettings"))},[e("span",null,o(l(t)("chat.singleChat.settings.videoCall")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.videoSettings}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.videoSettings?f("",!0):(g(),u("div",el,[e("div",tl,[e("div",sl,[e("div",al,[e("div",ll,o(l(t)("chat.singleChat.settings.characterImage")),1),e("div",{class:"video-preview",onClick:je},[K.value?(g(),u("img",{key:0,src:K.value,class:"bg-img"},null,8,nl)):(g(),u("div",ol,o(l(t)("chat.singleChat.settings.setImage")),1))])]),e("div",il,[e("div",cl,o(l(t)("chat.singleChat.settings.userImage")),1),e("div",{class:"video-preview",onClick:Fe},[N.value?(g(),u("img",{key:0,src:N.value,class:"bg-img"},null,8,dl)):(g(),u("div",rl,o(l(t)("chat.singleChat.settings.setImage")),1))])])])])]))]),_:1})]),e("div",ul,[e("div",{class:"card-title",onClick:s[36]||(s[36]=a=>T("advancedSettings"))},[e("span",null,o(l(t)("chat.singleChat.settings.advanced")),1),e("div",{class:_(["collapse-arrow",{collapsed:h.value.advancedSettings}])},[v(A,{name:"chevron-down"})],2)]),v(M,{name:"collapse"},{default:C(()=>[h.value.advancedSettings?f("",!0):(g(),u("div",vl,[e("div",gl,[e("div",hl,[e("div",pl,o(l(t)("chat.singleChat.settings.linkedNpc")),1),e("div",ml,o(l(t)("chat.singleChat.settings.npcCount",{count:Ce.value})),1),s[46]||(s[46]=e("div",{class:"settings-pure-arrow"},"›",-1))])])]))]),_:1})]),e("div",bl,[e("button",{class:"btn btn-danger big-btn",onClick:ot},[e("div",_l,[e("div",Cl,o(W.value?l(t)("chat.singleChat.settings.unblock"):l(t)("chat.singleChat.settings.blockCharacter")),1),e("div",fl,o(l(t)("chat.singleChat.settings.blockCharacterDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:nt},[e("div",yl,[e("div",kl,o(l(t)("chat.singleChat.settings.clearHistory")),1),e("div",wl,o(l(t)("chat.singleChat.settings.clearHistoryDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:it},[e("div",Sl,[e("div",Pl,o(l(t)("chat.deleteCharacterTitle")),1),e("div",Il,o(l(t)("chat.deleteCharacterWarning")),1)])])])]),v(Ct,{visible:P.value,"onUpdate:visible":s[37]||(s[37]=a=>P.value=a),type:"basic","biz-type":"avatar",title:$e.value,onSendImage:Je},null,8,["visible","title"]),v(Pe,{visible:$.value,"onUpdate:visible":s[39]||(s[39]=a=>$.value=a),title:l(t)("chat.singleChat.settings.manualSummary")},{footer:C(()=>[e("button",{class:"modal-btn cancel",onClick:s[38]||(s[38]=a=>$.value=!1)},o(l(t)("cancel")),1)]),default:C(()=>[e("div",Bl,[e("div",{class:"modal-option",onClick:et},[e("span",xl,o(l(t)("chat.singleChat.settings.summarizeRecent")),1)]),e("div",{class:"modal-option",onClick:Ze},[e("span",Ul,o(l(t)("chat.singleChat.settings.summarizeRange")),1)]),e("div",{class:"modal-option",onClick:st},[e("span",Vl,o(l(t)("chat.singleChat.settings.summarizeVideo")),1)])])]),_:1},8,["visible","title"]),v(Pe,{visible:H.value,"onUpdate:visible":s[42]||(s[42]=a=>H.value=a),title:l(t)("chat.singleChat.settings.summarizeRange")},{footer:C(()=>[e("button",{class:"modal-btn cancel",onClick:s[41]||(s[41]=a=>H.value=!1)},o(l(t)("cancel")),1),e("button",{class:"modal-btn confirm",onClick:tt},o(l(t)("confirm")),1)]),default:C(()=>[p(e("input",{type:"text",class:"base-input","onUpdate:modelValue":s[40]||(s[40]=a=>ie.value=a),placeholder:l(t)("chat.singleChat.settings.rangePlaceholder",{total:ce.value})},null,8,Tl),[[m,ie.value]])]),_:1},8,["visible","title"])]))}},Rl=rt(Al,[["__scopeId","data-v-76141298"]]);export{Rl as default};
