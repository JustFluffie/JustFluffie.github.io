import{_ as wt,k as St,m as Pt,q as xt,U as It,V as Bt,O as Le,W as Ut,Q as Vt,X as Tt,r as i,c as P,t as $e,s as Dt,i as At,a as v,e,f as r,z as o,y as l,n as b,S as x,w as C,Y as k,I as Mt,M as Re,o as h,b as f,v as g,x as p,C as ze}from"./index-TjeMOTEi.js";import{C as Ie}from"./CustomSelect-Dy8tA3u3.js";import{M as Ne}from"./MultiSelect-Bp5mQlC_.js";const Lt={class:"chat-settings active"},$t={class:"app-header"},Rt={class:"title"},zt={class:"action-btn"},Nt={class:"app-content settings-content"},Ot={class:"card"},Wt={key:"roleInfo"},Et={class:"card-content"},jt={class:"role-header-layout"},Ft=["src"],qt={key:1,class:"role-avatar-placeholder"},Ht={class:"role-inputs-wrapper"},Gt=["placeholder"],Kt=["placeholder"],Qt={class:"form-item-vertical"},Xt={class:"label-main",style:{"margin-bottom":"5px"}},Yt=["placeholder"],Jt={class:"card"},Zt={key:"userInfo"},es={class:"card-content"},ts={class:"settings-pure-item",style:{"border-bottom":"none"}},ss={class:"settings-pure-label"},as={class:"user-header-layout"},ls=["src"],ns={key:1,class:"role-avatar-placeholder"},os={class:"user-inputs-wrapper"},is={class:"user-actions-row"},cs=["placeholder"],ds={class:"form-item-vertical"},rs={class:"label-main",style:{"margin-bottom":"5px"}},us=["placeholder"],vs={class:"card"},hs={class:"card-title-remark"},gs={key:"backgroundActivity"},ps={class:"card-content"},ms={class:"settings-item-input"},bs={class:"label-col"},_s={class:"label-main"},Cs={class:"settings-pure-value"},fs={class:"settings-item-input"},ys={class:"label-col"},ks={class:"label-main"},ws={class:"label-sub"},Ss={class:"mode-selector"},Ps={key:0},xs={class:"settings-item-input"},Is={class:"label-col"},Bs={class:"label-main"},Us={class:"label-sub"},Vs={class:"settings-item-input"},Ts={class:"label-col"},Ds={class:"label-main"},As={class:"label-sub"},Ms={class:"settings-item-input"},Ls={class:"label-col"},$s={class:"label-main"},Rs={class:"label-sub"},zs={class:"settings-item-input"},Ns={class:"label-col"},Os={class:"label-main"},Ws={class:"label-sub"},Es={class:"mode-selector"},js={key:0,class:"settings-item-input"},Fs={class:"label-col"},qs={class:"label-main"},Hs={class:"label-sub"},Gs={class:"card"},Ks={key:"modeSettings"},Qs={class:"card-content"},Xs={class:"settings-pure-item"},Ys={class:"settings-pure-label"},Js={class:"mode-selector"},Zs={key:0,class:"settings-pure-item"},ea={class:"settings-pure-label"},ta={class:"settings-pure-item"},sa={class:"settings-pure-label"},aa={class:"settings-item-input"},la={class:"label-col"},na={class:"label-main"},oa={class:"label-sub"},ia={class:"reply-length-container"},ca=["placeholder"],da=["placeholder"],ra={class:"card"},ua={key:"realtimeSense"},va={class:"card-content"},ha={class:"settings-item-input"},ga={class:"settings-item-input"},pa={key:0},ma={class:"form-item-vertical"},ba={class:"location-input-group"},_a={class:"location-display"},Ca={class:"form-item-vertical"},fa={class:"location-input-group"},ya={class:"location-display"},ka={class:"card"},wa={key:"summarySettings"},Sa={class:"card-content"},Pa={class:"settings-item-input"},xa={class:"label-col"},Ia={class:"label-main"},Ba={class:"label-sub"},Ua={class:"form-item-vertical"},Va={class:"label-main",style:{"margin-bottom":"5px"}},Ta=["placeholder"],Da={class:"settings-item-input"},Aa={class:"label-col"},Ma={class:"label-main"},La={class:"label-sub"},$a={class:"settings-btn-row flex-distribute-children",style:{padding:"15px 0","border-bottom":"1px solid #f5f5f5"}},Ra={class:"settings-item-input"},za={class:"label-col"},Na={class:"label-main"},Oa={class:"label-sub"},Wa={class:"settings-pure-item"},Ea={class:"settings-pure-label"},ja={class:"settings-pure-item"},Fa={class:"settings-pure-label"},qa={class:"settings-pure-value"},Ha={class:"settings-pure-item"},Ga={class:"settings-pure-label"},Ka={class:"settings-pure-value"},Qa={class:"card"},Xa={key:"bubbleSettings"},Ya={class:"card-content"},Ja={class:"settings-section-title"},Za={class:"settings-row-group"},el={class:"settings-pure-label",style:{width:"60px"}},tl={style:{flex:"1",margin:"0 10px"}},sl={class:"btn-group-mini"},al=["disabled"],ll={class:"bubble-preview-container"},nl={class:"bubble-preview-area"},ol={class:"preview-msg-row left"},il={class:"preview-avatar char"},cl=["src"],dl={key:1,class:"default-avatar"},rl={class:"preview-msg-row right"},ul={class:"preview-avatar user"},vl=["src"],hl={key:1,class:"default-avatar"},gl={class:"settings-item-input"},pl={class:"label-col"},ml={class:"label-main"},bl={class:"slider-container gray-slider"},_l={class:"slider-value"},Cl={class:"form-item-vertical no-border"},fl={class:"label-main",style:{"margin-bottom":"5px"}},yl=["placeholder"],kl={class:"settings-section-title"},wl={class:"settings-item-avatar",style:{"border-bottom":"none","margin-bottom":"0"}},Sl={class:"avatar-layout"},Pl={class:"avatar-controls",style:{width:"100%"}},xl={class:"card"},Il={key:"videoSettings"},Bl={class:"card-content"},Ul={class:"video-settings-container"},Vl={class:"video-setting-col"},Tl={class:"settings-item-label center"},Dl=["src"],Al={key:1,class:"default-avatar bg-placeholder"},Ml={class:"video-setting-col"},Ll={class:"settings-item-label center"},$l=["src"],Rl={key:1,class:"default-avatar bg-placeholder"},zl={class:"card"},Nl={key:"advancedSettings"},Ol={class:"card-content"},Wl={class:"settings-pure-item"},El={class:"settings-pure-label"},jl={class:"settings-pure-value"},Fl={class:"danger-zone"},ql={class:"danger-btn-content"},Hl={class:"danger-btn-title"},Gl={class:"danger-btn-desc"},Kl={class:"danger-btn-content"},Ql={class:"danger-btn-title"},Xl={class:"danger-btn-desc"},Yl={class:"danger-btn-content"},Jl={class:"danger-btn-title"},Zl={class:"danger-btn-desc"},en={class:"modal-options centered-text"},tn={class:"option-text"},sn={class:"option-text"},an={class:"option-text"},ln=["placeholder"],nn={__name:"SingleChatSettings",props:{id:{type:String,required:!0}},setup(Oe){const I=Oe,{t:s}=St(),Ce=At(),d=Pt(),u=xt(),Be=It(),We=Bt(),{sortedWorldBooks:Ee}=Le(We),je=Ut(),{sortedPresets:Fe}=Le(je);Vt();const{fetchLocationWeather:qe}=Tt(),m=i({roleInfo:!1,userInfo:!1,backgroundActivity:!1,modeSettings:!1,realtimeSense:!1,summarySettings:!1,bubbleSettings:!1,videoSettings:!1,advancedSettings:!1}),B=i(!1),$=i(""),ae=i(""),le=i(""),ne=i(""),_=i("default"),E=i(""),q=i(""),U=i(""),y=i("default"),oe=i(5),ie=i(30),ce=i(10),R=i("always"),de=i(15),z=i(!0),re=i([]),ue=i([]),H=i(""),G=i(""),K=i(!1),j=i(!1),Q=i(""),X=i(""),fe=i(""),Y=i(""),J=i(""),ye=i(""),V=i({}),T=i({}),ve=i(20),he=i(""),Z=i(!1),ge=i(10),N=i(!1),ee=i(!1),pe=i(""),D=i(""),A=i(""),M=i(14),te=i(""),se=i(""),O=i(""),ke=i("default"),Ue=i(0),F=i(!1),we=i(0),me=i(0),L=P(()=>d.getCharacter(I.id)),be=P(()=>{var n;return((n=L.value)==null?void 0:n.name)||s("chat.unknownCharacter")}),_e=P(()=>{var n;return(n=L.value)==null?void 0:n.avatar}),He=P(()=>[{value:"default",label:s("chat.singleChat.settings.defaultUserPersona")},...(d.userPersonas||[]).map(n=>({value:n.id,label:n.name}))]),Ge=P(()=>[{value:"default",label:s("chat.singleChat.settings.default")+"配置"},{value:"api1",label:"配置一"},{value:"api2",label:"配置二"}]),Ke=P(()=>[{value:"",label:s("chat.singleChat.settings.custom")},...(d.bubblePresets||[]).map(n=>({value:n.id,label:n.name}))]),Qe=P(()=>y.value==="on"?!0:y.value==="off"?!1:Be.globalBackgroundActivity),Ve=P(()=>{const n={fontSize:`${M.value}px`};if(!A.value)return n;const t={};return A.value.split(";").forEach(a=>{const c=a.split(":");if(c.length>=2){const S=c[0].trim(),W=c.slice(1).join(":").trim();S&&W&&(t[S]=W)}}),{...n,...t}}),Xe=P(()=>({avatar:s("chat.singleChat.settings.toast.setCharAvatar"),userPersonaAvatar:s("chat.singleChat.settings.toast.setUserAvatar"),chatBg:s("chat.singleChat.settings.toast.setChatBg"),videoBg:s("chat.singleChat.settings.toast.setCharImg"),userVideoImg:s("chat.singleChat.settings.toast.setUserImg")})[$.value]||s("chat.singleChat.settings.toast.upload"));$e(_,n=>{n&&xe(n)}),$e(D,n=>{n&&ot(n)}),Dt(()=>{if(!L.value){Se();return}at()});const w=n=>{m.value[n]=!m.value[n]},Se=()=>{Ce.back()},Ye=()=>{Ce.push({name:"memory-bank",params:{charId:I.id}})},Je=()=>{$.value="avatar",B.value=!0},Ze=()=>{$.value="userPersonaAvatar",B.value=!0},et=()=>{$.value="chatBg",B.value=!0},tt=()=>{$.value="videoBg",B.value=!0},st=()=>{$.value="userVideoImg",B.value=!0},at=()=>{var Ae;const n=L.value;ae.value=n.name,le.value=n.nickname||"",ne.value=n.charPersona||"",_.value=n.userPersona||"default",xe(_.value),y.value=n.backgroundActivityOverride||"default",oe.value=n.proactiveInterval||5,ie.value=n.proactiveCooldown||30,ce.value=n.proactiveDailyLimit||10,R.value=n.triggerMode||"always",de.value=n.proactiveIdleTime||15,z.value=n.isOnline!==!1,re.value=Array.isArray(n.preset)?n.preset:n.preset?[n.preset]:[],ue.value=n.worldbook||[];const[t,a]=(n.replyLength||(z.value?"10-50":"200-500")).split("-");H.value=t||"",G.value=a||"";const c=n.realtimeSettings||{timeEnabled:!1,weatherEnabled:!1,charLocation:{},userLocation:{}};K.value=c.timeEnabled,j.value=c.weatherEnabled,V.value=c.charLocation||{},T.value=c.userLocation||{},Q.value=V.value.real||"",X.value=V.value.virtual||"",fe.value=V.value.shortDisplay||"",Y.value=T.value.real||"",J.value=T.value.virtual||"",ye.value=T.value.shortDisplay||"",ve.value=n.summaryRange||20,he.value=n.summaryPrompt||"",Z.value=n.autoSummary||!1,ge.value=n.memoryCount||10;const S=n.bubbleSettings||{};A.value=S.css||"",M.value=S.fontSize||14,te.value=n.chatBackground||"",se.value=n.videoBg||"",O.value=n.userVideoImg||"",ke.value=n.api||"default",Ue.value=((Ae=n.npc)==null?void 0:Ae.length)||0,F.value=n.isBlocked||!1;const W=d.messages[I.id]||[];me.value=W.length,we.value=Math.ceil(W.reduce((yt,kt)=>{var Me;return yt+(((Me=kt.content)==null?void 0:Me.length)||0)},0)*1.5)},Pe=()=>{const n=L.value;if(!n)return;const t=_.value;let a=d.userPersonas.find(c=>c.id===t);t==="default"&&(a||(a={id:"default",name:s("chat.singleChat.settings.defaultUserPersona"),avatar:"",description:"",videoImg:""},d.userPersonas.unshift(a))),a&&(a.id!=="default"&&E.value.trim()&&(a.name=E.value.trim()),a.description=q.value,a.avatar=U.value,a.videoImg=O.value),V.value.real=Q.value,V.value.virtual=X.value,T.value.real=Y.value,T.value.virtual=J.value,Object.assign(n,{name:ae.value.trim()||n.name,nickname:le.value.trim(),charPersona:ne.value,userPersona:_.value,backgroundActivityOverride:y.value,proactiveInterval:oe.value,proactiveCooldown:ie.value,proactiveDailyLimit:ce.value,triggerMode:R.value,proactiveIdleTime:de.value,isOnline:z.value,preset:re.value,worldbook:ue.value,replyLength:`${H.value}-${G.value}`,realtimeSettings:{timeEnabled:K.value,weatherEnabled:j.value,charLocation:V.value,userLocation:T.value},summaryRange:ve.value,summaryPrompt:he.value,autoSummary:Z.value,memoryCount:ge.value,bubbleSettings:{css:A.value,fontSize:M.value},chatBackground:te.value,videoBg:se.value,isBlocked:F.value}),d.saveData(),u.showToast(s("theme.toast.saveSuccess"))},xe=n=>{const t=s("chat.singleChat.settings.defaultUserPersona");let a=d.userPersonas.find(c=>c.id===n)||{name:t,avatar:"",description:"",videoImg:""};E.value=a.name===t?"":a.name,q.value=a.description||"",U.value=a.avatar||"",n!=="default"&&(O.value=a.videoImg||"")},lt=()=>{const n=E.value.trim();if(!n)return u.showToast(s("chat.singleChat.settings.toast.personaNameRequired"),"error");const t={id:_.value==="default"?Date.now().toString():_.value,name:n,description:q.value,avatar:U.value,videoImg:O.value};if(_.value==="default")d.userPersonas.push(t),_.value=t.id,u.showToast(s("chat.singleChat.settings.toast.personaSaved"));else{const a=d.userPersonas.findIndex(c=>c.id===_.value);a!==-1&&(d.userPersonas[a]=t,u.showToast(s("chat.singleChat.settings.toast.personaUpdated")))}d.saveData()},nt=()=>{if(_.value==="default")return u.showToast(s("chat.singleChat.settings.toast.defaultPersonaDelete"),"error");u.showConfirm(s("chat.singleChat.settings.toast.deletePersona"),s("chat.singleChat.settings.toast.confirmDeletePersona"),()=>{d.userPersonas=d.userPersonas.filter(n=>n.id!==_.value),d.characters.forEach(n=>{n.userPersona===_.value&&(n.userPersona="default")}),_.value="default",xe("default"),d.saveData()})},ot=n=>{if(!n)return;const t=d.bubblePresets.find(a=>a.id===n);t&&(A.value=t.css,M.value=t.fontSize)},it=()=>{const n=prompt(s("chat.singleChat.settings.toast.presetNameRequired"));if(!n)return;const t={id:Date.now().toString(),name:n,css:A.value,fontSize:M.value};d.bubblePresets.push(t),d.saveData(),D.value=t.id,u.showToast(s("chat.singleChat.settings.toast.presetSaved"))},ct=()=>{D.value&&u.showConfirm(s("chat.singleChat.settings.toast.deleteBubblePreset"),s("chat.singleChat.settings.toast.confirmDeleteBubblePreset"),()=>{d.bubblePresets=d.bubblePresets.filter(n=>n.id!==D.value),d.saveData(),D.value="",u.showToast(s("chat.singleChat.settings.toast.presetDeleted"))})},dt=n=>{const t=typeof n=="string"?n:n.content,a=$.value;if(a==="avatar"||a==="chatBg"||a==="videoBg"){const c={avatar:{obj:L.value,key:"avatar",toast:s("chat.singleChat.settings.toast.avatarUpdated")},chatBg:{obj:L.value,key:"chatBackground",toast:s("chat.singleChat.settings.toast.backgroundUpdated"),localRef:te},videoBg:{obj:L.value,key:"videoBg",toast:s("chat.singleChat.settings.toast.charImageUpdated"),localRef:se}};c[a]&&(c[a].obj[c[a].key]=t,c[a].localRef&&(c[a].localRef.value=t),d.saveData(),u.showToast(c[a].toast))}else(a==="userPersonaAvatar"||a==="userVideoImg")&&(a==="userPersonaAvatar"&&(U.value=t),a==="userVideoImg"&&(O.value=t),u.showToast(s("chat.singleChat.settings.toast.avatarUpdated")));B.value=!1},rt=()=>{if(!te.value)return u.showToast(s("chat.singleChat.settings.toast.noBgToApply"));u.showConfirm(s("chat.singleChat.settings.toast.applyBgToAll"),s("chat.singleChat.settings.toast.confirmApplyBgToAll"),()=>{d.applyChatBackgroundToAll(te.value),u.showToast(s("chat.singleChat.settings.toast.appliedToAll"))})},Te=n=>{z.value=n,[H.value,G.value]=n?["10","50"]:["200","500"]},ut=()=>{N.value=!0},vt=()=>{N.value=!1,ee.value=!0},ht=async()=>{N.value=!1;const n=await d.summarizeMessages(I.id,{type:"recent"});u.showToast(n.message,n.success?"success":"error")},gt=async()=>{const[n,t]=pe.value.split("-").map(W=>W.trim()),a=parseInt(n,10),c=parseInt(t,10);if(isNaN(a)||isNaN(c)||a<=0||c<=0||a>c){u.showToast(s("chat.singleChat.settings.toast.invalidRange"),"error");return}const S=await d.summarizeMessages(I.id,{type:"range",start:a,end:c});u.showToast(S.message,S.success?"success":"error"),S.success&&(ee.value=!1,pe.value="")},pt=async()=>{N.value=!1;const n=await d.summarizeMessages(I.id,{type:"video"});u.showToast(n.message,n.success?"success":"error")},De=async n=>{const t=n==="char"?Q.value:Y.value,a=n==="char"?X.value:J.value,c=await qe(t,a);c&&(n==="char"?(V.value=c,fe.value=c.shortDisplay):(T.value=c,ye.value=c.shortDisplay),u.showToast("位置和天气信息已更新","success"))},mt=()=>{u.showConfirm(s("chat.singleChat.settings.confirmBlockTitle",{name:be.value}),s("chat.singleChat.settings.confirmBlockMsg",{name:be.value}),()=>{F.value=!0,Pe(),u.showToast(s("chat.singleChat.settings.toast.blocked"))},{messageStyle:{color:"#FF3B30",whiteSpace:"pre-wrap"},confirmText:"chat.singleChat.settings.block"})},bt=()=>{F.value=!1,Pe(),u.showToast(s("chat.singleChat.settings.toast.unblocked"))},_t=()=>{u.showConfirm(s("chat.singleChat.settings.confirmClearTitle"),s("chat.singleChat.settings.confirmClearMsg",{name:be.value}),()=>{d.clearChatHistory(I.id),u.showToast(s("chat.singleChat.settings.toast.historyCleared")),me.value=0,we.value=0},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"chat.singleChat.settings.clear"})},Ct=()=>{F.value?bt():mt()},ft=()=>{u.showConfirm(s("chat.deleteCharacterTitle"),s("chat.deleteCharacterConfirm",{name:be.value}),()=>{d.deleteCharacter(I.id),u.showToast(s("chat.toast.deleteSuccess"),"success"),Se(),Ce.push({name:"chat-list"})},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"delete"})};return(n,t)=>(h(),v("div",Lt,[e("div",$t,[e("div",{class:"back-btn",onClick:Se},[...t[52]||(t[52]=[e("svg",{class:"svg-icon",viewBox:"0 0 24 24"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])]),e("div",Rt,o(l(s)("chat.singleChat.settings.title")),1),e("div",zt,[e("button",{class:"header-save-btn",onClick:Pe},o(l(s)("save")),1)])]),e("div",Nt,[e("div",Ot,[e("div",{class:"card-title",onClick:t[0]||(t[0]=a=>w("roleInfo"))},[e("span",null,o(l(s)("chat.singleChat.settings.roleInfo")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.roleInfo}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.roleInfo?f("",!0):(h(),v("div",Wt,[e("div",Et,[e("div",jt,[e("div",{class:"role-avatar-wrapper",onClick:Je},[_e.value?(h(),v("img",{key:0,src:_e.value,alt:"头像",class:"role-avatar-img"},null,8,Ft)):(h(),v("div",qt,o(l(s)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",Ht,[g(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>ae.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.roleNamePlaceholder")},null,8,Gt),[[p,ae.value]]),g(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>le.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.roleNicknamePlaceholder")},null,8,Kt),[[p,le.value]])])]),e("div",Qt,[e("div",Xt,o(l(s)("chat.singleChat.settings.rolePersona")),1),g(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>ne.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.rolePersonaPlaceholder")},null,8,Yt),[[p,ne.value]])])])]))]),_:1})]),e("div",Jt,[e("div",{class:"card-title",onClick:t[4]||(t[4]=a=>w("userInfo"))},[e("span",null,o(l(s)("chat.singleChat.settings.userInfo")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.userInfo}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.userInfo?f("",!0):(h(),v("div",Zt,[e("div",es,[e("div",ts,[e("div",ss,o(l(s)("chat.singleChat.settings.currentUserPersona")),1),r(Ie,{options:He.value,modelValue:_.value,"onUpdate:modelValue":t[5]||(t[5]=a=>_.value=a)},null,8,["options","modelValue"])]),e("div",as,[e("div",{class:"user-avatar-wrapper",onClick:Ze},[U.value?(h(),v("img",{key:0,src:U.value,alt:"User",class:"role-avatar-img"},null,8,ls)):(h(),v("div",ns,o(l(s)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",os,[e("div",is,[e("button",{class:"btn btn-secondary btn-mini-grow",onClick:lt},o(l(s)("chat.singleChat.settings.savePersona")),1),e("button",{class:"btn btn-danger btn-mini-grow",onClick:nt},o(l(s)("chat.singleChat.settings.deletePersona")),1)]),g(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>E.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.userNamePlaceholder")},null,8,cs),[[p,E.value]])])]),e("div",ds,[e("div",rs,o(l(s)("chat.singleChat.settings.userPersona")),1),g(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>q.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.userPersonaPlaceholder")},null,8,us),[[p,q.value]])])])]))]),_:1})]),e("div",vs,[e("div",{class:"card-title",onClick:t[8]||(t[8]=a=>w("backgroundActivity"))},[e("span",null,o(l(s)("chat.singleChat.settings.backgroundActivity")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.backgroundActivity}])},[r(x,{name:"chevron-down"})],2)]),e("div",hs,o(l(s)("chat.singleChat.settings.backgroundActivityWarning")),1),r(k,{name:"collapse"},{default:C(()=>[m.value.backgroundActivity?f("",!0):(h(),v("div",gs,[e("div",ps,[e("div",ms,[e("div",bs,[e("div",_s,o(l(s)("chat.singleChat.settings.globalSettings")),1)]),e("div",Cs,o(l(Be).globalBackgroundActivity?l(s)("chat.singleChat.settings.globalOn"):l(s)("chat.singleChat.settings.globalOff")),1)]),e("div",fs,[e("div",ys,[e("div",ks,o(l(s)("chat.singleChat.settings.overrideGlobal")),1),e("div",ws,o(l(s)("chat.singleChat.settings.overrideGlobalDesc")),1)]),e("div",Ss,[e("div",{class:b(["mode-option",{active:y.value==="default"}]),onClick:t[9]||(t[9]=a=>y.value="default")},o(l(s)("chat.singleChat.settings.default")),3),e("div",{class:b(["mode-option",{active:y.value==="on"}]),onClick:t[10]||(t[10]=a=>y.value="on")},o(l(s)("chat.singleChat.settings.on")),3),e("div",{class:b(["mode-option",{active:y.value==="off"}]),onClick:t[11]||(t[11]=a=>y.value="off")},o(l(s)("chat.singleChat.settings.off")),3)])]),Qe.value?(h(),v("div",Ps,[e("div",xs,[e("div",Is,[e("div",Bs,o(l(s)("chat.singleChat.settings.interval")),1),e("div",Us,o(l(s)("chat.singleChat.settings.intervalDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=a=>oe.value=a),class:"base-input base-input-short",placeholder:"5"},null,512),[[p,oe.value,void 0,{number:!0}]])]),e("div",Vs,[e("div",Ts,[e("div",Ds,o(l(s)("chat.singleChat.settings.cooldown")),1),e("div",As,o(l(s)("chat.singleChat.settings.cooldownDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=a=>ie.value=a),class:"base-input base-input-short",placeholder:"30"},null,512),[[p,ie.value,void 0,{number:!0}]])]),e("div",Ms,[e("div",Ls,[e("div",$s,o(l(s)("chat.singleChat.settings.dailyLimit")),1),e("div",Rs,o(l(s)("chat.singleChat.settings.dailyLimitDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=a=>ce.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[p,ce.value,void 0,{number:!0}]])]),e("div",zs,[e("div",Ns,[e("div",Os,o(l(s)("chat.singleChat.settings.triggerMode")),1),e("div",Ws,o(l(s)("chat.singleChat.settings.triggerModeDesc")),1)]),e("div",Es,[e("div",{class:b(["mode-option",{active:R.value==="idle"}]),onClick:t[15]||(t[15]=a=>R.value="idle")},o(l(s)("chat.singleChat.settings.idleMode")),3),e("div",{class:b(["mode-option",{active:R.value==="always"}]),onClick:t[16]||(t[16]=a=>R.value="always")},o(l(s)("chat.singleChat.settings.alwaysMode")),3)])]),R.value==="idle"?(h(),v("div",js,[e("div",Fs,[e("div",qs,o(l(s)("chat.singleChat.settings.idleTime")),1),e("div",Hs,o(l(s)("chat.singleChat.settings.idleTimeDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[17]||(t[17]=a=>de.value=a),class:"base-input base-input-short",placeholder:"15"},null,512),[[p,de.value,void 0,{number:!0}]])])):f("",!0)])):f("",!0)])]))]),_:1})]),e("div",Gs,[e("div",{class:"card-title",onClick:t[18]||(t[18]=a=>w("modeSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.mode")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.modeSettings}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.modeSettings?f("",!0):(h(),v("div",Ks,[e("div",Qs,[e("div",Xs,[e("div",Ys,o(l(s)("chat.singleChat.settings.modeSelect")),1),e("div",Js,[e("div",{class:b(["mode-option",{active:z.value}]),onClick:t[19]||(t[19]=a=>Te(!0))},o(l(s)("chat.singleChat.settings.online")),3),e("div",{class:b(["mode-option",{active:!z.value}]),onClick:t[20]||(t[20]=a=>Te(!1))},o(l(s)("chat.singleChat.settings.offline")),3)])]),z.value?f("",!0):(h(),v("div",Zs,[e("div",ea,o(l(s)("chat.singleChat.settings.linkPreset")),1),r(Ne,{modelValue:re.value,"onUpdate:modelValue":t[21]||(t[21]=a=>re.value=a),options:l(Fe),labelKey:"title",valueKey:"id",childrenKey:"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])])),e("div",ta,[e("div",sa,o(l(s)("chat.singleChat.settings.linkWorldbook")),1),r(Ne,{modelValue:ue.value,"onUpdate:modelValue":t[22]||(t[22]=a=>ue.value=a),options:l(Ee),"label-key":"title","value-key":"id","children-key":"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])]),e("div",aa,[e("div",la,[e("div",na,o(l(s)("chat.singleChat.settings.replyLength")),1),e("div",oa,o(l(s)("chat.singleChat.settings.replyLengthDesc")),1)]),e("div",ia,[g(e("input",{type:"number","onUpdate:modelValue":t[23]||(t[23]=a=>H.value=a),class:"base-input base-input-mini",placeholder:l(s)("chat.singleChat.settings.min")},null,8,ca),[[p,H.value]]),t[53]||(t[53]=e("span",null,"-",-1)),g(e("input",{type:"number","onUpdate:modelValue":t[24]||(t[24]=a=>G.value=a),class:"base-input base-input-mini",placeholder:l(s)("chat.singleChat.settings.max")},null,8,da),[[p,G.value]])])])])]))]),_:1})]),e("div",ra,[e("div",{class:"card-title",onClick:t[25]||(t[25]=a=>w("realtimeSense"))},[t[54]||(t[54]=e("span",null,"实时感知",-1)),e("div",{class:b(["collapse-arrow",{collapsed:m.value.realtimeSense}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.realtimeSense?f("",!0):(h(),v("div",ua,[e("div",va,[e("div",ha,[t[55]||(t[55]=e("div",{class:"label-col"},[e("div",{class:"label-main"},"实时时间")],-1)),e("div",{class:b(["toggle-switch",{active:K.value}]),onClick:t[26]||(t[26]=a=>K.value=!K.value)},null,2)]),e("div",ga,[t[56]||(t[56]=e("div",{class:"label-col"},[e("div",{class:"label-main"},"实时天气")],-1)),e("div",{class:b(["toggle-switch",{active:j.value}]),onClick:t[27]||(t[27]=a=>j.value=!j.value)},null,2)]),r(k,{name:"collapse"},{default:C(()=>[j.value?(h(),v("div",pa,[e("div",ma,[t[57]||(t[57]=e("div",{class:"label-main",style:{"margin-bottom":"5px"}},"角色所在地",-1)),e("div",ba,[g(e("input",{type:"text","onUpdate:modelValue":t[28]||(t[28]=a=>Q.value=a),class:"base-input",placeholder:"真实地名"},null,512),[[p,Q.value]]),g(e("input",{type:"text","onUpdate:modelValue":t[29]||(t[29]=a=>X.value=a),class:"base-input",placeholder:"虚拟地名 (可选)"},null,512),[[p,X.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:t[30]||(t[30]=a=>De("char"))},"确定")]),e("div",_a,o(fe.value),1)]),e("div",Ca,[t[58]||(t[58]=e("div",{class:"label-main",style:{"margin-bottom":"5px"}},"用户所在地",-1)),e("div",fa,[g(e("input",{type:"text","onUpdate:modelValue":t[31]||(t[31]=a=>Y.value=a),class:"base-input",placeholder:"真实地名"},null,512),[[p,Y.value]]),g(e("input",{type:"text","onUpdate:modelValue":t[32]||(t[32]=a=>J.value=a),class:"base-input",placeholder:"虚拟地名 (可选)"},null,512),[[p,J.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:t[33]||(t[33]=a=>De("user"))},"确定")]),e("div",ya,o(ye.value),1)])])):f("",!0)]),_:1})])]))]),_:1})]),e("div",ka,[e("div",{class:"card-title",onClick:t[34]||(t[34]=a=>w("summarySettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.summary")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.summarySettings}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.summarySettings?f("",!0):(h(),v("div",wa,[e("div",Sa,[e("div",Pa,[e("div",xa,[e("div",Ia,o(l(s)("chat.singleChat.settings.summaryRange")),1),e("div",Ba,o(l(s)("chat.singleChat.settings.summaryRangeDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[35]||(t[35]=a=>ve.value=a),class:"base-input base-input-short",placeholder:"20"},null,512),[[p,ve.value,void 0,{number:!0}]])]),e("div",Ua,[e("div",Va,o(l(s)("chat.singleChat.settings.summaryPrompt")),1),g(e("textarea",{"onUpdate:modelValue":t[36]||(t[36]=a=>he.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.summaryPromptPlaceholder")},null,8,Ta),[[p,he.value]])]),e("div",Da,[e("div",Aa,[e("div",Ma,o(l(s)("chat.singleChat.settings.autoSummary")),1),e("div",La,o(l(s)("chat.singleChat.settings.autoSummaryDesc")),1)]),e("div",{class:b(["toggle-switch",{active:Z.value}]),onClick:t[37]||(t[37]=a=>Z.value=!Z.value)},null,2)]),e("div",$a,[e("button",{class:"btn btn-secondary",onClick:ut},o(l(s)("chat.singleChat.settings.manualSummary")),1),e("button",{class:"btn btn-secondary",onClick:Ye},o(l(s)("chat.singleChat.settings.viewSummary")),1)]),e("div",Ra,[e("div",za,[e("div",Na,o(l(s)("chat.singleChat.settings.contextMemory")),1),e("div",Oa,o(l(s)("chat.singleChat.settings.contextMemoryDesc")),1)]),g(e("input",{type:"number","onUpdate:modelValue":t[38]||(t[38]=a=>ge.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[p,ge.value,void 0,{number:!0}]])]),e("div",Wa,[e("div",Ea,o(l(s)("chat.singleChat.settings.apiConfig")),1),r(Ie,{options:Ge.value,modelValue:ke.value,"onUpdate:modelValue":t[39]||(t[39]=a=>ke.value=a)},null,8,["options","modelValue"])]),e("div",ja,[e("div",Fa,o(l(s)("chat.singleChat.settings.tokenCount")),1),e("div",qa,o(we.value),1)]),e("div",Ha,[e("div",Ga,o(l(s)("chat.singleChat.settings.msgCount")),1),e("div",Ka,o(me.value),1)])])]))]),_:1})]),e("div",Qa,[e("div",{class:"card-title",onClick:t[40]||(t[40]=a=>w("bubbleSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.beautification")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.bubbleSettings}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.bubbleSettings?f("",!0):(h(),v("div",Xa,[e("div",Ya,[e("div",Ja,o(l(s)("chat.singleChat.settings.bubble")),1),e("div",Za,[e("div",el,o(l(s)("chat.singleChat.settings.bubblePreset")),1),e("div",tl,[r(Ie,{options:Ke.value,modelValue:D.value,"onUpdate:modelValue":t[41]||(t[41]=a=>D.value=a)},null,8,["options","modelValue"])]),e("div",sl,[e("button",{class:"btn btn-secondary btn-mini",onClick:it},o(l(s)("save")),1),e("button",{class:"btn btn-danger btn-mini",disabled:!D.value,onClick:ct},o(l(s)("delete")),9,al)])]),e("div",ll,[e("div",nl,[e("div",ol,[e("div",il,[_e.value?(h(),v("img",{key:0,src:_e.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,cl)):(h(),v("div",dl))]),e("div",{class:"preview-bubble char",style:ze(Ve.value)},o(l(s)("chat.singleChat.settings.bubblePreview")),5)]),e("div",rl,[e("div",{class:"preview-bubble user",style:ze(Ve.value)},o(l(s)("chat.singleChat.settings.bubblePreview")),5),e("div",ul,[U.value?(h(),v("img",{key:0,src:U.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,vl)):(h(),v("div",hl))])])])]),e("div",gl,[e("div",pl,[e("div",ml,o(l(s)("chat.singleChat.settings.fontSize")),1)]),e("div",bl,[g(e("input",{type:"range","onUpdate:modelValue":t[42]||(t[42]=a=>M.value=a),min:"10",max:"30",step:"1"},null,512),[[p,M.value,void 0,{number:!0}]]),e("span",_l,o(M.value),1)])]),e("div",Cl,[e("div",fl,o(l(s)("chat.singleChat.settings.bubbleCss")),1),g(e("textarea",{"onUpdate:modelValue":t[43]||(t[43]=a=>A.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.cssPlaceholder"),style:{"font-family":"monospace",height:"120px"}},null,8,yl),[[p,A.value]])]),t[59]||(t[59]=e("div",{class:"settings-divider"},null,-1)),e("div",kl,o(l(s)("chat.singleChat.settings.chatBackground")),1),e("div",wl,[e("div",Sl,[e("div",Pl,[e("button",{class:"btn btn-secondary",onClick:et},o(l(s)("chat.singleChat.settings.setChatBackground")),1),e("button",{class:"btn btn-secondary",onClick:rt,style:{"margin-top":"5px"}},o(l(s)("chat.singleChat.settings.applyToAll")),1)])])])])]))]),_:1})]),e("div",xl,[e("div",{class:"card-title",onClick:t[44]||(t[44]=a=>w("videoSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.videoCall")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.videoSettings}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.videoSettings?f("",!0):(h(),v("div",Il,[e("div",Bl,[e("div",Ul,[e("div",Vl,[e("div",Tl,o(l(s)("chat.singleChat.settings.characterImage")),1),e("div",{class:"video-preview",onClick:tt},[se.value?(h(),v("img",{key:0,src:se.value,class:"bg-img"},null,8,Dl)):(h(),v("div",Al,o(l(s)("chat.singleChat.settings.setImage")),1))])]),e("div",Ml,[e("div",Ll,o(l(s)("chat.singleChat.settings.userImage")),1),e("div",{class:"video-preview",onClick:st},[O.value?(h(),v("img",{key:0,src:O.value,class:"bg-img"},null,8,$l)):(h(),v("div",Rl,o(l(s)("chat.singleChat.settings.setImage")),1))])])])])]))]),_:1})]),e("div",zl,[e("div",{class:"card-title",onClick:t[45]||(t[45]=a=>w("advancedSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.advanced")),1),e("div",{class:b(["collapse-arrow",{collapsed:m.value.advancedSettings}])},[r(x,{name:"chevron-down"})],2)]),r(k,{name:"collapse"},{default:C(()=>[m.value.advancedSettings?f("",!0):(h(),v("div",Nl,[e("div",Ol,[e("div",Wl,[e("div",El,o(l(s)("chat.singleChat.settings.linkedNpc")),1),e("div",jl,o(l(s)("chat.singleChat.settings.npcCount",{count:Ue.value})),1),t[60]||(t[60]=e("div",{class:"settings-pure-arrow"},"›",-1))])])]))]),_:1})]),e("div",Fl,[e("button",{class:"btn btn-danger big-btn",onClick:Ct},[e("div",ql,[e("div",Hl,o(F.value?l(s)("chat.singleChat.settings.unblock"):l(s)("chat.singleChat.settings.blockCharacter")),1),e("div",Gl,o(l(s)("chat.singleChat.settings.blockCharacterDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:_t},[e("div",Kl,[e("div",Ql,o(l(s)("chat.singleChat.settings.clearHistory")),1),e("div",Xl,o(l(s)("chat.singleChat.settings.clearHistoryDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:ft},[e("div",Yl,[e("div",Jl,o(l(s)("chat.deleteCharacterTitle")),1),e("div",Zl,o(l(s)("chat.deleteCharacterWarning")),1)])])])]),r(Mt,{visible:B.value,"onUpdate:visible":t[46]||(t[46]=a=>B.value=a),type:"basic","biz-type":"avatar",title:Xe.value,onSendImage:dt},null,8,["visible","title"]),r(Re,{visible:N.value,"onUpdate:visible":t[48]||(t[48]=a=>N.value=a),title:l(s)("chat.singleChat.settings.manualSummary")},{footer:C(()=>[e("button",{class:"modal-btn cancel",onClick:t[47]||(t[47]=a=>N.value=!1)},o(l(s)("cancel")),1)]),default:C(()=>[e("div",en,[e("div",{class:"modal-option",onClick:ht},[e("span",tn,o(l(s)("chat.singleChat.settings.summarizeRecent")),1)]),e("div",{class:"modal-option",onClick:vt},[e("span",sn,o(l(s)("chat.singleChat.settings.summarizeRange")),1)]),e("div",{class:"modal-option",onClick:pt},[e("span",an,o(l(s)("chat.singleChat.settings.summarizeVideo")),1)])])]),_:1},8,["visible","title"]),r(Re,{visible:ee.value,"onUpdate:visible":t[51]||(t[51]=a=>ee.value=a),title:l(s)("chat.singleChat.settings.summarizeRange")},{footer:C(()=>[e("button",{class:"modal-btn cancel",onClick:t[50]||(t[50]=a=>ee.value=!1)},o(l(s)("cancel")),1),e("button",{class:"modal-btn confirm",onClick:gt},o(l(s)("confirm")),1)]),default:C(()=>[g(e("input",{type:"text",class:"base-input","onUpdate:modelValue":t[49]||(t[49]=a=>pe.value=a),placeholder:l(s)("chat.singleChat.settings.rangePlaceholder",{total:me.value})},null,8,ln),[[p,pe.value]])]),_:1},8,["visible","title"])]))}},rn=wt(nn,[["__scopeId","data-v-552d8821"]]);export{rn as default};
