import{_ as T,u as B,r as N,c as y,x as j,d as n,e as t,F as c,C as u,t as i,g as V,i as L,a2 as Y,o as r,D as k,U as _,f as p,n as q}from"./index-C5myuwZ9.js";const z={class:"ins-layout"},E={class:"diary-book"},H={class:"binder-spine"},O={class:"paper-area"},U={class:"paper-header"},W={class:"favorites-title"},G={class:"content-viewport"},J={key:0,class:"empty-state"},K={key:1,class:"favorites-list"},P={class:"card-header"},Q={class:"card-date"},R=["onClick"],X={class:"card-content"},Z={key:0,class:"empty-state"},tt={key:1,class:"favorites-list"},et={class:"card-header"},st={class:"card-date"},ot=["onClick"],nt={class:"thought-content"},rt={class:"thought-row time-row"},at={class:"thought-row"},it={class:"thought-row"},lt={class:"thought-row"},ct={class:"thought-row"},dt={class:"thought-row"},ut={key:0,class:"empty-state"},ht={key:1,class:"favorites-list"},vt={class:"card-header"},yt={class:"card-date"},_t=["onClick"],gt={class:"moment-content-preview"},pt={key:0,class:"moment-text"},mt={key:1,class:"moment-images-text"},kt={class:"moment-meta"},ft={class:"moment-time"},xt={key:0,class:"moment-location"},bt={key:2,class:"moment-comments"},St={class:"comment-user"},wt={key:0,class:"comment-reply"},Ct={class:"comment-user"},$t={class:"comment-content"},It={key:0,class:"empty-state"},Dt={key:1,class:"favorites-list"},Mt={class:"card-header"},At={class:"card-date"},Ft=["onClick"],Tt={class:"card-content"},Bt={key:4,class:"empty-state"},Nt={class:"top-tabs"},jt=["onClick"],Vt={__name:"Favorites",props:{charId:{type:[String,Number],required:!0}},setup($){const h=$,a=B(),d=N("messages"),x=[{key:"messages",label:"æ¶ˆæ¯"},{key:"thoughts",label:"å¿ƒå£°"},{key:"moments",label:"æœ‹å‹åœˆ"},{key:"memory",label:"è®°å¿†"}],I=y(()=>{if(!a.characters||!Array.isArray(a.characters))return"";const o=a.characters.find(e=>String(e.id)===String(h.charId));return o?o.name:""}),D=y(()=>{const o=x.find(e=>e.key===d.value);return o?o.label:""}),b=y(()=>!a.favorites||!Array.isArray(a.favorites)?[]:a.favorites.filter(o=>String(o.charId)===String(h.charId)&&o.type==="messages")),S=y(()=>!a.favorites||!Array.isArray(a.favorites)?[]:a.favorites.filter(o=>String(o.charId)===String(h.charId)&&o.type==="thoughts")),w=y(()=>!a.favorites||!Array.isArray(a.favorites)?[]:a.favorites.filter(o=>String(o.charId)===String(h.charId)&&o.type==="moments")),C=y(()=>!a.favorites||!Array.isArray(a.favorites)?[]:a.favorites.filter(o=>String(o.charId)===String(h.charId)&&o.type==="memory")),g=o=>{const e=new Date(o);return`${e.getFullYear()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}`},M=o=>{if(!o)return"";const e=new Date(o);return`${e.getFullYear()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},f=o=>{const e=a.favorites.findIndex(s=>s.id===o);e!==-1&&(a.favorites.splice(e,1),a.saveData())},A=o=>{const e=a.favorites.indexOf(o);e!==-1&&a.favorites.splice(e,1);const s=a.getCharacter(h.charId);if(s&&s.memories){const l=s.memories.find(v=>{if(o.originalId&&v.id===o.originalId)return!0;let m=o.content;return m.includes(`
`)&&(m=m.split(`
`).slice(1).join(`
`)),v.content===m&&Math.abs((v.time||0)-(o.memoryTime||o.timestamp))<1e3});l&&(l.isFavorite=!1)}a.saveData()},F=o=>{if(o==="user")return"æˆ‘";const e=a.getCharacter(o);return e?e.name:"æœªçŸ¥ç”¨æˆ·"};return j(()=>{console.log("Favorites page mounted, charId:",h.charId)}),(o,e)=>(r(),n("div",z,[t("div",E,[t("div",H,[(r(),n(c,null,u(8,s=>t("div",{class:"ring",key:s})),64))]),t("div",O,[t("header",U,[t("h2",W,"å’Œ "+i(I.value)+" çš„å›žå¿†",1)]),t("div",G,[V(Y,{name:"fade",mode:"out-in"},{default:L(()=>[(r(),n("div",{class:"card-container",key:d.value},[d.value==="messages"?(r(),n(c,{key:0},[b.value.length===0?(r(),n("div",J,[...e[0]||(e[0]=[t("p",null,"æš‚æ— æ”¶è—çš„æ¶ˆæ¯",-1)])])):(r(),n("div",K,[(r(!0),n(c,null,u(b.value,s=>(r(),n("div",{class:"memory-card",key:s.id},[t("div",P,[t("span",Q,"æ”¶è—äºŽ "+i(g(s.timestamp)),1),t("button",{class:"delete-btn",onClick:k(l=>f(s.id),["stop"])},[...e[1]||(e[1]=[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,R)]),t("div",X,i(s.content),1)]))),128))]))],64)):d.value==="thoughts"?(r(),n(c,{key:1},[S.value.length===0?(r(),n("div",Z,[...e[2]||(e[2]=[t("p",null,"æš‚æ— æ”¶è—çš„å¿ƒå£°",-1)])])):(r(),n("div",tt,[(r(!0),n(c,null,u(S.value,s=>(r(),n("div",{class:"memory-card thought-card",key:s.id},[t("div",et,[t("span",st,"æ”¶è—äºŽ "+i(g(s.timestamp)),1),t("button",{class:"delete-btn",onClick:k(l=>f(s.id),["stop"])},[...e[3]||(e[3]=[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,ot)]),t("div",nt,[t("div",rt,i(M(s.content.timestamp)),1),t("div",at,[e[4]||(e[4]=t("span",{class:"thought-label"},"æƒ…ç»ªï¼š",-1)),_(i(s.content.emotion),1)]),t("div",it,[e[5]||(e[5]=t("span",{class:"thought-label"},"ç©¿ç€ï¼š",-1)),_(i(s.content.outfit),1)]),t("div",lt,[e[6]||(e[6]=t("span",{class:"thought-label"},"å§¿æ€ï¼š",-1)),_(i(s.content.posture),1)]),t("div",ct,[e[7]||(e[7]=t("span",{class:"thought-label"},"å†…å¿ƒç‹¬ç™½ï¼š",-1)),_(i(s.content.innerVoice),1)]),t("div",dt,[e[8]||(e[8]=t("span",{class:"thought-label"},"æ²¡è¯´å‡ºå£çš„è¯ï¼š",-1)),_(i(s.content.unspokenWords),1)])])]))),128))]))],64)):d.value==="moments"?(r(),n(c,{key:2},[w.value.length===0?(r(),n("div",ut,[...e[9]||(e[9]=[t("p",null,"æš‚æ— æ”¶è—çš„æœ‹å‹åœˆ",-1)])])):(r(),n("div",ht,[(r(!0),n(c,null,u(w.value,s=>(r(),n("div",{class:"memory-card moment-card",key:s.id},[t("div",vt,[t("span",yt,"æ”¶è—äºŽ "+i(g(s.timestamp)),1),t("button",{class:"delete-btn",onClick:k(l=>f(s.id),["stop"])},[...e[10]||(e[10]=[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,_t)]),t("div",gt,[s.content.content?(r(),n("div",pt,i(s.content.content),1)):p("",!0),s.content.images&&s.content.images.length>0?(r(),n("div",mt,[(r(!0),n(c,null,u(s.content.images,(l,v)=>(r(),n("div",{key:v}," [å›¾ç‰‡ï¼š"+i(l.imageDescription||l.content||(s.content.images.length>1?`å›¾ç‰‡${v+1}`:"å›¾ç‰‡"))+"] ",1))),128))])):p("",!0),t("div",kt,[t("span",ft,i(g(s.content.time)),1),s.content.location?(r(),n("span",xt," ðŸ“ "+i(s.content.location),1)):p("",!0)]),s.content.comments&&s.content.comments.length>0?(r(),n("div",bt,[(r(!0),n(c,null,u(s.content.comments,l=>(r(),n("div",{key:l.id,class:"comment-item"},[t("span",St,i(F(l.userId)),1),l.replyTo?(r(),n("span",wt,[e[11]||(e[11]=_("å›žå¤ ",-1)),t("span",Ct,i(l.replyTo.id==="user"?"æˆ‘":l.replyTo.name),1)])):p("",!0),t("span",$t,": "+i(l.content),1)]))),128))])):p("",!0)])]))),128))]))],64)):d.value==="memory"?(r(),n(c,{key:3},[C.value.length===0?(r(),n("div",It,[...e[12]||(e[12]=[t("p",null,"æš‚æ— æ”¶è—çš„è®°å¿†",-1)])])):(r(),n("div",Dt,[(r(!0),n(c,null,u(C.value,(s,l)=>(r(),n("div",{class:"memory-card",key:s.id||l},[t("div",Mt,[t("span",At,"æ”¶è—äºŽ "+i(g(s.timestamp)),1),t("button",{class:"delete-btn",onClick:k(v=>A(s),["stop"])},[...e[13]||(e[13]=[t("svg",{viewBox:"0 0 24 24",width:"14",height:"14",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])],8,Ft)]),t("div",Tt,i(s.content),1)]))),128))]))],64)):(r(),n("div",Bt,[t("p",null,"æš‚æ— æ”¶è—çš„"+i(D.value),1)]))]))]),_:1})])]),t("div",Nt,[(r(),n(c,null,u(x,s=>t("div",{key:s.key,class:q(["tab",{active:d.value===s.key}]),onClick:l=>d.value=s.key},i(s.label),11,jt)),64))])])]))}},Yt=T(Vt,[["__scopeId","data-v-7772bca2"]]);export{Yt as default};
