import{cd as ve,r as m,ce as z,_ as me,k as he,Q as be,U as ge,m as ke,q as fe,E as we,s as _e,c as V,t as F,d as ye,w as D,y as s,a3 as xe,o as f,e,f as E,z as i,v as B,x as I,a as w,b as C,F as K,A as J,c0 as Pe,n as T,M as q}from"./index-vVFo7Nn2.js";import{C as Q}from"./CustomSelect-ClQ8tvS_.js";const Ce=ve("backup",()=>{const A=m(""),o=m(""),p=m(!1),k=m(null);function h(n={chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0}){return new Promise(v=>{setTimeout(()=>{const l={},b=localStorage.getItem("aiPhoneSingleChatData");if(b)try{const d=z.decompressFromUTF16(b),c=JSON.parse(d||b),r={};let P=!1;if(n.chat&&(r.messages=c.messages,P=!0),n.characters&&(r.characters=c.characters,r.userPersonas=c.userPersonas,r.favorites=c.favorites,P=!0),n.appearance&&(r.bubblePresets=c.bubblePresets,r.stickers=c.stickers,P=!0),P){const _=JSON.stringify(r),g=z.compressToUTF16(_);l.aiPhoneSingleChatData=g}}catch(d){console.error("Error processing single chat data for backup",d)}if(n.chat){const d=localStorage.getItem("aiPhoneMomentsData");d&&(l.aiPhoneMomentsData=d)}n.settings&&["api_presets","api_activePresetName","api_imageHostProvider","api_imgbbApiKey","api_catboxUserHash","aiPhoneGlobalBackgroundActivity","aiPhoneGlobalProactiveScope","aiPhoneGlobalProactiveInterval","aiPhoneGlobalProactiveCooldown","aiPhoneGlobalProactiveDailyLimit","aiPhoneGlobalTriggerMode","aiPhoneGlobalProactiveIdleTime"].forEach(c=>{const r=localStorage.getItem(c);r!==null&&(l[c]=r)}),n.appearance&&["aiPhoneThemePresets","aiPhoneCurrentThemePreset","aiPhoneFontPresets","aiPhoneCurrentFontPreset","aiPhoneCssPresets","aiPhoneCurrentCssPreset"].forEach(c=>{const r=localStorage.getItem(c);r!==null&&(l[c]=r)}),n.worldbook&&["worldBooks","worldBookNextId"].forEach(c=>{const r=localStorage.getItem(c);r!==null&&(l[c]=r)}),v(JSON.stringify(l,null,2))},0)})}async function H(){if(A.value=localStorage.getItem("github_token")||"",!A.value){alert("请先设置 GitHub Token！");return}try{const n=await fetch("https://api.github.com/user/repos",{method:"POST",headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({name:"phone-backup",private:!0,description:"Backup for Phone Vue App"})});if(n.ok){const v=await n.json();o.value=v.full_name,alert(`仓库 ${v.full_name} 创建成功！即将开始备份...`),await y()}else{const v=await n.json();if(v.errors&&v.errors[0].message==="name already exists on this account"){const l=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${A.value}`}});if(l.ok){const b=await l.json();o.value=`${b.login}/phone-backup`,alert(`仓库已存在，已自动关联到 ${o.value}。即将开始备份...`),await y();return}}alert(`创建仓库失败: ${v.message}`)}}catch(n){console.error("Create repo failed:",n),alert(`创建仓库出错: ${n.message}`)}}async function y(){if(A.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!A.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(p.value){alert("正在备份中，请稍候...");return}p.value=!0,alert("正在准备备份数据...");try{const n=await h();alert("数据准备完成，开始上传...");const v="phone_backup.json",[l,b]=o.value.split("/"),d=`https://api.github.com/repos/${l}/${b}/contents/${v}`;let c;try{const g=await fetch(d,{headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json"}});g.ok&&(c=(await g.json()).sha)}catch{}const P={message:`Backup from phone-vue-app: ${new Date().toISOString()}`,content:btoa(unescape(encodeURIComponent(n))),sha:c},_=await fetch(d,{method:"PUT",headers:{Authorization:`token ${A.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(P)});if(_.ok)k.value=new Date,alert("备份成功！");else{const g=await _.json();console.error("GitHub API Error:",g),alert(`备份失败: ${g.message}`)}}catch(n){console.error("Backup to GitHub failed:",n),alert(`备份过程中发生错误: ${n.message}`)}finally{p.value=!1}}async function S(){alert("从 GitHub 恢复的功能尚未实现。")}async function U(n){try{alert("正在生成备份文件...");const v=await h(n),l=new Blob([v],{type:"application/json"}),b=URL.createObjectURL(l),d=document.createElement("a");d.href=b,d.download=`phone_backup_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(b),alert("备份文件已开始下载！")}catch(v){console.error("Export backup failed:",v),alert(`导出备份文件时出错: ${v.message}`)}}function N(){const n=document.createElement("input");n.type="file",n.accept="application/json",n.onchange=v=>{const l=v.target.files[0];if(!l)return;const b=new FileReader;b.onload=d=>{try{const c=JSON.parse(d.target.result);if(confirm("这将覆盖所有当前数据，确定要导入吗？")){localStorage.clear();for(const r in c)Object.hasOwnProperty.call(c,r)&&localStorage.setItem(r,c[r]);alert("数据导入成功！请刷新页面以应用更改。")}}catch(c){console.error("Import backup failed:",c),alert(`导入失败，请确保文件格式正确: ${c.message}`)}},b.readAsText(l)},n.click()}return{githubToken:A,githubRepo:o,isBackingUp:p,lastBackupTime:k,backupToGitHub:y,restoreFromGitHub:S,exportBackupFile:U,importBackupFile:N,createBackupRepo:H}}),Se={class:"card"},Be={class:"card-title"},Te={class:"card-content"},Ae={class:"api-item-row"},Ie={style:{flex:"1","min-width":"0"}},Ue={class:"api-item-col"},Ne={class:"form-label",for:"api-url"},$e=["placeholder"],De={class:"api-item-col"},He={class:"form-label",for:"api-key"},je=["placeholder"],Ge={class:"api-item-row"},Me={class:"list-item-title",style:{"font-weight":"normal","white-space":"nowrap"}},Fe={style:{flex:"1",display:"flex",gap:"10px","align-items":"center","min-width":"0"}},Re={style:{flex:"1","min-width":"0",position:"relative"}},Oe={key:0,value:"",disabled:""},Ee=["value"],Ve={class:"card"},Ke={class:"card-title"},Le={class:"card-title-note",style:{padding:"0 16px 10px","margin-top":"-10px",color:"var(--danger-color)"}},ze={class:"card-content"},Je={class:"api-item-row"},qe={class:"list-item-content"},Qe={class:"list-item-title"},We={class:"list-item-subtitle"},Ze={class:"api-item-row"},Xe={class:"list-item-content"},Ye={class:"list-item-title"},et={class:"api-item-row"},tt={class:"list-item-content"},ot={class:"list-item-title"},st={class:"api-item-row"},at={class:"list-item-content"},it={class:"list-item-title"},lt={class:"api-item-row"},nt={class:"list-item-content"},ct={class:"list-item-title"},rt={class:"api-item-row"},dt={class:"list-item-content"},pt={class:"list-item-title"},ut={class:"list-item-subtitle"},vt={class:"mode-selector"},mt={key:0,class:"api-item-row"},ht={class:"list-item-content"},bt={class:"list-item-title"},gt={class:"list-item-subtitle"},kt={class:"card"},ft={class:"card-title"},wt={class:"card-content"},_t={class:"api-item-row"},yt={class:"list-item-content"},xt={class:"list-item-title"},Pt={class:"list-item-subtitle"},Ct={class:"api-item-row"},St={class:"list-item-content"},Bt={class:"list-item-title"},Tt={class:"list-item-subtitle"},At={class:"card"},It={class:"card-title"},Ut={class:"card-content"},Nt={class:"api-item-col"},$t={class:"form-label",for:"github-token"},Dt={class:"input-hint"},Ht={style:{display:"flex",gap:"10px"}},jt=["placeholder"],Gt={class:"api-item-col"},Mt={class:"form-label",for:"github-repo"},Ft={style:{display:"flex",gap:"10px"}},Rt=["placeholder"],Ot=["disabled"],Et={class:"api-item-row"},Vt=["disabled"],Kt={key:0,style:{"font-size":"12px",color:"var(--text-tertiary)","margin-top":"10px"}},Lt={class:"card"},zt={class:"card-title"},Jt={class:"card-content"},qt={class:"api-item-row"},Qt={class:"list-item-content",style:{flex:"1","min-width":"0"}},Wt={class:"list-item-title"},Zt={class:"list-item-subtitle"},Xt={style:{width:"120px","flex-shrink":"0"}},Yt={class:"api-item-col"},eo={class:"form-label",for:"imgbb-api-key"},to={class:"input-hint"},oo={style:{display:"flex",gap:"10px"}},so=["placeholder"],ao={class:"api-item-col"},io={class:"form-label",for:"catbox-hash"},lo={class:"input-hint"},no={style:{display:"flex",gap:"10px"}},co=["placeholder"],ro={class:"card"},po={class:"card-title"},uo={class:"card-content"},vo={style:{"font-size":"13px",color:"var(--text-tertiary)","margin-bottom":"15px"}},mo={class:"api-item-row",style:{"border-bottom":"none","padding-bottom":"0"}},ho={class:"scope-list"},bo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},go={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},ko={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},fo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},wo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},_o={class:"scope-list",style:{"max-height":"300px","overflow-y":"auto"}},yo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},xo={class:"scope-name"},Po=["onClick"],Co={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},So={class:"scope-name"},Bo={__name:"API",setup(A){const{t:o}=he(),p=be(),k=ge(),h=Ce(),H=ke(),y=fe(),S=we(),U=m(""),N=m(""),n=m(""),v=m(!1),l=m([]),b=m(5),d=m(30),c=m(10),r=m("always"),P=m(15),_=m(""),g=m(""),$=m("catbox"),j=m(""),G=m(""),W=m([{value:"catbox",label:"Catbox"},{value:"imgbb",label:"ImgBB"}]);_e(()=>{v.value=k.globalBackgroundActivity,l.value=[...k.globalProactiveScope||[]],b.value=k.globalProactiveInterval,d.value=k.globalProactiveCooldown,c.value=k.globalProactiveDailyLimit,r.value=k.globalTriggerMode,P.value=k.globalProactiveIdleTime,_.value=localStorage.getItem("github_token")||"",g.value=localStorage.getItem("github_repo")||"",$.value=p.imageHostProvider,j.value=p.imgbbApiKey,G.value=p.catboxUserHash});const Z=V(()=>p.presets.find(u=>u.name===p.activePresetName)||null);F(Z,u=>{u&&(U.value=u.apiKey,N.value=u.apiUrl,n.value=u.model)},{immediate:!0,deep:!0}),F([U,N,n],()=>{p.activePresetName&&p.addPreset(p.activePresetName,{apiKey:U.value,apiUrl:N.value,model:n.value})}),F([v,l,b,d,c,r,P],()=>{k.globalBackgroundActivity=v.value,k.globalProactiveScope=l.value,k.globalProactiveInterval=b.value,k.globalProactiveCooldown=d.value,k.globalProactiveDailyLimit=c.value,k.globalTriggerMode=r.value,k.globalProactiveIdleTime=P.value},{deep:!0}),F([_,g],()=>{h.githubToken=_.value,h.githubRepo=g.value,localStorage.setItem("github_token",_.value),localStorage.setItem("github_repo",g.value)}),F([$,j,G],()=>{p.imageHostProvider=$.value,p.imgbbApiKey=j.value,p.catboxUserHash=G.value},{deep:!0});function X(){y.showToast(o("api.toast.settingsSaved"))}function Y(){y.showInput(o("api.prompt.saveAsPreset"),"",u=>{u&&(p.addPreset(u,{apiKey:U.value,apiUrl:N.value,model:n.value}),y.showToast(o("api.toast.presetSaved",{name:u})))},o("api.prompt.enterPresetName"))}function ee(){y.showConfirm(o("api.confirm.deletePreset"),o("api.confirm.deletePresetMsg",{name:p.activePresetName}),()=>{p.deletePreset(p.activePresetName),y.showToast(o("api.toast.presetDeleted"))})}async function te(){const u={apiUrl:N.value,apiKey:U.value};await p.fetchModels(u)}const oe=V(()=>{switch(S.permission){case"granted":return o("api.notificationsGranted");case"denied":return o("api.notificationsDenied");default:return o("api.notificationsDefault")}}),se=()=>{S.permission!=="granted"?S.requestPermission():S.desktopNotificationsEnabled=!S.desktopNotificationsEnabled},ae=()=>{if(!S.desktopNotificationsEnabled){y.showToast("请先开启“桌面通知”开关。","warning");return}if(S.permission!=="granted"){y.showToast("浏览器通知权限未授予，请点击开关重新授权。","warning");return}y.showToast("测试通知已发送，请检查系统通知。"),S.triggerNotification("测试通知","如果看到此消息，说明桌面通知功能正常。","/pwa-192x192.png",()=>{console.log("Test notification clicked!")})},ie=async()=>{h.githubToken=_.value,await h.createBackupRepo(),g.value=h.githubRepo},le=async()=>{h.githubToken=_.value,h.githubRepo=g.value,await h.backupToGitHub()};function ne(){window.open("https://github.com/settings/tokens/new?scopes=repo&description=Phone%20App%20Backup","_blank")}function ce(){window.open("https://api.imgbb.com/","_blank")}function re(){window.open("https://catbox.moe/user/","_blank")}function de(){y.showConfirm("确认清除所有数据？","此操作将永久删除所有本地存储的数据（包括聊天记录、API设置、背景图片等）。应用将重置为初始状态。请确保您已备份重要数据。",()=>{localStorage.clear(),window.location.reload()},{messageStyle:{color:"#FF3B30"},confirmText:"清除"})}const R=m(!1),x=m({chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0});function M(u){x.value[u]=!x.value[u]}function pe(){h.exportBackupFile(x.value),R.value=!1}const O=m(!1),ue=V(()=>{const u=l.value||[];return u.includes("all")?o("api.scopeAll"):u.length===0?o("api.scopeNone"):o("api.scopeSelected",{count:u.length})});function L(u){const t=l.value;if(u==="all")t.includes("all")?l.value=[]:l.value=["all"];else if(t.includes("all"))l.value=[u];else{const a=t.indexOf(u);a>-1?t.splice(a,1):t.push(u),H.characters.length>0&&t.length===H.characters.length&&(l.value=["all"])}}return(u,t)=>(f(),ye(xe,{title:s(o)("api.title")},{action:D(()=>[e("button",{class:"header-save-btn",onClick:X},i(s(o)("save")),1)]),default:D(()=>[e("div",Se,[e("div",Be,i(s(o)("api.globalConfig")),1),e("div",Te,[e("div",Ae,[e("div",Ie,[E(Q,{"model-value":s(p).activePresetName,options:s(p).presets.map(a=>({value:a.name,label:a.name})),"onUpdate:modelValue":t[0]||(t[0]=a=>s(p).switchPreset(a)),textAlign:"left",style:{width:"100%"}},null,8,["model-value","options"])]),e("button",{class:"btn btn-secondary btn-sm",onClick:Y},i(s(o)("api.saveAs")),1),e("button",{class:"btn btn-danger-light btn-sm",onClick:ee},i(s(o)("delete")),1)]),e("div",Ue,[e("label",Ne,i(s(o)("api.apiUrl")),1),B(e("input",{type:"text",id:"api-url",class:"base-input","onUpdate:modelValue":t[1]||(t[1]=a=>N.value=a),placeholder:s(o)("api.apiUrlPlaceholder"),autocomplete:"new-password"},null,8,$e),[[I,N.value]])]),e("div",De,[e("label",He,i(s(o)("api.apiKey")),1),B(e("input",{type:"password",id:"api-key",class:"base-input","onUpdate:modelValue":t[2]||(t[2]=a=>U.value=a),placeholder:s(o)("api.apiKeyPlaceholder"),autocomplete:"new-password"},null,8,je),[[I,U.value]])]),e("div",Ge,[e("div",Me,i(s(o)("api.model")),1),e("div",Fe,[e("div",Re,[B(e("select",{class:"native-select","onUpdate:modelValue":t[3]||(t[3]=a=>n.value=a)},[s(p).models.length===0?(f(),w("option",Oe,i(s(o)("api.modelPlaceholder")),1)):C("",!0),(f(!0),w(K,null,J(s(p).models,a=>(f(),w("option",{key:a,value:a},i(a),9,Ee))),128))],512),[[Pe,n.value]]),t[29]||(t[29]=e("div",{class:"select-arrow"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1))]),e("button",{class:"btn btn-secondary btn-sm",onClick:te,style:{"white-space":"nowrap"}},i(s(o)("api.fetch")),1)])])])]),e("div",Ve,[e("div",Ke,i(s(o)("api.backgroundActivity")),1),e("div",Le,i(s(o)("api.backgroundActivityWarning")),1),e("div",ze,[e("div",Je,[e("div",qe,[e("div",Qe,i(s(o)("api.proactiveMessages")),1),e("div",We,i(s(o)("api.proactiveMessagesDesc")),1)]),e("div",{class:T(["toggle-switch",{active:v.value}]),onClick:t[4]||(t[4]=a=>v.value=!v.value)},null,2)]),v.value?(f(),w(K,{key:0},[e("div",Ze,[e("div",Xe,[e("div",Ye,i(s(o)("api.scope")),1)]),e("div",{class:"scope-selector",onClick:t[5]||(t[5]=a=>O.value=!0)},[e("span",null,i(ue.value),1),t[30]||(t[30]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1))])]),e("div",et,[e("div",tt,[e("div",ot,i(s(o)("api.interval")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>b.value=a),class:"base-input base-input-short",placeholder:"5",autocomplete:"new-password"},null,512),[[I,b.value,void 0,{number:!0}]])]),e("div",st,[e("div",at,[e("div",it,i(s(o)("api.cooldown")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>d.value=a),class:"base-input base-input-short",placeholder:"30",autocomplete:"new-password"},null,512),[[I,d.value,void 0,{number:!0}]])]),e("div",lt,[e("div",nt,[e("div",ct,i(s(o)("api.dailyLimit")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>c.value=a),class:"base-input base-input-short",placeholder:"10",autocomplete:"new-password"},null,512),[[I,c.value,void 0,{number:!0}]])]),e("div",rt,[e("div",dt,[e("div",pt,i(s(o)("api.triggerMode")),1),e("div",ut,i(s(o)("api.triggerModeIdleHint")),1)]),e("div",vt,[e("div",{class:T(["mode-option",{active:r.value==="idle"}]),onClick:t[9]||(t[9]=a=>r.value="idle")},i(s(o)("api.triggerModeIdle")),3),e("div",{class:T(["mode-option",{active:r.value==="always"}]),onClick:t[10]||(t[10]=a=>r.value="always")},i(s(o)("api.triggerModeAlways")),3)])]),r.value==="idle"?(f(),w("div",mt,[e("div",ht,[e("div",bt,i(s(o)("api.idleTime")),1),e("div",gt,i(s(o)("api.idleTimeDesc")),1)]),B(e("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=a=>P.value=a),class:"base-input base-input-short",placeholder:"15",autocomplete:"new-password"},null,512),[[I,P.value,void 0,{number:!0}]])])):C("",!0)],64)):C("",!0)])]),e("div",kt,[e("div",ft,i(s(o)("api.notificationSettings")),1),e("div",wt,[e("div",_t,[e("div",yt,[e("div",xt,i(s(o)("api.desktopNotifications")),1),e("div",Pt,i(oe.value),1)]),e("div",{class:T(["toggle-switch",{active:s(S).desktopNotificationsEnabled}]),onClick:se},null,2)]),e("div",Ct,[e("div",St,[e("div",Bt,i(s(o)("api.testNotification")),1),e("div",Tt,i(s(o)("api.testNotificationDesc")),1)]),e("button",{class:"btn btn-secondary btn-sm",onClick:ae},i(s(o)("api.test")),1)])])]),e("div",At,[e("div",It,i(s(o)("api.githubBackup")),1),e("div",Ut,[e("div",Nt,[e("label",$t,i(s(o)("api.githubToken")),1),e("div",Dt,i(s(o)("api.githubTokenHint")),1),e("div",Ht,[B(e("input",{type:"password",id:"github-token",class:"base-input small-placeholder","onUpdate:modelValue":t[12]||(t[12]=a=>_.value=a),placeholder:s(o)("api.githubTokenPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,jt),[[I,_.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ne},i(s(o)("api.getToken")),1)])]),e("div",Gt,[e("label",Mt,i(s(o)("api.repoAddress")),1),e("div",Ft,[B(e("input",{type:"text",id:"github-repo",class:"base-input","onUpdate:modelValue":t[13]||(t[13]=a=>g.value=a),placeholder:s(o)("api.repoAddressPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Rt),[[I,g.value]]),g.value?C("",!0):(f(),w("button",{key:0,class:"btn btn-secondary btn-sm",onClick:ie,disabled:!_.value},i(s(o)("api.createRepo")),9,Ot))])]),e("div",Et,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:le,disabled:s(h).isBackingUp},i(s(h).isBackingUp?s(o)("api.backingUp"):s(o)("api.backupNow")),9,Vt),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[14]||(t[14]=(...a)=>s(h).restoreFromGitHub&&s(h).restoreFromGitHub(...a))},i(s(o)("api.restoreBackup")),1)]),s(h).lastBackupTime?(f(),w("p",Kt,i(s(o)("api.lastBackup"))+" "+i(new Date(s(h).lastBackupTime).toLocaleString()),1)):C("",!0)])]),e("div",Lt,[e("div",zt,i(s(o)("api.imageHost")),1),e("div",Jt,[e("div",qt,[e("div",Qt,[e("div",Wt,i(s(o)("api.defaultImageHost")),1),e("div",Zt,i(s(o)("api.defaultImageHostDesc")),1)]),e("div",Xt,[E(Q,{"model-value":$.value,options:W.value,"onUpdate:modelValue":t[15]||(t[15]=a=>$.value=a),textAlign:"right"},null,8,["model-value","options"])])]),e("div",Yt,[e("label",eo,i(s(o)("api.imgbbApiKey")),1),e("div",to,i(s(o)("api.imgbbApiKeyHint")),1),e("div",oo,[B(e("input",{type:"password",id:"imgbb-api-key",class:"base-input small-placeholder","onUpdate:modelValue":t[16]||(t[16]=a=>j.value=a),placeholder:s(o)("api.imgbbApiKeyPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,so),[[I,j.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ce},i(s(o)("api.getImgbbApiKey")),1)])]),e("div",ao,[e("label",io,i(s(o)("api.catboxUserHash")),1),e("div",lo,i(s(o)("api.catboxUserHashHint")),1),e("div",no,[B(e("input",{type:"text",id:"catbox-hash",class:"base-input small-placeholder","onUpdate:modelValue":t[17]||(t[17]=a=>G.value=a),placeholder:s(o)("api.catboxUserHashPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,co),[[I,G.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:re},i(s(o)("api.getCatboxUserHash")),1)])])])]),e("div",ro,[e("div",po,i(s(o)("api.dataBackup")),1),e("div",uo,[e("p",vo,i(s(o)("api.dataBackupDesc")),1),e("div",mo,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[18]||(t[18]=a=>R.value=!0)},i(s(o)("api.exportBackupFile")),1),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[19]||(t[19]=(...a)=>s(h).importBackupFile&&s(h).importBackupFile(...a))},i(s(o)("api.importBackupFile")),1)])])]),e("div",{class:"danger-zone"},[e("button",{class:"btn btn-danger big-btn",onClick:de},[...t[31]||(t[31]=[e("div",{class:"danger-btn-content"},[e("div",{class:"danger-btn-title"},"清除所有数据"),e("div",{class:"danger-btn-desc"},"此操作将清除所有聊天记录、设置和本地数据，且无法恢复")],-1)])])]),E(q,{visible:R.value,"onUpdate:visible":t[25]||(t[25]=a=>R.value=a),title:"导出选项",bodyClass:"no-padding"},{footer:D(()=>[e("button",{class:"modal-btn confirm",onClick:pe},"确认导出")]),default:D(()=>[e("div",ho,[e("div",{class:"scope-item",onClick:t[20]||(t[20]=a=>M("chat"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.chat}])},[x.value.chat?(f(),w("svg",bo,[...t[32]||(t[32]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[33]||(t[33]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"聊天数据"),e("span",{class:"scope-desc"},"包含聊天记录和朋友圈")],-1))]),e("div",{class:"scope-item",onClick:t[21]||(t[21]=a=>M("characters"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.characters}])},[x.value.characters?(f(),w("svg",go,[...t[34]||(t[34]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[35]||(t[35]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"角色数据"),e("span",{class:"scope-desc"},"包含角色卡片、用户人设和收藏")],-1))]),e("div",{class:"scope-item",onClick:t[22]||(t[22]=a=>M("settings"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.settings}])},[x.value.settings?(f(),w("svg",ko,[...t[36]||(t[36]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[37]||(t[37]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"API设置"),e("span",{class:"scope-desc"},"包含API配置、图床、后台设置")],-1))]),e("div",{class:"scope-item",onClick:t[23]||(t[23]=a=>M("appearance"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.appearance}])},[x.value.appearance?(f(),w("svg",fo,[...t[38]||(t[38]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[39]||(t[39]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"外观主题"),e("span",{class:"scope-desc"},"包含主题、字体、气泡样式")],-1))]),e("div",{class:"scope-item",onClick:t[24]||(t[24]=a=>M("worldbook"))},[e("div",{class:T(["scope-checkbox",{checked:x.value.worldbook}])},[x.value.worldbook?(f(),w("svg",wo,[...t[40]||(t[40]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),t[41]||(t[41]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"世界书"),e("span",{class:"scope-desc"},"包含世界书设定")],-1))])])]),_:1},8,["visible"]),E(q,{visible:O.value,"onUpdate:visible":t[28]||(t[28]=a=>O.value=a),title:s(o)("api.selectScope"),bodyClass:"no-padding"},{footer:D(()=>[e("button",{class:"modal-btn confirm",onClick:t[27]||(t[27]=a=>O.value=!1)},i(s(o)("confirm")),1)]),default:D(()=>[e("div",_o,[e("div",{class:"scope-item",onClick:t[26]||(t[26]=a=>L("all"))},[e("div",{class:T(["scope-checkbox",{checked:l.value&&l.value.includes("all")}])},[l.value&&l.value.includes("all")?(f(),w("svg",yo,[...t[42]||(t[42]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),e("span",xo,i(s(o)("api.scopeAll")),1)]),(f(!0),w(K,null,J(s(H).characters,a=>(f(),w("div",{key:a.id,class:"scope-item",onClick:To=>L(a.id)},[e("div",{class:T(["scope-checkbox",{checked:l.value&&l.value.includes(a.id)}])},[l.value&&l.value.includes(a.id)?(f(),w("svg",Co,[...t[43]||(t[43]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):C("",!0)],2),e("span",So,i(a.name),1)],8,Po))),128))])]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},Uo=me(Bo,[["__scopeId","data-v-ccc0c69f"]]);export{Uo as default};
