import{_ as It,m as Bt,u as Ut,s as Vt,Z as Tt,$ as Dt,R as Re,a0 as At,V as Mt,a1 as $t,r as i,c as U,y as ze,x as Lt,j as Rt,d as u,e,g as d,t as o,B as l,n as _,S as V,i as y,a2 as P,N as zt,M as Ne,o as v,f as k,w as h,A as p,E as Oe}from"./index-BWKtMuGn.js";import{C as Be}from"./CustomSelect-B0qCDkON.js";import{M as Ee}from"./MultiSelect-Bms_izCW.js";const Nt={class:"chat-settings active"},Ot={class:"app-header"},Et={class:"title"},jt={class:"action-btn"},Wt={class:"app-content settings-content"},Ft={class:"card"},Ht={key:"roleInfo"},qt={class:"card-content"},Gt={class:"role-header-layout"},Kt=["src"],Zt={key:1,class:"role-avatar-placeholder"},Jt={class:"role-inputs-wrapper"},Qt=["placeholder"],Xt=["placeholder"],Yt={class:"form-item-vertical"},es={class:"label-main",style:{"margin-bottom":"5px"}},ts=["placeholder"],ss={class:"card"},as={key:"userInfo"},ls={class:"card-content"},ns={class:"settings-pure-item",style:{"border-bottom":"none"}},os={class:"settings-pure-label"},is={class:"user-header-layout"},cs=["src"],rs={key:1,class:"role-avatar-placeholder"},ds={class:"user-inputs-wrapper"},us={class:"user-actions-row"},vs=["placeholder"],gs={class:"form-item-vertical"},hs={class:"label-main",style:{"margin-bottom":"5px"}},ps=["placeholder"],ms={class:"card"},bs={class:"card-title-remark"},_s={key:"backgroundActivity"},Cs={class:"card-content"},fs={class:"settings-item-input"},ys={class:"label-col"},ks={class:"label-main"},ws={class:"settings-pure-value"},Ss={class:"settings-item-input"},Ps={class:"label-col"},xs={class:"label-main"},Is={class:"label-sub"},Bs={class:"mode-selector"},Us={key:0},Vs={class:"settings-item-input"},Ts={class:"label-col"},Ds={class:"label-main"},As={class:"label-sub"},Ms={class:"settings-item-input"},$s={class:"label-col"},Ls={class:"label-main"},Rs={class:"label-sub"},zs={class:"settings-item-input"},Ns={class:"label-col"},Os={class:"label-main"},Es={class:"label-sub"},js={class:"settings-item-input"},Ws={class:"label-col"},Fs={class:"label-main"},Hs={class:"label-sub"},qs={class:"mode-selector"},Gs={key:0,class:"settings-item-input"},Ks={class:"label-col"},Zs={class:"label-main"},Js={class:"label-sub"},Qs={class:"card"},Xs={key:"modeSettings"},Ys={class:"card-content"},ea={class:"settings-pure-item"},ta={class:"settings-pure-label"},sa={class:"mode-selector"},aa={key:0,class:"settings-pure-item"},la={class:"settings-pure-label"},na={class:"settings-pure-item"},oa={class:"settings-pure-label"},ia={class:"settings-item-input"},ca={class:"label-col"},ra={class:"label-main"},da={class:"label-sub"},ua={class:"reply-length-container"},va=["placeholder"],ga=["placeholder"],ha={class:"card"},pa={key:"realtimeSense"},ma={class:"card-content"},ba={class:"settings-item-input"},_a={class:"settings-item-input"},Ca={key:0},fa={class:"form-item-vertical"},ya={class:"location-input-group"},ka={class:"location-display"},wa={class:"form-item-vertical"},Sa={class:"location-input-group"},Pa={class:"location-display"},xa={class:"card"},Ia={key:"summarySettings"},Ba={class:"card-content"},Ua={class:"settings-item-input"},Va={class:"label-col"},Ta={class:"label-main"},Da={class:"label-sub"},Aa={class:"form-item-vertical"},Ma={class:"label-main",style:{"margin-bottom":"5px"}},$a=["placeholder"],La={class:"settings-item-input"},Ra={class:"label-col"},za={class:"label-main"},Na={class:"label-sub"},Oa={class:"settings-btn-row flex-distribute-children",style:{padding:"15px 0","border-bottom":"1px solid #f5f5f5"}},Ea={class:"settings-item-input"},ja={class:"label-col"},Wa={class:"label-main"},Fa={class:"label-sub"},Ha={class:"settings-pure-item"},qa={class:"settings-pure-label"},Ga={class:"settings-pure-item"},Ka={class:"settings-pure-label"},Za={class:"settings-pure-value"},Ja={class:"settings-pure-item"},Qa={class:"settings-pure-label"},Xa={class:"settings-pure-value"},Ya={class:"card"},el={key:"bubbleSettings"},tl={class:"card-content"},sl={class:"settings-section-title"},al={class:"settings-row-group"},ll={class:"settings-pure-label",style:{width:"60px"}},nl={style:{flex:"1",margin:"0 10px"}},ol={class:"btn-group-mini"},il=["disabled"],cl={class:"bubble-preview-container"},rl={class:"bubble-preview-area"},dl={class:"preview-msg-row left"},ul={class:"preview-avatar char"},vl=["src"],gl={key:1,class:"default-avatar"},hl={class:"preview-msg-row right"},pl={class:"preview-avatar user"},ml=["src"],bl={key:1,class:"default-avatar"},_l={class:"settings-item-input"},Cl={class:"label-col"},fl={class:"label-main"},yl={class:"slider-container gray-slider"},kl={class:"slider-value"},wl={class:"form-item-vertical no-border"},Sl={class:"label-main",style:{"margin-bottom":"5px"}},Pl=["placeholder"],xl={class:"settings-section-title"},Il={class:"settings-item-avatar",style:{"border-bottom":"none","margin-bottom":"0"}},Bl={class:"avatar-layout"},Ul={class:"avatar-controls",style:{width:"100%"}},Vl={class:"card"},Tl={key:"videoSettings"},Dl={class:"card-content"},Al={class:"video-settings-container"},Ml={class:"video-setting-col"},$l={class:"settings-item-label center"},Ll=["src"],Rl={key:1,class:"default-avatar bg-placeholder"},zl={class:"video-setting-col"},Nl={class:"settings-item-label center"},Ol=["src"],El={key:1,class:"default-avatar bg-placeholder"},jl={class:"card"},Wl={key:"advancedSettings"},Fl={class:"card-content"},Hl={class:"settings-pure-item"},ql={class:"settings-pure-label"},Gl={class:"settings-pure-value"},Kl={class:"danger-zone"},Zl={class:"danger-btn-content"},Jl={class:"danger-btn-title"},Ql={class:"danger-btn-desc"},Xl={class:"danger-btn-content"},Yl={class:"danger-btn-title"},en={class:"danger-btn-desc"},tn={class:"danger-btn-content"},sn={class:"danger-btn-title"},an={class:"danger-btn-desc"},ln={class:"modal-options centered-text"},nn={class:"option-text"},on={class:"option-text"},cn={class:"option-text"},rn=["placeholder"],dn={__name:"SingleChatSettings",props:{id:{type:String,required:!0}},setup(je){const T=je,{t:s}=Bt(),Ce=Rt(),c=Ut(),r=Vt(),Ue=Tt(),We=Dt(),{sortedWorldBooks:Fe}=Re(We),He=At(),{sortedPresets:qe}=Re(He),Ge=Mt(),{fetchLocationWeather:Ke}=$t(),m=i({roleInfo:!1,userInfo:!1,backgroundActivity:!1,modeSettings:!1,realtimeSense:!1,summarySettings:!1,bubbleSettings:!1,videoSettings:!1,advancedSettings:!1}),D=i(!1),x=i(""),ae=i(""),le=i(""),ne=i(""),C=i("default"),N=i(""),F=i(""),w=i(""),S=i("default"),oe=i(5),ie=i(30),ce=i(10),O=i("always"),re=i(15),E=i(!0),de=i([]),ue=i([]),K=i(""),Z=i(""),J=i(!1),H=i(!1),Q=i(""),X=i(""),fe=i(""),Y=i(""),ee=i(""),ye=i(""),A=i({}),M=i({}),ve=i(20),ge=i(""),te=i(!1),he=i(10),j=i(!1),se=i(!1),pe=i(""),$=i(""),L=i(""),R=i(14),z=i(""),q=i(""),I=i(""),ke=i("default"),Ve=i(0),G=i(!1),we=i(0),me=i(0),f=U(()=>c.getCharacter(T.id)),be=U(()=>{var n;return((n=f.value)==null?void 0:n.name)||s("chat.unknownCharacter")}),_e=U(()=>{var n;return(n=f.value)==null?void 0:n.avatar}),Ze=U(()=>[{value:"new",label:s("chat.singleChat.settings.newUserPersona")},...(c.userPersonas||[]).map(n=>({value:n.id,label:n.name}))]),Je=U(()=>[{value:"default",label:s("chat.singleChat.settings.default")},...Ge.presets.map(n=>({value:n.name,label:n.name}))]),Qe=U(()=>[{value:"",label:s("chat.singleChat.settings.custom")},...(c.bubblePresets||[]).map(n=>({value:n.id,label:n.name}))]),Xe=U(()=>S.value==="on"?!0:S.value==="off"?!1:Ue.globalBackgroundActivity),Te=U(()=>{const n={fontSize:`${R.value}px`};if(!L.value)return n;const t={};return L.value.split(";").forEach(a=>{const g=a.split(":");if(g.length>=2){const b=g[0].trim(),W=g.slice(1).join(":").trim();b&&W&&(t[b]=W)}}),{...n,...t}}),Ye=U(()=>({avatar:s("chat.singleChat.settings.toast.setCharAvatar"),userPersonaAvatar:s("chat.singleChat.settings.toast.setUserAvatar"),chatBg:s("chat.singleChat.settings.toast.setChatBg"),videoBg:s("chat.singleChat.settings.toast.setCharImg"),userVideoImg:s("chat.singleChat.settings.toast.setUserImg")})[x.value]||s("chat.singleChat.settings.toast.upload"));ze(C,n=>{n&&xe(n)}),ze($,n=>{n&&rt(n)}),Lt(()=>{if(!f.value){Se();return}ot()});const B=n=>{m.value[n]=!m.value[n]},Se=()=>{Ce.back()},et=()=>{Ce.push({name:"memory-bank",params:{charId:T.id}})},tt=()=>{x.value="avatar",D.value=!0},st=()=>{x.value="userPersonaAvatar",D.value=!0},at=()=>{x.value="chatBg",D.value=!0},lt=()=>{x.value="videoBg",D.value=!0},nt=()=>{x.value="userVideoImg",D.value=!0},ot=()=>{var $e;const n=f.value;ae.value=n.name,le.value=n.nickname||"",ne.value=n.charPersona||"";const t=c.userPersonas.find(Ie=>Ie.id===n.userPersona);C.value=t?t.id:"new",xe(C.value),S.value=n.backgroundActivityOverride||"default",oe.value=n.proactiveInterval||5,ie.value=n.proactiveCooldown||30,ce.value=n.proactiveDailyLimit||10,O.value=n.triggerMode||"always",re.value=n.proactiveIdleTime||15,E.value=n.isOnline!==!1,de.value=Array.isArray(n.preset)?n.preset:n.preset?[n.preset]:[],ue.value=n.worldbook||[];const[a,g]=(n.replyLength||(E.value?"10-50":"100-200")).split("-");K.value=a||"",Z.value=g||"";const b=n.realtimeSettings||{timeEnabled:!1,weatherEnabled:!1,charLocation:{},userLocation:{}};J.value=b.timeEnabled,H.value=b.weatherEnabled,A.value=b.charLocation||{},M.value=b.userLocation||{},Q.value=A.value.real||"",X.value=A.value.virtual||"",fe.value=A.value.shortDisplay||"",Y.value=M.value.real||"",ee.value=M.value.virtual||"",ye.value=M.value.shortDisplay||"",ve.value=n.summaryRange||20,ge.value=n.summaryPrompt||"",te.value=n.autoSummary||!1,he.value=n.memoryCount||10;const W=n.bubbleSettings||{};L.value=W.css||"",R.value=W.fontSize||14,z.value=n.chatBackground||"",q.value=n.videoBg||"",I.value=n.userVideoImg||"",ke.value=n.api||"default",Ve.value=(($e=n.npc)==null?void 0:$e.length)||0,G.value=n.isBlocked||!1;const Me=c.messages[T.id]||[];me.value=Me.length,we.value=Math.ceil(Me.reduce((Ie,xt)=>{var Le;return Ie+(((Le=xt.content)==null?void 0:Le.length)||0)},0)*1.5)},Pe=()=>{const n=f.value;if(!n)return;const t=C.value;let a=c.userPersonas.find(g=>g.id===t);t==="default"&&(a||(a={id:"default",name:s("chat.singleChat.settings.defaultUserPersona"),avatar:"",description:"",videoImg:""},c.userPersonas.unshift(a))),a&&(a.id!=="default"&&N.value.trim()&&(a.name=N.value.trim()),a.description=F.value,a.avatar=w.value,a.videoImg=I.value),A.value.real=Q.value,A.value.virtual=X.value,M.value.real=Y.value,M.value.virtual=ee.value,Object.assign(n,{name:ae.value.trim()||n.name,nickname:le.value.trim(),charPersona:ne.value,userPersona:C.value,backgroundActivityOverride:S.value,proactiveInterval:oe.value,proactiveCooldown:ie.value,proactiveDailyLimit:ce.value,triggerMode:O.value,proactiveIdleTime:re.value,isOnline:E.value,preset:de.value,worldbook:ue.value,replyLength:`${K.value}-${Z.value}`,realtimeSettings:{timeEnabled:J.value,weatherEnabled:H.value,charLocation:A.value,userLocation:M.value},summaryRange:ve.value,summaryPrompt:ge.value,autoSummary:te.value,memoryCount:he.value,bubbleSettings:{css:L.value,fontSize:R.value},chatBackground:z.value,videoBg:q.value,isBlocked:G.value}),c.saveData(),r.showToast(s("theme.toast.saveSuccess"))},xe=n=>{if(n==="new"){N.value="",F.value="",w.value="",I.value="";return}let t=c.userPersonas.find(a=>a.id===n);t?(N.value=t.name,F.value=t.description||"",w.value=t.avatar||"",I.value=t.videoImg||""):C.value!=="new"&&(C.value="new")},it=()=>{const n=N.value.trim();if(!n)return r.showToast(s("chat.singleChat.settings.toast.personaNameRequired"),"error");const t=C.value==="new",a={id:t?Date.now().toString():C.value,name:n,description:F.value,avatar:w.value,videoImg:I.value,isDefault:c.userPersonas.length===0};if(t)c.userPersonas.push(a),C.value=a.id,r.showToast(s("chat.singleChat.settings.toast.personaSaved"));else{const g=c.userPersonas.findIndex(b=>b.id===C.value);g!==-1&&(a.isDefault=c.userPersonas[g].isDefault,c.userPersonas[g]=a,r.showToast(s("chat.singleChat.settings.toast.personaUpdated")))}c.saveData()},ct=()=>{C.value!=="new"&&r.showConfirm(s("chat.singleChat.settings.toast.deletePersona"),s("chat.singleChat.settings.toast.confirmDeletePersona"),()=>{c.userPersonas=c.userPersonas.filter(n=>n.id!==C.value),c.characters.forEach(n=>{n.userPersona===C.value&&(n.userPersona="")}),C.value="new",xe("new"),c.saveData()})},rt=n=>{if(!n)return;const t=c.bubblePresets.find(a=>a.id===n);t&&(L.value=t.css,R.value=t.fontSize)},dt=()=>{const n=prompt(s("chat.singleChat.settings.toast.presetNameRequired"));if(!n)return;const t={id:Date.now().toString(),name:n,css:L.value,fontSize:R.value};c.bubblePresets.push(t),c.saveData(),$.value=t.id,r.showToast(s("chat.singleChat.settings.toast.presetSaved"))},ut=()=>{$.value&&r.showConfirm(s("chat.singleChat.settings.toast.deleteBubblePreset"),s("chat.singleChat.settings.toast.confirmDeleteBubblePreset"),()=>{c.bubblePresets=c.bubblePresets.filter(n=>n.id!==$.value),c.saveData(),$.value="",r.showToast(s("chat.singleChat.settings.toast.presetDeleted"))})},vt=n=>{const t=n.content;switch(x.value){case"avatar":f.value&&(f.value.avatar=t);break;case"userPersonaAvatar":w.value=t;break;case"chatBg":z.value=t;break;case"videoBg":q.value=t;break;case"userVideoImg":I.value=t;break}},gt=n=>{const t=n.content,a=x.value,g={avatar:{obj:f.value,key:"avatar",toast:s("chat.singleChat.settings.toast.avatarUpdated")},chatBg:{obj:f.value,key:"chatBackground",toast:s("chat.singleChat.settings.toast.backgroundUpdated"),localRef:z},videoBg:{obj:f.value,key:"videoBg",toast:s("chat.singleChat.settings.toast.charImageUpdated"),localRef:q},userPersonaAvatar:{obj:null,key:"userPersonaAvatar",toast:s("chat.singleChat.settings.toast.avatarUpdated")},userVideoImg:{obj:null,key:"userVideoImg",toast:s("chat.singleChat.settings.toast.userImageUpdated")}};if(g[a]){const b=g[a];b.obj?(b.obj[b.key]=t,b.localRef&&(b.localRef.value=t)):(a==="userPersonaAvatar"&&(w.value=t),a==="userVideoImg"&&(I.value=t)),c.saveData(),r.showToast(b.toast)}D.value=!1},ht=()=>{if(!z.value)return r.showToast(s("chat.singleChat.settings.toast.noBgToApply"));r.showConfirm(s("chat.singleChat.settings.toast.applyBgToAll"),s("chat.singleChat.settings.toast.confirmApplyBgToAll"),()=>{c.applyChatBackgroundToAll(z.value),r.showToast(s("chat.singleChat.settings.toast.appliedToAll"))})},pt=()=>{if(!z.value){r.showToast("当前没有聊天背景");return}r.showConfirm("清除背景","你确定要清除当前背景吗？",()=>{z.value="",f.value&&(f.value.chatBackground="",c.saveData(),r.showToast("背景已清除"))})},De=n=>{E.value=n,[K.value,Z.value]=n?["10","50"]:["100","200"],f.value&&(f.value.isOnline=n,c.saveData(),r.showToast(`${s(n?"chat.singleChat.settings.online":"chat.singleChat.settings.offline")}模式已开启`,"success"))},mt=()=>{j.value=!0},bt=()=>{j.value=!1,se.value=!0},_t=async()=>{j.value=!1;const n=await c.summarizeMessages(T.id,{type:"recent"});r.showToast(n.message,n.success?"success":"error")},Ct=async()=>{const[n,t]=pe.value.split("-").map(W=>W.trim()),a=parseInt(n,10),g=parseInt(t,10);if(isNaN(a)||isNaN(g)||a<=0||g<=0||a>g){r.showToast(s("chat.singleChat.settings.toast.invalidRange"),"error");return}const b=await c.summarizeMessages(T.id,{type:"range",start:a,end:g});r.showToast(b.message,b.success?"success":"error"),b.success&&(se.value=!1,pe.value="")},ft=async()=>{j.value=!1;const n=await c.summarizeMessages(T.id,{type:"video"});r.showToast(n.message,n.success?"success":"error")},Ae=async n=>{const t=n==="char"?Q.value:Y.value,a=n==="char"?X.value:ee.value,g=await Ke(t,a);g&&(n==="char"?(A.value=g,fe.value=g.shortDisplay):(M.value=g,ye.value=g.shortDisplay),r.showToast("位置和天气信息已更新","success"))},yt=()=>{r.showConfirm(s("chat.singleChat.settings.confirmBlockTitle",{name:be.value}),s("chat.singleChat.settings.confirmBlockMsg",{name:be.value}),()=>{G.value=!0,Pe(),r.showToast(s("chat.singleChat.settings.toast.blocked"))},{messageStyle:{color:"#FF3B30",whiteSpace:"pre-wrap"},confirmText:"chat.singleChat.settings.block"})},kt=()=>{G.value=!1,Pe(),r.showToast(s("chat.singleChat.settings.toast.unblocked"))},wt=()=>{r.showConfirm(s("chat.singleChat.settings.confirmClearTitle"),s("chat.singleChat.settings.confirmClearMsg",{name:be.value}),()=>{c.clearChatHistory(T.id),r.showToast(s("chat.singleChat.settings.toast.historyCleared")),me.value=0,we.value=0},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"chat.singleChat.settings.clear"})},St=()=>{G.value?kt():yt()},Pt=()=>{r.showConfirm(s("chat.deleteCharacterTitle"),s("chat.deleteCharacterConfirm",{name:be.value}),()=>{c.deleteCharacter(T.id),r.showToast(s("chat.toast.deleteSuccess"),"success"),Se(),Ce.push({name:"chat-list"})},{messageStyle:{whiteSpace:"pre-wrap",color:"#FF3B30"},confirmText:"delete"})};return(n,t)=>(v(),u("div",Nt,[e("div",Ot,[e("div",{class:"back-btn",onClick:Se},[...t[52]||(t[52]=[e("svg",{class:"svg-icon",viewBox:"0 0 24 24"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])]),e("div",Et,o(l(s)("chat.singleChat.settings.title")),1),e("div",jt,[e("button",{class:"header-save-btn",onClick:Pe},o(l(s)("save")),1)])]),e("div",Wt,[e("div",Ft,[e("div",{class:"card-title",onClick:t[0]||(t[0]=a=>B("roleInfo"))},[e("span",null,o(l(s)("chat.singleChat.settings.roleInfo")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.roleInfo}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.roleInfo?k("",!0):(v(),u("div",Ht,[e("div",qt,[e("div",Gt,[e("div",{class:"role-avatar-wrapper",onClick:tt},[_e.value?(v(),u("img",{key:0,src:_e.value,alt:"头像",class:"role-avatar-img"},null,8,Kt)):(v(),u("div",Zt,o(l(s)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",Jt,[h(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>ae.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.roleNamePlaceholder")},null,8,Qt),[[p,ae.value]]),h(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>le.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.roleNicknamePlaceholder")},null,8,Xt),[[p,le.value]])])]),e("div",Yt,[e("div",es,o(l(s)("chat.singleChat.settings.rolePersona")),1),h(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>ne.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.rolePersonaPlaceholder")},null,8,ts),[[p,ne.value]])])])]))]),_:1})]),e("div",ss,[e("div",{class:"card-title",onClick:t[4]||(t[4]=a=>B("userInfo"))},[e("span",null,o(l(s)("chat.singleChat.settings.userInfo")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.userInfo}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.userInfo?k("",!0):(v(),u("div",as,[e("div",ls,[e("div",ns,[e("div",os,o(l(s)("chat.singleChat.settings.currentUserPersona")),1),d(Be,{options:Ze.value,modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=a=>C.value=a)},null,8,["options","modelValue"])]),e("div",is,[e("div",{class:"user-avatar-wrapper",onClick:st},[w.value?(v(),u("img",{key:0,src:w.value,alt:"User",class:"role-avatar-img"},null,8,cs)):(v(),u("div",rs,o(l(s)("chat.singleChat.settings.uploadAvatar")),1))]),e("div",ds,[e("div",us,[e("button",{class:"btn btn-secondary btn-mini-grow",onClick:it},o(l(s)("chat.singleChat.settings.savePersona")),1),e("button",{class:"btn btn-danger btn-mini-grow",onClick:ct},o(l(s)("chat.singleChat.settings.deletePersona")),1)]),h(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>N.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.userNamePlaceholder")},null,8,vs),[[p,N.value]])])]),e("div",gs,[e("div",hs,o(l(s)("chat.singleChat.settings.userPersona")),1),h(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>F.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.userPersonaPlaceholder")},null,8,ps),[[p,F.value]])])])]))]),_:1})]),e("div",ms,[e("div",{class:"card-title",onClick:t[8]||(t[8]=a=>B("backgroundActivity"))},[e("span",null,o(l(s)("chat.singleChat.settings.backgroundActivity")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.backgroundActivity}])},[d(V,{name:"chevron-down"})],2)]),e("div",bs,o(l(s)("chat.singleChat.settings.backgroundActivityWarning")),1),d(P,{name:"collapse"},{default:y(()=>[m.value.backgroundActivity?k("",!0):(v(),u("div",_s,[e("div",Cs,[e("div",fs,[e("div",ys,[e("div",ks,o(l(s)("chat.singleChat.settings.globalSettings")),1)]),e("div",ws,o(l(Ue).globalBackgroundActivity?l(s)("chat.singleChat.settings.globalOn"):l(s)("chat.singleChat.settings.globalOff")),1)]),e("div",Ss,[e("div",Ps,[e("div",xs,o(l(s)("chat.singleChat.settings.overrideGlobal")),1),e("div",Is,o(l(s)("chat.singleChat.settings.overrideGlobalDesc")),1)]),e("div",Bs,[e("div",{class:_(["mode-option",{active:S.value==="default"}]),onClick:t[9]||(t[9]=a=>S.value="default")},o(l(s)("chat.singleChat.settings.default")),3),e("div",{class:_(["mode-option",{active:S.value==="on"}]),onClick:t[10]||(t[10]=a=>S.value="on")},o(l(s)("chat.singleChat.settings.on")),3),e("div",{class:_(["mode-option",{active:S.value==="off"}]),onClick:t[11]||(t[11]=a=>S.value="off")},o(l(s)("chat.singleChat.settings.off")),3)])]),Xe.value?(v(),u("div",Us,[e("div",Vs,[e("div",Ts,[e("div",Ds,o(l(s)("chat.singleChat.settings.interval")),1),e("div",As,o(l(s)("chat.singleChat.settings.intervalDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=a=>oe.value=a),class:"base-input base-input-short",placeholder:"5"},null,512),[[p,oe.value,void 0,{number:!0}]])]),e("div",Ms,[e("div",$s,[e("div",Ls,o(l(s)("chat.singleChat.settings.cooldown")),1),e("div",Rs,o(l(s)("chat.singleChat.settings.cooldownDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=a=>ie.value=a),class:"base-input base-input-short",placeholder:"30"},null,512),[[p,ie.value,void 0,{number:!0}]])]),e("div",zs,[e("div",Ns,[e("div",Os,o(l(s)("chat.singleChat.settings.dailyLimit")),1),e("div",Es,o(l(s)("chat.singleChat.settings.dailyLimitDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=a=>ce.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[p,ce.value,void 0,{number:!0}]])]),e("div",js,[e("div",Ws,[e("div",Fs,o(l(s)("chat.singleChat.settings.triggerMode")),1),e("div",Hs,o(l(s)("chat.singleChat.settings.triggerModeDesc")),1)]),e("div",qs,[e("div",{class:_(["mode-option",{active:O.value==="idle"}]),onClick:t[15]||(t[15]=a=>O.value="idle")},o(l(s)("chat.singleChat.settings.idleMode")),3),e("div",{class:_(["mode-option",{active:O.value==="always"}]),onClick:t[16]||(t[16]=a=>O.value="always")},o(l(s)("chat.singleChat.settings.alwaysMode")),3)])]),O.value==="idle"?(v(),u("div",Gs,[e("div",Ks,[e("div",Zs,o(l(s)("chat.singleChat.settings.idleTime")),1),e("div",Js,o(l(s)("chat.singleChat.settings.idleTimeDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[17]||(t[17]=a=>re.value=a),class:"base-input base-input-short",placeholder:"15"},null,512),[[p,re.value,void 0,{number:!0}]])])):k("",!0)])):k("",!0)])]))]),_:1})]),e("div",Qs,[e("div",{class:"card-title",onClick:t[18]||(t[18]=a=>B("modeSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.mode")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.modeSettings}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.modeSettings?k("",!0):(v(),u("div",Xs,[e("div",Ys,[e("div",ea,[e("div",ta,o(l(s)("chat.singleChat.settings.modeSelect")),1),e("div",sa,[e("div",{class:_(["mode-option",{active:E.value}]),onClick:t[19]||(t[19]=a=>De(!0))},o(l(s)("chat.singleChat.settings.online")),3),e("div",{class:_(["mode-option",{active:!E.value}]),onClick:t[20]||(t[20]=a=>De(!1))},o(l(s)("chat.singleChat.settings.offline")),3)])]),E.value?k("",!0):(v(),u("div",aa,[e("div",la,o(l(s)("chat.singleChat.settings.linkPreset")),1),d(Ee,{modelValue:de.value,"onUpdate:modelValue":t[21]||(t[21]=a=>de.value=a),options:l(qe),labelKey:"title",valueKey:"id",childrenKey:"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])])),e("div",na,[e("div",oa,o(l(s)("chat.singleChat.settings.linkWorldbook")),1),d(Ee,{modelValue:ue.value,"onUpdate:modelValue":t[22]||(t[22]=a=>ue.value=a),options:l(Fe),"label-key":"title","value-key":"id","children-key":"entries",textAlign:"right",selectorWidth:"auto",dropdownWidth:"200px"},null,8,["modelValue","options"])]),e("div",ia,[e("div",ca,[e("div",ra,o(l(s)("chat.singleChat.settings.replyLength")),1),e("div",da,o(l(s)("chat.singleChat.settings.replyLengthDesc")),1)]),e("div",ua,[h(e("input",{type:"number","onUpdate:modelValue":t[23]||(t[23]=a=>K.value=a),class:"base-input base-input-mini",placeholder:l(s)("chat.singleChat.settings.min")},null,8,va),[[p,K.value]]),t[53]||(t[53]=e("span",null,"-",-1)),h(e("input",{type:"number","onUpdate:modelValue":t[24]||(t[24]=a=>Z.value=a),class:"base-input base-input-mini",placeholder:l(s)("chat.singleChat.settings.max")},null,8,ga),[[p,Z.value]])])])])]))]),_:1})]),e("div",ha,[e("div",{class:"card-title",onClick:t[25]||(t[25]=a=>B("realtimeSense"))},[t[54]||(t[54]=e("span",null,"实时感知",-1)),e("div",{class:_(["collapse-arrow",{collapsed:m.value.realtimeSense}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.realtimeSense?k("",!0):(v(),u("div",pa,[e("div",ma,[e("div",ba,[t[55]||(t[55]=e("div",{class:"label-col"},[e("div",{class:"label-main"},"实时时间")],-1)),e("div",{class:_(["toggle-switch",{active:J.value}]),onClick:t[26]||(t[26]=a=>J.value=!J.value)},null,2)]),e("div",_a,[t[56]||(t[56]=e("div",{class:"label-col"},[e("div",{class:"label-main"},"实时天气")],-1)),e("div",{class:_(["toggle-switch",{active:H.value}]),onClick:t[27]||(t[27]=a=>H.value=!H.value)},null,2)]),d(P,{name:"collapse"},{default:y(()=>[H.value?(v(),u("div",Ca,[e("div",fa,[t[57]||(t[57]=e("div",{class:"label-main",style:{"margin-bottom":"5px"}},"角色所在地",-1)),e("div",ya,[h(e("input",{type:"text","onUpdate:modelValue":t[28]||(t[28]=a=>Q.value=a),class:"base-input",placeholder:"真实地名"},null,512),[[p,Q.value]]),h(e("input",{type:"text","onUpdate:modelValue":t[29]||(t[29]=a=>X.value=a),class:"base-input",placeholder:"虚拟地名 (可选)"},null,512),[[p,X.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:t[30]||(t[30]=a=>Ae("char"))},"确定")]),e("div",ka,o(fe.value),1)]),e("div",wa,[t[58]||(t[58]=e("div",{class:"label-main",style:{"margin-bottom":"5px"}},"用户所在地",-1)),e("div",Sa,[h(e("input",{type:"text","onUpdate:modelValue":t[31]||(t[31]=a=>Y.value=a),class:"base-input",placeholder:"真实地名"},null,512),[[p,Y.value]]),h(e("input",{type:"text","onUpdate:modelValue":t[32]||(t[32]=a=>ee.value=a),class:"base-input",placeholder:"虚拟地名 (可选)"},null,512),[[p,ee.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:t[33]||(t[33]=a=>Ae("user"))},"确定")]),e("div",Pa,o(ye.value),1)])])):k("",!0)]),_:1})])]))]),_:1})]),e("div",xa,[e("div",{class:"card-title",onClick:t[34]||(t[34]=a=>B("summarySettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.summary")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.summarySettings}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.summarySettings?k("",!0):(v(),u("div",Ia,[e("div",Ba,[e("div",Ua,[e("div",Va,[e("div",Ta,o(l(s)("chat.singleChat.settings.summaryRange")),1),e("div",Da,o(l(s)("chat.singleChat.settings.summaryRangeDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[35]||(t[35]=a=>ve.value=a),class:"base-input base-input-short",placeholder:"20"},null,512),[[p,ve.value,void 0,{number:!0}]])]),e("div",Aa,[e("div",Ma,o(l(s)("chat.singleChat.settings.summaryPrompt")),1),h(e("textarea",{"onUpdate:modelValue":t[36]||(t[36]=a=>ge.value=a),class:"base-input",style:{height:"80px","min-height":"40px"},placeholder:l(s)("chat.singleChat.settings.summaryPromptPlaceholder")},null,8,$a),[[p,ge.value]])]),e("div",La,[e("div",Ra,[e("div",za,o(l(s)("chat.singleChat.settings.autoSummary")),1),e("div",Na,o(l(s)("chat.singleChat.settings.autoSummaryDesc")),1)]),e("div",{class:_(["toggle-switch",{active:te.value}]),onClick:t[37]||(t[37]=a=>te.value=!te.value)},null,2)]),e("div",Oa,[e("button",{class:"btn btn-secondary",onClick:mt},o(l(s)("chat.singleChat.settings.manualSummary")),1),e("button",{class:"btn btn-secondary",onClick:et},o(l(s)("chat.singleChat.settings.viewSummary")),1)]),e("div",Ea,[e("div",ja,[e("div",Wa,o(l(s)("chat.singleChat.settings.contextMemory")),1),e("div",Fa,o(l(s)("chat.singleChat.settings.contextMemoryDesc")),1)]),h(e("input",{type:"number","onUpdate:modelValue":t[38]||(t[38]=a=>he.value=a),class:"base-input base-input-short",placeholder:"10"},null,512),[[p,he.value,void 0,{number:!0}]])]),e("div",Ha,[e("div",qa,o(l(s)("chat.singleChat.settings.apiConfig")),1),d(Be,{options:Je.value,modelValue:ke.value,"onUpdate:modelValue":t[39]||(t[39]=a=>ke.value=a)},null,8,["options","modelValue"])]),e("div",Ga,[e("div",Ka,o(l(s)("chat.singleChat.settings.tokenCount")),1),e("div",Za,o(we.value),1)]),e("div",Ja,[e("div",Qa,o(l(s)("chat.singleChat.settings.msgCount")),1),e("div",Xa,o(me.value),1)])])]))]),_:1})]),e("div",Ya,[e("div",{class:"card-title",onClick:t[40]||(t[40]=a=>B("bubbleSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.beautification")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.bubbleSettings}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.bubbleSettings?k("",!0):(v(),u("div",el,[e("div",tl,[e("div",sl,o(l(s)("chat.singleChat.settings.bubble")),1),e("div",al,[e("div",ll,o(l(s)("chat.singleChat.settings.bubblePreset")),1),e("div",nl,[d(Be,{options:Qe.value,modelValue:$.value,"onUpdate:modelValue":t[41]||(t[41]=a=>$.value=a)},null,8,["options","modelValue"])]),e("div",ol,[e("button",{class:"btn btn-secondary btn-mini",onClick:dt},o(l(s)("save")),1),e("button",{class:"btn btn-danger btn-mini",disabled:!$.value,onClick:ut},o(l(s)("delete")),9,il)])]),e("div",cl,[e("div",rl,[e("div",dl,[e("div",ul,[_e.value?(v(),u("img",{key:0,src:_e.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,vl)):(v(),u("div",gl))]),e("div",{class:"preview-bubble char",style:Oe(Te.value)},o(l(s)("chat.singleChat.settings.bubblePreview")),5)]),e("div",hl,[e("div",{class:"preview-bubble user",style:Oe(Te.value)},o(l(s)("chat.singleChat.settings.bubblePreview")),5),e("div",pl,[w.value?(v(),u("img",{key:0,src:w.value,style:{width:"100%",height:"100%","object-fit":"cover"}},null,8,ml)):(v(),u("div",bl))])])])]),e("div",_l,[e("div",Cl,[e("div",fl,o(l(s)("chat.singleChat.settings.fontSize")),1)]),e("div",yl,[h(e("input",{type:"range","onUpdate:modelValue":t[42]||(t[42]=a=>R.value=a),min:"10",max:"30",step:"1"},null,512),[[p,R.value,void 0,{number:!0}]]),e("span",kl,o(R.value),1)])]),e("div",wl,[e("div",Sl,o(l(s)("chat.singleChat.settings.bubbleCss")),1),h(e("textarea",{"onUpdate:modelValue":t[43]||(t[43]=a=>L.value=a),class:"base-input",placeholder:l(s)("chat.singleChat.settings.cssPlaceholder"),style:{"font-family":"monospace",height:"120px"}},null,8,Pl),[[p,L.value]])]),t[59]||(t[59]=e("div",{class:"settings-divider"},null,-1)),e("div",xl,o(l(s)("chat.singleChat.settings.chatBackground")),1),e("div",Il,[e("div",Bl,[e("div",Ul,[e("button",{class:"btn btn-secondary",onClick:at},o(l(s)("chat.singleChat.settings.setChatBackground")),1),e("button",{class:"btn btn-secondary",onClick:ht,style:{"margin-top":"5px"}},o(l(s)("chat.singleChat.settings.applyToAll")),1),e("button",{class:"btn btn-danger",onClick:pt,style:{"margin-top":"5px"}},"清除当前背景")])])])])]))]),_:1})]),e("div",Vl,[e("div",{class:"card-title",onClick:t[44]||(t[44]=a=>B("videoSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.videoCall")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.videoSettings}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.videoSettings?k("",!0):(v(),u("div",Tl,[e("div",Dl,[e("div",Al,[e("div",Ml,[e("div",$l,o(l(s)("chat.singleChat.settings.characterImage")),1),e("div",{class:"video-preview",onClick:lt},[q.value?(v(),u("img",{key:0,src:q.value,class:"bg-img"},null,8,Ll)):(v(),u("div",Rl,o(l(s)("chat.singleChat.settings.setImage")),1))])]),e("div",zl,[e("div",Nl,o(l(s)("chat.singleChat.settings.userImage")),1),e("div",{class:"video-preview",onClick:nt},[I.value?(v(),u("img",{key:0,src:I.value,class:"bg-img"},null,8,Ol)):(v(),u("div",El,o(l(s)("chat.singleChat.settings.setImage")),1))])])])])]))]),_:1})]),e("div",jl,[e("div",{class:"card-title",onClick:t[45]||(t[45]=a=>B("advancedSettings"))},[e("span",null,o(l(s)("chat.singleChat.settings.advanced")),1),e("div",{class:_(["collapse-arrow",{collapsed:m.value.advancedSettings}])},[d(V,{name:"chevron-down"})],2)]),d(P,{name:"collapse"},{default:y(()=>[m.value.advancedSettings?k("",!0):(v(),u("div",Wl,[e("div",Fl,[e("div",Hl,[e("div",ql,o(l(s)("chat.singleChat.settings.linkedNpc")),1),e("div",Gl,o(l(s)("chat.singleChat.settings.npcCount",{count:Ve.value})),1),t[60]||(t[60]=e("div",{class:"settings-pure-arrow"},"›",-1))])])]))]),_:1})]),e("div",Kl,[e("button",{class:"btn btn-danger big-btn",onClick:St},[e("div",Zl,[e("div",Jl,o(G.value?l(s)("chat.singleChat.settings.unblock"):l(s)("chat.singleChat.settings.blockCharacter")),1),e("div",Ql,o(l(s)("chat.singleChat.settings.blockCharacterDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:wt},[e("div",Xl,[e("div",Yl,o(l(s)("chat.singleChat.settings.clearHistory")),1),e("div",en,o(l(s)("chat.singleChat.settings.clearHistoryDesc")),1)])]),e("button",{class:"btn btn-danger big-btn",onClick:Pt},[e("div",tn,[e("div",sn,o(l(s)("chat.deleteCharacterTitle")),1),e("div",an,o(l(s)("chat.deleteCharacterWarning")),1)])])])]),d(zt,{visible:D.value,"onUpdate:visible":t[46]||(t[46]=a=>D.value=a),type:"basic","biz-type":x.value,title:Ye.value,onPreviewReady:vt,onUploadComplete:gt},null,8,["visible","biz-type","title"]),d(Ne,{visible:j.value,"onUpdate:visible":t[48]||(t[48]=a=>j.value=a),title:l(s)("chat.singleChat.settings.manualSummary")},{footer:y(()=>[e("button",{class:"modal-btn cancel",onClick:t[47]||(t[47]=a=>j.value=!1)},o(l(s)("cancel")),1)]),default:y(()=>[e("div",ln,[e("div",{class:"modal-option",onClick:_t},[e("span",nn,o(l(s)("chat.singleChat.settings.summarizeRecent")),1)]),e("div",{class:"modal-option",onClick:bt},[e("span",on,o(l(s)("chat.singleChat.settings.summarizeRange")),1)]),e("div",{class:"modal-option",onClick:ft},[e("span",cn,o(l(s)("chat.singleChat.settings.summarizeVideo")),1)])])]),_:1},8,["visible","title"]),d(Ne,{visible:se.value,"onUpdate:visible":t[51]||(t[51]=a=>se.value=a),title:l(s)("chat.singleChat.settings.summarizeRange")},{footer:y(()=>[e("button",{class:"modal-btn cancel",onClick:t[50]||(t[50]=a=>se.value=!1)},o(l(s)("cancel")),1),e("button",{class:"modal-btn confirm",onClick:Ct},o(l(s)("confirm")),1)]),default:y(()=>[h(e("input",{type:"text",class:"base-input","onUpdate:modelValue":t[49]||(t[49]=a=>pe.value=a),placeholder:l(s)("chat.singleChat.settings.rangePlaceholder",{total:me.value})},null,8,rn),[[p,pe.value]])]),_:1},8,["visible","title"])]))}},hn=It(dn,[["__scopeId","data-v-4457e0d8"]]);export{hn as default};
