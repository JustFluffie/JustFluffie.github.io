import{cf as ve,r as h,cg as W,_ as be,q as he,V as me,Y as ge,t as fe,x as ke,H as we,y as _e,c as L,z as F,l as ye,h as M,j as s,a6 as xe,o as k,d as e,f as K,B as i,w as I,A as H,b as x,e as B,F as z,C as Y,c2 as Pe,n as $,M as Z,ch as Ce}from"./index-D032-4FX.js";import{C as Q}from"./CustomSelect-DFC_F-mw.js";const Se=ve("backup",()=>{const S=h(""),o=h(""),u=h(!1),g=h(!1),v=h(null);function E(l={chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0,presets:!0}){return new Promise(r=>{setTimeout(()=>{const b={},m=localStorage.getItem("aiPhoneSingleChatData");if(m)try{const c=W.decompressFromUTF16(m),n=JSON.parse(c||m),d={};let f=!1;if(l.chat&&(d.messages=n.messages,f=!0),l.characters&&(d.characters=n.characters,d.userPersonas=n.userPersonas,d.favorites=n.favorites,f=!0),l.appearance&&(d.bubblePresets=n.bubblePresets,d.stickers=n.stickers,f=!0),f){const w=JSON.stringify(d),U=W.compressToUTF16(w);b.aiPhoneSingleChatData=U}}catch(c){console.error("Error processing single chat data for backup",c)}if(l.chat){const c=localStorage.getItem("aiPhoneMomentsData");c&&(b.aiPhoneMomentsData=c)}l.settings&&["api_imageHostProvider","api_imgbbApiKey","api_catboxUserHash","aiPhoneGlobalBackgroundActivity","aiPhoneGlobalProactiveScope","aiPhoneGlobalProactiveInterval","aiPhoneGlobalProactiveCooldown","aiPhoneGlobalProactiveDailyLimit","aiPhoneGlobalTriggerMode","aiPhoneGlobalProactiveIdleTime"].forEach(n=>{const d=localStorage.getItem(n);d!==null&&(b[n]=d)}),l.appearance&&["aiPhoneThemePresets","aiPhoneCurrentThemePreset","aiPhoneFontPresets","aiPhoneCurrentFontPreset","aiPhoneCssPresets","aiPhoneCurrentCssPreset"].forEach(n=>{const d=localStorage.getItem(n);d!==null&&(b[n]=d)}),l.worldbook&&["worldBooks","worldBookNextId"].forEach(n=>{const d=localStorage.getItem(n);d!==null&&(b[n]=d)}),l.presets&&["api_presets","api_activePresetName"].forEach(n=>{const d=localStorage.getItem(n);d!==null&&(b[n]=d)}),r(JSON.stringify(b,null,2))},0)})}async function T(){if(S.value=localStorage.getItem("github_token")||"",!S.value){alert("请先设置 GitHub Token！");return}try{const l=await fetch("https://api.github.com/user/repos",{method:"POST",headers:{Authorization:`token ${S.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({name:"phone-backup",private:!0,description:"Backup for Phone Vue App"})});if(l.ok){const r=await l.json();o.value=r.full_name,alert(`仓库 ${r.full_name} 创建成功！即将开始备份...`),await P()}else{if(l.status===401){alert("创建仓库失败: GitHub Token 无效或过期 (401)。请检查设置。");return}const r=await l.json();if(r.errors&&r.errors[0].message==="name already exists on this account"){const b=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${S.value}`}});if(b.ok){const m=await b.json();o.value=`${m.login}/phone-backup`,alert(`仓库已存在，已自动关联到 ${o.value}。即将开始备份...`),await P();return}}alert(`创建仓库失败: ${r.message}`)}}catch(l){console.error("Create repo failed:",l),alert(`创建仓库出错: ${l.message}`)}}async function P(){if(S.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!S.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(u.value){alert("正在备份中，请稍候...");return}u.value=!0,alert("正在准备备份数据...");try{const l=await E();alert("数据准备完成，开始上传...");const r="phone_backup.json",[b,m]=o.value.split("/"),c=`https://api.github.com/repos/${b}/${m}/contents/${r}`;let n;try{const C=await fetch(c,{headers:{Authorization:`token ${S.value}`,Accept:"application/vnd.github.v3+json"}});if(C.status===401)throw new Error("GitHub Token 无效或过期 (401)。请检查设置。");C.status===404?console.log("备份文件不存在，将创建新文件。"):C.ok&&(n=(await C.json()).sha)}catch(C){if(C.message.includes("GitHub Token"))throw C}const d=`Backup from phone-vue-app: ${new Date().toISOString()}`,w=new TextEncoder().encode(l),U=Array.from(w).map(C=>String.fromCharCode(C)).join(""),D=btoa(U),A={message:d,content:D,sha:n},_=await fetch(c,{method:"PUT",headers:{Authorization:`token ${S.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(A)});if(_.ok)v.value=new Date,alert("备份成功！");else{if(_.status===401){alert("备份失败: GitHub Token 无效或过期 (401)。请检查设置。");return}const C=await _.json();console.error("GitHub API Error:",C),alert(`备份失败: ${C.message||"未知错误"}`)}}catch(l){console.error("Backup to GitHub failed:",l),alert(`备份过程中发生错误: ${l.message}`)}finally{u.value=!1}}async function N(){if(S.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!S.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(confirm("这将从 GitHub 覆盖所有当前数据，确定要恢复吗？此操作不可逆。")){g.value=!0,alert("正在从 GitHub 下载备份...");try{const l="phone_backup.json",[r,b]=o.value.split("/"),m=`https://api.github.com/repos/${r}/${b}/contents/${l}`,c=await fetch(m,{headers:{Authorization:`token ${S.value}`,Accept:"application/vnd.github.v3+json"}});if(c.status===401)throw new Error("GitHub Token 无效或过期 (401)。请检查设置。");if(c.status===404)throw new Error("在仓库中未找到备份文件 (phone_backup.json)。");if(!c.ok){const _=await c.json();throw new Error(`获取备份文件失败: ${_.message||"未知错误"}`)}const d=(await c.json()).content,f=atob(d),w=new Uint8Array(f.length);for(let _=0;_<f.length;_++)w[_]=f.charCodeAt(_);const D=new TextDecoder("utf-8").decode(w),A=JSON.parse(D);localStorage.clear();for(const _ in A)Object.hasOwnProperty.call(A,_)&&localStorage.setItem(_,A[_]);alert("数据恢复成功！请刷新页面以应用更改。")}catch(l){console.error("Restore from GitHub failed:",l),alert(`恢复过程中发生错误: ${l.message}`)}finally{g.value=!1}}}async function j(l){try{alert("正在生成备份文件...");const r=await E(l),b=new Blob([r],{type:"application/json"}),m=URL.createObjectURL(b),c=document.createElement("a");c.href=m,c.download=`JF-Phone_backup_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(m),alert("备份文件已开始下载！")}catch(r){console.error("Export backup failed:",r),alert(`导出备份文件时出错: ${r.message}`)}}function G(){const l=document.createElement("input");l.type="file",l.accept="application/json",l.onchange=r=>{const b=r.target.files[0];if(!b)return;const m=new FileReader;m.onload=c=>{try{const n=JSON.parse(c.target.result);if(confirm("这将覆盖所有当前数据，确定要导入吗？")){localStorage.clear();for(const d in n)Object.hasOwnProperty.call(n,d)&&localStorage.setItem(d,n[d]);alert("数据导入成功！请刷新页面以应用更改。")}}catch(n){console.error("Import backup failed:",n),alert(`导入失败，请确保文件格式正确: ${n.message}`)}},m.readAsText(b)},l.click()}return{githubToken:S,githubRepo:o,isBackingUp:u,isRestoring:g,lastBackupTime:v,backupToGitHub:P,restoreFromGitHub:N,exportBackupFile:j,importBackupFile:G,createBackupRepo:T}}),Te={class:"card"},Be={class:"card-title"},Ae={class:"card-content"},Ie={class:"api-item-row"},$e={style:{flex:"1","min-width":"0"}},Ue={class:"api-item-col"},He={class:"form-label",for:"api-url"},Ne=["placeholder"],je={class:"api-item-col"},De={class:"form-label",for:"api-key"},Ge=["placeholder"],Ee={class:"api-item-row"},Me={class:"list-item-title",style:{"font-weight":"normal","white-space":"nowrap"}},Re={style:{flex:"1",display:"flex",gap:"10px","align-items":"center","min-width":"0"}},Fe={style:{flex:"1","min-width":"0",position:"relative"}},Oe={key:0,value:"",disabled:""},Ve=["value"],Ke={class:"card"},Le={class:"card-title"},ze={class:"card-title-note",style:{padding:"0 16px 10px","margin-top":"-10px",color:"var(--danger-color)"}},Je={class:"card-content"},qe={class:"api-item-row"},We={class:"list-item-content"},Ye={class:"list-item-title"},Ze={class:"list-item-subtitle"},Qe={class:"api-item-row"},Xe={class:"list-item-content"},et={class:"list-item-title"},tt={class:"api-item-row"},ot={class:"list-item-content"},st={class:"list-item-title"},at={class:"api-item-row"},it={class:"list-item-content"},lt={class:"list-item-title"},nt={class:"api-item-row"},rt={class:"list-item-content"},ct={class:"list-item-title"},dt={class:"api-item-row"},pt={class:"list-item-content"},ut={class:"list-item-title"},vt={class:"list-item-subtitle"},bt={class:"mode-selector"},ht={key:0,class:"api-item-row"},mt={class:"list-item-content"},gt={class:"list-item-title"},ft={class:"list-item-subtitle"},kt={class:"card"},wt={class:"card-title"},_t={class:"card-content"},yt={class:"api-item-row"},xt={class:"list-item-content"},Pt={class:"list-item-title"},Ct={class:"list-item-subtitle"},St={class:"api-item-row"},Tt={class:"list-item-content"},Bt={class:"list-item-title"},At={class:"list-item-subtitle"},It={class:"card"},$t={class:"card-title"},Ut={class:"card-content"},Ht={class:"api-item-col"},Nt={class:"form-label",for:"github-token"},jt={class:"input-hint"},Dt={style:{display:"flex",gap:"10px"}},Gt=["placeholder"],Et={class:"api-item-col"},Mt={class:"form-label",for:"github-repo"},Rt={style:{display:"flex",gap:"10px"}},Ft=["placeholder"],Ot=["disabled"],Vt={class:"api-item-row"},Kt=["disabled"],Lt=["disabled"],zt={key:0,style:{"font-size":"12px",color:"var(--text-tertiary)","margin-top":"10px"}},Jt={class:"card"},qt={class:"card-title"},Wt={class:"card-content"},Yt={class:"api-item-row"},Zt={class:"list-item-content",style:{flex:"1","min-width":"0"}},Qt={class:"list-item-title"},Xt={class:"list-item-subtitle"},eo={style:{width:"120px","flex-shrink":"0"}},to={class:"api-item-col"},oo={class:"form-label",for:"imgbb-api-key"},so={class:"input-hint"},ao={style:{display:"flex",gap:"10px"}},io=["placeholder"],lo={class:"api-item-col"},no={class:"form-label",for:"catbox-hash"},ro={class:"input-hint"},co={style:{display:"flex",gap:"10px"}},po=["placeholder"],uo={class:"card"},vo={class:"card-title"},bo={class:"card-content"},ho={style:{"font-size":"13px",color:"var(--text-tertiary)","margin-bottom":"15px"}},mo={class:"api-item-row",style:{"border-bottom":"none","padding-bottom":"0"}},go={class:"scope-list"},fo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},ko={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},wo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},_o={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},yo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},xo={class:"scope-list",style:{"max-height":"300px","overflow-y":"auto"}},Po={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},Co={class:"scope-name"},So=["onClick"],To={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},Bo={class:"scope-name"},Ao={__name:"API",setup(S){const{t:o}=he(),u=me(),g=ge(),v=Se(),E=fe(),T=ke(),P=we(),N=h(""),j=h(""),G=h(""),l=h(!1),r=h([]),b=h(5),m=h(30),c=h(10),n=h("always"),d=h(15),f=h(""),w=h(""),U=h("catbox"),D=h(""),A=h(""),_=h([{value:"none",label:"无"},{value:"catbox",label:"Catbox"},{value:"imgbb",label:"ImgBB"}]);_e(()=>{l.value=g.globalBackgroundActivity,r.value=[...g.globalProactiveScope||[]],b.value=g.globalProactiveInterval,m.value=g.globalProactiveCooldown,c.value=g.globalProactiveDailyLimit,n.value=g.globalTriggerMode,d.value=g.globalProactiveIdleTime,f.value=localStorage.getItem("github_token")||"",w.value=localStorage.getItem("github_repo")||"",U.value=u.imageHostProvider,D.value=u.imgbbApiKey,A.value=u.catboxUserHash});const C=L(()=>u.presets.find(p=>p.name===u.activePresetName)||null);F(C,p=>{p&&(N.value=p.apiKey,j.value=p.apiUrl,G.value=p.model)},{immediate:!0,deep:!0}),F([N,j,G],()=>{u.activePresetName&&u.addPreset(u.activePresetName,{apiKey:N.value,apiUrl:j.value,model:G.value})}),F([l,r,b,m,c,n,d],()=>{g.globalBackgroundActivity=l.value,g.globalProactiveScope=r.value,g.globalProactiveInterval=b.value,g.globalProactiveCooldown=m.value,g.globalProactiveDailyLimit=c.value,g.globalTriggerMode=n.value,g.globalProactiveIdleTime=d.value},{deep:!0}),F([f,w],()=>{v.githubToken=f.value,v.githubRepo=w.value,localStorage.setItem("github_token",f.value),localStorage.setItem("github_repo",w.value)}),F([U,D,A],()=>{u.imageHostProvider=U.value,u.imgbbApiKey=D.value,u.catboxUserHash=A.value},{deep:!0});function J(){T.showToast(o("api.toast.settingsSaved"))}function X(){T.showInput(o("api.prompt.saveAsPreset"),"",p=>{p&&(u.addPreset(p,{apiKey:N.value,apiUrl:j.value,model:G.value}),T.showToast(o("api.toast.presetSaved",{name:p})))},o("api.prompt.enterPresetName"))}function ee(){T.showConfirm(o("api.confirm.deletePreset"),o("api.confirm.deletePresetMsg",{name:u.activePresetName}),()=>{u.deletePreset(u.activePresetName),T.showToast(o("api.toast.presetDeleted"))})}async function te(){const p={apiUrl:j.value,apiKey:N.value};await u.fetchModels(p)}const oe=L(()=>{switch(P.permission){case"granted":return o("api.notificationsGranted");case"denied":return o("api.notificationsDenied");default:return o("api.notificationsDefault")}}),se=()=>{P.permission!=="granted"?P.requestPermission():P.desktopNotificationsEnabled=!P.desktopNotificationsEnabled},ae=()=>{if(!P.desktopNotificationsEnabled){T.showToast("请先开启“桌面通知”开关。","warning");return}if(P.permission!=="granted"){T.showToast("浏览器通知权限未授予，请点击开关重新授权。","warning");return}T.showToast("测试通知已发送，请检查系统通知。"),P.triggerNotification("测试通知","如果看到此消息，说明桌面通知功能正常。","/pwa-192x192.png",()=>{console.log("Test notification clicked!")})},ie=async()=>{v.githubToken=f.value,await v.createBackupRepo(),w.value=v.githubRepo},le=async()=>{v.githubToken=f.value,v.githubRepo=w.value,await v.backupToGitHub()};function ne(){window.open("https://github.com/settings/tokens/new?scopes=repo&description=Phone%20App%20Backup","_blank")}function re(){window.open("https://api.imgbb.com/","_blank")}function ce(){window.open("https://catbox.moe/user/","_blank")}function de(){T.showConfirm("确认清除所有数据？","此操作将永久删除所有本地存储的数据（包括聊天记录、API设置、背景图片等）。应用将重置为初始状态。请确保您已备份重要数据。",async()=>{localStorage.clear();try{await Ce.clear()}catch(p){console.error("Error clearing localforage:",p)}try{u.$reset(),g.$reset(),v.$reset(),E.$reset(),T.$reset(),P.$reset()}catch(p){console.error("Error resetting stores:",p)}window.location.reload()},{messageStyle:{color:"#FF3B30"},confirmText:"delete"})}const O=h(!1),y=h({chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0,presets:!0});function R(p){if(p==="worldbook"){const t=!y.value.worldbook;y.value.worldbook=t,y.value.presets=t}else y.value[p]=!y.value[p]}function pe(){v.exportBackupFile(y.value),O.value=!1}const V=h(!1),ue=L(()=>{const p=r.value||[];return p.includes("all")?o("api.scopeAll"):p.length===0?o("api.scopeNone"):o("api.scopeSelected",{count:p.length})});function q(p){const t=r.value;if(p==="all")t.includes("all")?r.value=[]:r.value=["all"];else if(t.includes("all"))r.value=[p];else{const a=t.indexOf(p);a>-1?t.splice(a,1):t.push(p),E.characters.length>0&&t.length===E.characters.length&&(r.value=["all"])}}return(p,t)=>(k(),ye(xe,{title:s(o)("api.title")},{action:M(()=>[e("button",{class:"header-save-btn",onClick:J},i(s(o)("save")),1)]),default:M(()=>[e("div",Te,[e("div",Be,i(s(o)("api.globalConfig")),1),e("div",Ae,[e("div",Ie,[e("div",$e,[K(Q,{"model-value":s(u).activePresetName,options:s(u).presets.map(a=>({value:a.name,label:a.name})),"onUpdate:modelValue":t[0]||(t[0]=a=>s(u).switchPreset(a)),textAlign:"left",style:{width:"100%"}},null,8,["model-value","options"])]),e("button",{class:"btn btn-secondary btn-sm",onClick:X},i(s(o)("api.saveAs")),1),e("button",{class:"btn btn-danger-light btn-sm",onClick:ee},i(s(o)("delete")),1)]),e("div",Ue,[e("label",He,i(s(o)("api.apiUrl")),1),I(e("input",{type:"text",id:"api-url",class:"base-input","onUpdate:modelValue":t[1]||(t[1]=a=>j.value=a),placeholder:s(o)("api.apiUrlPlaceholder"),autocomplete:"new-password"},null,8,Ne),[[H,j.value]])]),e("div",je,[e("label",De,i(s(o)("api.apiKey")),1),I(e("input",{type:"password",id:"api-key",class:"base-input","onUpdate:modelValue":t[2]||(t[2]=a=>N.value=a),placeholder:s(o)("api.apiKeyPlaceholder"),autocomplete:"new-password"},null,8,Ge),[[H,N.value]])]),e("div",Ee,[e("div",Me,i(s(o)("api.model")),1),e("div",Re,[e("div",Fe,[I(e("select",{class:"native-select","onUpdate:modelValue":t[3]||(t[3]=a=>G.value=a)},[s(u).models.length===0?(k(),x("option",Oe,i(s(o)("api.modelPlaceholder")),1)):B("",!0),(k(!0),x(z,null,Y(s(u).models,a=>(k(),x("option",{key:a,value:a},i(a),9,Ve))),128))],512),[[Pe,G.value]]),t[29]||(t[29]=e("div",{class:"select-arrow"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1))]),e("button",{class:"btn btn-secondary btn-sm",onClick:te,style:{"white-space":"nowrap"}},i(s(o)("api.fetch")),1)])])])]),e("div",Ke,[e("div",Le,i(s(o)("api.backgroundActivity")),1),e("div",ze,i(s(o)("api.backgroundActivityWarning")),1),e("div",Je,[e("div",qe,[e("div",We,[e("div",Ye,i(s(o)("api.proactiveMessages")),1),e("div",Ze,i(s(o)("api.proactiveMessagesDesc")),1)]),e("div",{class:$(["toggle-switch",{active:l.value}]),onClick:t[4]||(t[4]=a=>l.value=!l.value)},null,2)]),l.value?(k(),x(z,{key:0},[e("div",Qe,[e("div",Xe,[e("div",et,i(s(o)("api.scope")),1)]),e("div",{class:"scope-selector",onClick:t[5]||(t[5]=a=>V.value=!0)},[e("span",null,i(ue.value),1),t[30]||(t[30]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1))])]),e("div",tt,[e("div",ot,[e("div",st,i(s(o)("api.interval")),1)]),I(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>b.value=a),class:"base-input base-input-short",placeholder:"5",autocomplete:"new-password"},null,512),[[H,b.value,void 0,{number:!0}]])]),e("div",at,[e("div",it,[e("div",lt,i(s(o)("api.cooldown")),1)]),I(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>m.value=a),class:"base-input base-input-short",placeholder:"30",autocomplete:"new-password"},null,512),[[H,m.value,void 0,{number:!0}]])]),e("div",nt,[e("div",rt,[e("div",ct,i(s(o)("api.dailyLimit")),1)]),I(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>c.value=a),class:"base-input base-input-short",placeholder:"10",autocomplete:"new-password"},null,512),[[H,c.value,void 0,{number:!0}]])]),e("div",dt,[e("div",pt,[e("div",ut,i(s(o)("api.triggerMode")),1),e("div",vt,i(s(o)("api.triggerModeIdleHint")),1)]),e("div",bt,[e("div",{class:$(["mode-option",{active:n.value==="idle"}]),onClick:t[9]||(t[9]=a=>n.value="idle")},i(s(o)("api.triggerModeIdle")),3),e("div",{class:$(["mode-option",{active:n.value==="always"}]),onClick:t[10]||(t[10]=a=>n.value="always")},i(s(o)("api.triggerModeAlways")),3)])]),n.value==="idle"?(k(),x("div",ht,[e("div",mt,[e("div",gt,i(s(o)("api.idleTime")),1),e("div",ft,i(s(o)("api.idleTimeDesc")),1)]),I(e("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=a=>d.value=a),class:"base-input base-input-short",placeholder:"15",autocomplete:"new-password"},null,512),[[H,d.value,void 0,{number:!0}]])])):B("",!0)],64)):B("",!0)])]),e("div",kt,[e("div",wt,i(s(o)("api.notificationSettings")),1),e("div",_t,[e("div",yt,[e("div",xt,[e("div",Pt,i(s(o)("api.desktopNotifications")),1),e("div",Ct,i(oe.value),1)]),e("div",{class:$(["toggle-switch",{active:s(P).desktopNotificationsEnabled}]),onClick:se},null,2)]),e("div",St,[e("div",Tt,[e("div",Bt,i(s(o)("api.testNotification")),1),e("div",At,i(s(o)("api.testNotificationDesc")),1)]),e("button",{class:"btn btn-secondary btn-sm",onClick:ae},i(s(o)("api.test")),1)])])]),e("div",It,[e("div",$t,i(s(o)("api.githubBackup")),1),e("div",Ut,[e("div",Ht,[e("label",Nt,i(s(o)("api.githubToken")),1),e("div",jt,i(s(o)("api.githubTokenHint")),1),e("div",Dt,[I(e("input",{type:"password",id:"github-token",class:"base-input small-placeholder","onUpdate:modelValue":t[12]||(t[12]=a=>f.value=a),placeholder:s(o)("api.githubTokenPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Gt),[[H,f.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ne},i(s(o)("api.getToken")),1)])]),e("div",Et,[e("label",Mt,i(s(o)("api.repoAddress")),1),e("div",Rt,[I(e("input",{type:"text",id:"github-repo",class:"base-input","onUpdate:modelValue":t[13]||(t[13]=a=>w.value=a),placeholder:s(o)("api.repoAddressPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,Ft),[[H,w.value]]),w.value?B("",!0):(k(),x("button",{key:0,class:"btn btn-secondary btn-sm",onClick:ie,disabled:!f.value},i(s(o)("api.createRepo")),9,Ot))])]),e("div",Vt,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:le,disabled:s(v).isBackingUp||s(v).isRestoring},i(s(v).isBackingUp?s(o)("api.backingUp"):s(o)("api.backupNow")),9,Kt),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[14]||(t[14]=(...a)=>s(v).restoreFromGitHub&&s(v).restoreFromGitHub(...a)),disabled:s(v).isBackingUp||s(v).isRestoring},i(s(v).isRestoring?s(o)("api.restoring"):s(o)("api.restoreBackup")),9,Lt)]),s(v).lastBackupTime?(k(),x("p",zt,i(s(o)("api.lastBackup"))+" "+i(new Date(s(v).lastBackupTime).toLocaleString()),1)):B("",!0)])]),e("div",Jt,[e("div",qt,i(s(o)("api.imageHost")),1),e("div",Wt,[e("div",Yt,[e("div",Zt,[e("div",Qt,i(s(o)("api.defaultImageHost")),1),e("div",Xt,i(s(o)("api.defaultImageHostDesc")),1)]),e("div",eo,[K(Q,{"model-value":U.value,options:_.value,"onUpdate:modelValue":t[15]||(t[15]=a=>U.value=a),textAlign:"right"},null,8,["model-value","options"])])]),e("div",to,[e("label",oo,i(s(o)("api.imgbbApiKey")),1),e("div",so,i(s(o)("api.imgbbApiKeyHint")),1),e("div",ao,[I(e("input",{type:"password",id:"imgbb-api-key",class:"base-input small-placeholder","onUpdate:modelValue":t[16]||(t[16]=a=>D.value=a),placeholder:s(o)("api.imgbbApiKeyPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,io),[[H,D.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:re},i(s(o)("api.getImgbbApiKey")),1)])]),e("div",lo,[e("label",no,i(s(o)("api.catboxUserHash")),1),e("div",ro,i(s(o)("api.catboxUserHashHint")),1),e("div",co,[I(e("input",{type:"text",id:"catbox-hash",class:"base-input small-placeholder","onUpdate:modelValue":t[17]||(t[17]=a=>A.value=a),placeholder:s(o)("api.catboxUserHashPlaceholder"),style:{flex:"1"},autocomplete:"new-password"},null,8,po),[[H,A.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ce},i(s(o)("api.getCatboxUserHash")),1)])])])]),e("div",uo,[e("div",vo,i(s(o)("api.dataBackup")),1),e("div",bo,[e("p",ho,i(s(o)("api.dataBackupDesc")),1),e("div",mo,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[18]||(t[18]=a=>O.value=!0)},i(s(o)("api.exportBackupFile")),1),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[19]||(t[19]=(...a)=>s(v).importBackupFile&&s(v).importBackupFile(...a))},i(s(o)("api.importBackupFile")),1)])])]),e("div",{class:"danger-zone"},[e("button",{class:"btn btn-danger big-btn",onClick:de},[...t[31]||(t[31]=[e("div",{class:"danger-btn-content"},[e("div",{class:"danger-btn-title"},"清除所有数据"),e("div",{class:"danger-btn-desc"},"此操作将清除所有聊天记录、设置和本地数据，且无法恢复")],-1)])])]),K(Z,{visible:O.value,"onUpdate:visible":t[25]||(t[25]=a=>O.value=a),title:"导出选项",bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:pe},"确认导出")]),default:M(()=>[e("div",go,[e("div",{class:"scope-item",onClick:t[20]||(t[20]=a=>R("chat"))},[e("div",{class:$(["scope-checkbox",{checked:y.value.chat}])},[y.value.chat?(k(),x("svg",fo,[...t[32]||(t[32]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),t[33]||(t[33]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"聊天数据"),e("span",{class:"scope-desc"},"包含聊天记录和朋友圈")],-1))]),e("div",{class:"scope-item",onClick:t[21]||(t[21]=a=>R("characters"))},[e("div",{class:$(["scope-checkbox",{checked:y.value.characters}])},[y.value.characters?(k(),x("svg",ko,[...t[34]||(t[34]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),t[35]||(t[35]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"角色数据"),e("span",{class:"scope-desc"},"包含角色卡片、用户人设和收藏")],-1))]),e("div",{class:"scope-item",onClick:t[22]||(t[22]=a=>R("settings"))},[e("div",{class:$(["scope-checkbox",{checked:y.value.settings}])},[y.value.settings?(k(),x("svg",wo,[...t[36]||(t[36]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),t[37]||(t[37]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"应用设置"),e("span",{class:"scope-desc"},"包含图床、后台活动等设置")],-1))]),e("div",{class:"scope-item",onClick:t[23]||(t[23]=a=>R("appearance"))},[e("div",{class:$(["scope-checkbox",{checked:y.value.appearance}])},[y.value.appearance?(k(),x("svg",_o,[...t[38]||(t[38]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),t[39]||(t[39]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"外观主题"),e("span",{class:"scope-desc"},"包含主题、字体、气泡样式")],-1))]),e("div",{class:"scope-item",onClick:t[24]||(t[24]=a=>R("worldbook"))},[e("div",{class:$(["scope-checkbox",{checked:y.value.worldbook}])},[y.value.worldbook?(k(),x("svg",yo,[...t[40]||(t[40]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),t[41]||(t[41]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"世界书/预设"),e("span",{class:"scope-desc"},"包含世界书和API预设")],-1))])])]),_:1},8,["visible"]),K(Z,{visible:V.value,"onUpdate:visible":t[28]||(t[28]=a=>V.value=a),title:s(o)("api.selectScope"),bodyClass:"no-padding"},{footer:M(()=>[e("button",{class:"modal-btn confirm",onClick:t[27]||(t[27]=a=>V.value=!1)},i(s(o)("confirm")),1)]),default:M(()=>[e("div",xo,[e("div",{class:"scope-item",onClick:t[26]||(t[26]=a=>q("all"))},[e("div",{class:$(["scope-checkbox",{checked:r.value&&r.value.includes("all")}])},[r.value&&r.value.includes("all")?(k(),x("svg",Po,[...t[42]||(t[42]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),e("span",Co,i(s(o)("api.scopeAll")),1)]),(k(!0),x(z,null,Y(s(E).characters,a=>(k(),x("div",{key:a.id,class:"scope-item",onClick:Io=>q(a.id)},[e("div",{class:$(["scope-checkbox",{checked:r.value&&r.value.includes(a.id)}])},[r.value&&r.value.includes(a.id)?(k(),x("svg",To,[...t[43]||(t[43]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):B("",!0)],2),e("span",Bo,i(a.name),1)],8,So))),128))])]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},Ho=be(Ao,[["__scopeId","data-v-ab084351"]]);export{Ho as default};
