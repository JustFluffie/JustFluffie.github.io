import{_ as ke,q as Pe,x as Fe,R as Te,a3 as V,r as k,c as f,y as $e,l as Ie,h as R,a6 as Ne,k as Ae,o as y,d as s,f as T,b as P,e as I,B as i,n as j,j as v,E as B,F as xe,C as Ue,w as D,A as M,N as ze}from"./index-Cvx2CjzQ.js";import{C as N}from"./CustomSelect-DP60U3Sk.js";const Oe={class:"card theme-section"},Le={class:"card-content"},Ve={class:"theme-item no-icon"},Re={class:"item-content"},je={class:"item-label",style:{"font-weight":"600"}},Be={class:"item-value"},De={key:0,class:"theme-item no-icon"},Me={style:{display:"flex",gap:"5px","align-items":"center",flex:"1",width:"100%"}},Je={class:"item-label",style:{"white-space":"nowrap","margin-right":"10px"}},He=["value"],We=["value","placeholder"],Ee={class:"theme-item no-icon"},qe={class:"item-content"},Ge={class:"item-label",style:{"font-weight":"600"}},Qe={class:"item-value"},Xe={class:"card theme-section"},Ye={class:"card-title"},Ze={class:"card-content"},Ke={class:"theme-item no-icon"},et={class:"item-content"},tt={class:"wallpaper-container"},st={class:"wallpaper-col"},ot={class:"section-title-center"},nt={key:0,class:"upload-hint"},at={class:"wallpaper-col"},lt={class:"section-title-center"},it={key:0,class:"upload-hint"},rt={class:"theme-item no-icon"},ct={class:"item-content"},pt={class:"item-label"},mt={class:"card theme-section"},dt={class:"card-title"},ut={class:"card-content"},ht={class:"theme-item no-icon"},ft={class:"item-content"},vt={class:"app-icons-grid-new"},bt=["onClick"],gt={class:"app-icon-box"},_t=["src"],yt={class:"app-name"},Ct={class:"card theme-section"},wt={class:"card-title"},St={class:"card-content"},kt={class:"theme-item no-icon"},Pt={style:{display:"flex",gap:"10px","align-items":"center",flex:"1"}},Ft={class:"theme-item no-icon"},Tt={style:{display:"flex",gap:"5px","align-items":"center",flex:"1",width:"100%"}},$t=["placeholder"],It={class:"theme-item no-icon"},Nt={style:{display:"flex",gap:"5px","align-items":"center",flex:"1",width:"100%"}},At=["value"],xt=["value","placeholder"],Ut={class:"theme-item no-icon"},zt={class:"item-content"},Ot={class:"item-label"},Lt={class:"number-input"},Vt={class:"card theme-section"},Rt={class:"card-title"},jt={class:"card-content"},Bt={class:"theme-item no-icon"},Dt={style:{display:"flex",gap:"10px","align-items":"center",flex:"1"}},Mt={class:"theme-item no-icon"},Jt={style:{display:"flex",gap:"10px","align-items":"center",flex:"1"}},Ht={class:"theme-item no-icon"},Wt={class:"item-content",style:{"flex-direction":"column","align-items":"flex-start",gap:"5px",width:"100%"}},Et={style:{display:"flex","justify-content":"space-between",width:"100%","align-items":"center"}},qt={class:"item-label"},Gt=["placeholder"],Qt={class:"card theme-section"},Xt={class:"card-title"},Yt={class:"card-content"},Zt={class:"theme-item no-icon"},Kt={class:"import-export-container",style:{flex:"1","justify-content":"space-around"}},es={__name:"Theme",setup(ts){const{t:o}=Pe(),A=Ae(),l=Fe(),{themePresets:b,currentThemePreset:p,fontPresets:F,currentFontPreset:g,cssPresets:d,currentCssPreset:m,homeScreen:J}=Te(l),n=V({}),C=k(""),u=k(""),w=k(!1),_=V({title:"",bizType:"theme",onConfirm:null}),S=k(""),H=k(null),x=k(null),U=f(()=>[{key:"chat",name:o("homeScreen.apps.chat")},{key:"worldbook",name:o("homeScreen.apps.worldbook")},{key:"preset",name:o("homeScreen.apps.preset")},{key:"calendar",name:o("homeScreen.apps.calendar")},{key:"api",name:o("homeScreen.apps.apiSettings")},{key:"theme",name:o("homeScreen.apps.theme")},{key:"spy",name:o("homeScreen.apps.spy")},{key:"check",name:o("homeScreen.apps.check")}]);f(()=>{const e=S.value==="home"?o("theme.homeScreen"):o("theme.lockScreen");return o("theme.setWallpaper",{type:e})});const W=f(()=>{const e=n.fontColor;if(!e)return"#000000";if(/^#[0-9A-F]{6}$/i.test(e))return e;const t=e.match(/^rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);if(t){const a=parseInt(t[1]).toString(16).padStart(2,"0"),c=parseInt(t[2]).toString(16).padStart(2,"0"),r=parseInt(t[3]).toString(16).padStart(2,"0");return`#${a}${c}${r}`}return"#000000"}),E=f(()=>{const e=n.frameColor;if(!e)return"#f3f3f3";if(/^#[0-9A-F]{6}$/i.test(e))return e;const t=e.match(/^rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i);if(t){const a=parseInt(t[1]).toString(16).padStart(2,"0"),c=parseInt(t[2]).toString(16).padStart(2,"0"),r=parseInt(t[3]).toString(16).padStart(2,"0");return`#${a}${c}${r}`}return"#f3f3f3"}),q=f(()=>Object.keys(F.value||{}).map(e=>({value:e,label:e}))),G=f(()=>Object.keys(b.value||{}).map(e=>({value:e,label:e}))),Q=f(()=>Object.keys(d.value||{}).map(e=>({value:e,label:e}))),X=f(()=>[{value:1,label:"屏幕一"},{value:2,label:"屏幕二"}]);function Y(e){l.setHomeScreen(e)}$e(()=>{$()});function $(){const e=o("theme.defaultTheme"),t=o("theme.defaultCss");b.value||(b.value={[e]:{bg:"",lockbg:"",appIcons:{},showFrame:!0,frameColor:"#f3f3f3",fontColor:"#1f1f1f",appLabelFontSize:10}});const a=b.value[p.value];if(a)Object.assign(n,JSON.parse(JSON.stringify(a)));else{p.value=e;const c=b.value[e]||{};Object.assign(n,JSON.parse(JSON.stringify(c)))}n.appIcons||(n.appIcons={}),n.appLabelFontSize||(n.appLabelFontSize=10),n.frameColor||(n.frameColor="#f3f3f3"),d.value||(d.value={[t]:""}),u.value=d.value[m.value]||""}const Z=()=>{A.options.history.state.back?A.back():A.push("/")};function z(e){const t=n[e]===!1;n[e]=t,(e==="showFrame"||e==="showStatusBar")&&l.updateThemeSetting(e,t)}function O(e){S.value=e;const t=o(e==="home"?"theme.homeScreen":"theme.lockScreen");_.title=o("theme.setWallpaper",{type:t}),_.bizType="theme",w.value=!0}function K(e){const t=e.content;S.value==="home"?n.bg=t:S.value==="lock"&&(n.lockbg=t)}function ee(e){const t=e.content;S.value==="home"?n.bg=t:S.value==="lock"&&(n.lockbg=t),w.value=!1}function te(e){var a;H.value=e;const t=((a=U.value.find(c=>c.key===e))==null?void 0:a.name)||"";_.title=o("theme.setAppIcon",{appName:t}),_.onConfirm=c=>{const r=c.content;se(e,r),w.value=!1},_.bizType="avatar",w.value=!0}function se(e,t){const a={...n.appIcons||{}};a[e]=t,n.appIcons=a}function oe(){l.showConfirm(o("theme.confirm.deleteFontPreset"),o("theme.confirm.deleteFontPresetMsg",{presetName:g.value}),()=>{const e=g.value;l.deleteFontPreset(e),g.value===e&&(g.value=o("theme.defaultTheme")),C.value=F.value[g.value]||""})}function ne(){const e=C.value.trim();if(e)try{new URL(e),l.applyFont(e),l.showToast(o("theme.toast.fontApplied"),"info")}catch{l.showToast(o("theme.toast.invalidUrl"),"error")}}function ae(e){/^#[0-9A-F]{6}$/i.test(e)&&(n.fontColor=e,l.applyFontColor(e))}function le(e){const t=/^#([0-9A-F]{3}){1,2}$/i.test(e)||/^#([0-9A-F]{4}){1,2}$/i.test(e),a=/^rgb\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/i.test(e),c=/^rgba\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d\.]+\s*\)$/i.test(e);(t||a||c)&&(n.fontColor=e,l.applyFontColor(e))}function ie(){l.applyFontColor(n.fontColor),l.showToast(o("theme.toast.colorApplied"),"info")}function re(e){/^#[0-9A-F]{6}$/i.test(e)&&(n.frameColor=e,l.applyFrameColor(e))}function ce(e){const t=/^#([0-9A-F]{3}){1,2}$/i.test(e)||/^#([0-9A-F]{4}){1,2}$/i.test(e),a=/^rgb\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$/i.test(e),c=/^rgba\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d\.]+\s*\)$/i.test(e);(t||a||c)&&(n.frameColor=e,l.applyFrameColor(e))}function pe(){l.applyFrameColor(n.frameColor),l.showToast(o("theme.toast.colorApplied"),"info")}function L(e){let t=n.appLabelFontSize||10;t+=e,t<8&&(t=8),t>16&&(t=16),n.appLabelFontSize=t,l.applyAppLabelFontSize(t)}function me(e){l.switchFontPreset(e),C.value=F.value[e]||""}function de(){const e=prompt(o("theme.prompt.enterFontPresetName"));if(e){const t=C.value.trim();if(t)try{new URL(t),l.saveFontPreset(e,t),l.showToast(o("theme.toast.saveSuccess"))}catch{l.showToast(o("theme.toast.invalidUrl"),"error")}else l.showToast(o("theme.toast.enterFontUrl"),"info")}}function ue(e){confirm(o("theme.confirm.switchTheme"))&&(l.switchThemePreset(e),$())}function he(){const e=prompt(o("theme.prompt.enterThemePresetName"));if(e){const t=JSON.parse(JSON.stringify(n));t.bg=t.bg||"",t.lockbg=t.lockbg||"",t.appIcons=t.appIcons||{},t.fontColor=t.fontColor||"#1f1f1f",t.frameColor=t.frameColor||"#f3f3f3",t.appLabelFontSize=t.appLabelFontSize||10,l.saveThemePreset(e,t),l.showToast(o("theme.toast.saveSuccess"))}}function fe(){l.showConfirm(o("theme.confirm.deleteThemePreset"),o("theme.confirm.deleteThemePresetMsg",{presetName:p.value}),()=>{const e=p.value;l.deleteThemePreset(e),p.value===e&&(p.value=o("theme.defaultTheme")),$()})}function ve(e){l.switchCssPreset(e),u.value=d.value[e]||""}function be(){const e=prompt(o("theme.prompt.enterCssPresetName"));if(e){const t=u.value.trim();t?t.includes("{")&&t.includes("}")?(l.saveCssPreset(e,t),l.showToast(o("theme.toast.saveSuccess"))):l.showToast(o("theme.toast.invalidCss"),"error"):l.showToast(o("theme.toast.enterCss"),"info")}}function ge(){l.showConfirm(o("theme.confirm.deleteCssPreset"),o("theme.confirm.deleteCssPresetMsg",{presetName:m.value}),()=>{const e=m.value;l.deleteCssPreset(e),m.value===e&&(m.value=o("theme.defaultCss")),u.value=d.value[m.value]||""})}function _e(){const e=u.value.trim();e?e.includes("{")&&e.includes("}")?(l.applyCss(e),l.showToast(o("theme.toast.cssApplied"),"info")):l.showToast(o("theme.toast.invalidCss"),"error"):(l.applyCss(""),l.showToast(o("theme.toast.cssCleared"),"info"))}function ye(){const e={themePresets:b.value,currentThemePreset:p.value,fontPresets:F.value,currentFontPreset:g.value,cssPresets:d.value,currentCssPreset:m.value,exportDate:new Date().toISOString()},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),c=document.createElement("a");c.href=a,c.download=`ai_phone_theme_config_${new Date().toISOString().slice(0,10)}.json`,c.click(),URL.revokeObjectURL(a)}function Ce(){x.value.click()}function we(e){const t=e.target.files[0];if(!t)return;const a=new FileReader;a.onload=c=>{try{const r=JSON.parse(c.target.result);if(r.themePresets)for(const h in r.themePresets)b.value[h]=r.themePresets[h];if(r.fontPresets)for(const h in r.fontPresets)F.value[h]=r.fontPresets[h];if(r.cssPresets)for(const h in r.cssPresets)d.value[h]=r.cssPresets[h];confirm(o("theme.confirm.importSuccess"))&&(r.currentThemePreset&&l.switchThemePreset(r.currentThemePreset),r.currentFontPreset&&l.switchFontPreset(r.currentFontPreset),r.currentCssPreset&&l.switchCssPreset(r.currentCssPreset)),$(),l.showToast(o("theme.toast.importSuccess"),"success")}catch(r){l.showToast(o("theme.toast.importFailed"),"error"),console.error(r)}},a.readAsText(t),e.target.value=""}function Se(){const e={bg:n.bg||"",lockbg:n.lockbg||"",appIcons:n.appIcons||{},showFrame:n.showFrame!==!1,frameColor:n.frameColor||"#f3f3f3",showStatusBar:n.showStatusBar!==!1,fontColor:n.fontColor||"#1f1f1f",appLabelFontSize:n.appLabelFontSize||10};l.saveThemePreset(p.value,e),l.saveCssPreset(m.value,u.value),l.initTheme(),l.showToast(o("theme.toast.saveSuccess"))}return(e,t)=>(y(),Ie(Ne,{title:e.$t("theme.title"),backAction:Z,id:"themeSettingsApp"},{action:R(()=>[s("button",{class:"header-save-btn",onClick:Se},i(e.$t("save")),1)]),default:R(()=>[s("div",Oe,[s("div",Le,[s("div",Ve,[s("div",Re,[s("div",je,i(e.$t("theme.showFrame")),1),s("div",Be,i(e.$t("theme.showFrameDesc")),1)]),s("div",{class:j(["toggle-switch",{active:n.showFrame!==!1}]),onClick:t[0]||(t[0]=a=>z("showFrame"))},null,2)]),n.showFrame!==!1?(y(),P("div",De,[s("div",Me,[s("div",Je,i(e.$t("theme.frameColor")),1),s("input",{type:"color",class:"color-picker-input",value:E.value,onInput:t[1]||(t[1]=a=>re(a.target.value))},null,40,He),s("input",{type:"text",class:"base-input",style:{flex:"1"},value:n.frameColor,onInput:t[2]||(t[2]=a=>ce(a.target.value)),placeholder:v(o)("theme.frameColorPlaceholder")},null,40,We),s("button",{class:"btn btn-secondary btn-sm",style:{"white-space":"nowrap"},onClick:pe},i(e.$t("confirm")),1)])])):I("",!0),s("div",Ee,[s("div",qe,[s("div",Ge,i(e.$t("theme.showStatusBar")),1),s("div",Qe,i(e.$t("theme.showStatusBarDesc")),1)]),s("div",{class:j(["toggle-switch",{active:n.showStatusBar!==!1}]),onClick:t[3]||(t[3]=a=>z("showStatusBar"))},null,2)])])]),s("div",Xe,[s("div",Ye,i(e.$t("theme.wallpaper")),1),s("div",Ze,[s("div",Ke,[s("div",et,[s("div",tt,[s("div",st,[s("div",ot,i(e.$t("theme.homeScreen")),1),s("div",{class:"wallpaper-preview",style:B(n.bg?{backgroundImage:`url('${n.bg}')`}:{}),onClick:t[4]||(t[4]=a=>O("home"))},[n.bg?I("",!0):(y(),P("span",nt,i(e.$t("theme.uploadHint")),1))],4)]),s("div",at,[s("div",lt,i(e.$t("theme.lockScreen")),1),s("div",{class:"wallpaper-preview",style:B(n.lockbg?{backgroundImage:`url('${n.lockbg}')`}:{}),onClick:t[5]||(t[5]=a=>O("lock"))},[n.lockbg?I("",!0):(y(),P("span",it,i(e.$t("theme.uploadHint")),1))],4)])])])]),s("div",rt,[s("div",ct,[s("div",pt,i(e.$t("theme.homeScreenStyle")),1)]),T(N,{options:X.value,modelValue:v(J),"onUpdate:modelValue":Y,textAlign:"left"},null,8,["options","modelValue"])])])]),s("div",mt,[s("div",dt,i(e.$t("theme.appIcons")),1),s("div",ut,[s("div",ht,[s("div",ft,[s("div",vt,[(y(!0),P(xe,null,Ue(U.value,a=>(y(),P("div",{key:a.key,class:"app-icon-item",onClick:c=>te(a.key)},[s("div",gt,[n.appIcons&&n.appIcons[a.key]?(y(),P("img",{key:0,src:n.appIcons[a.key]},null,8,_t)):I("",!0)]),s("span",yt,i(a.name),1)],8,bt))),128))])])])])]),s("div",Ct,[s("div",wt,i(e.$t("theme.fontSettings")),1),s("div",St,[s("div",kt,[s("div",Pt,[T(N,{options:q.value,modelValue:v(g),"onUpdate:modelValue":me,textAlign:"left",style:{flex:"1"}},null,8,["options","modelValue"]),s("button",{class:"btn btn-secondary btn-sm",onClick:de},i(e.$t("save")),1),s("button",{class:"btn btn-danger btn-sm",onClick:oe},i(e.$t("delete")),1)])]),s("div",Ft,[s("div",Tt,[D(s("input",{type:"text",class:"base-input",style:{flex:"1"},"onUpdate:modelValue":t[6]||(t[6]=a=>C.value=a),placeholder:v(o)("theme.fontUrlPlaceholder")},null,8,$t),[[M,C.value]]),s("button",{class:"btn btn-secondary btn-sm",style:{"white-space":"nowrap"},onClick:ne},i(e.$t("confirm")),1)])]),s("div",It,[s("div",Nt,[s("input",{type:"color",class:"color-picker-input",value:W.value,onInput:t[7]||(t[7]=a=>ae(a.target.value))},null,40,At),s("input",{type:"text",class:"base-input",style:{flex:"1"},value:n.fontColor,onInput:t[8]||(t[8]=a=>le(a.target.value)),placeholder:v(o)("theme.fontColorPlaceholder")},null,40,xt),s("button",{class:"btn btn-secondary btn-sm",style:{"white-space":"nowrap"},onClick:ie},i(e.$t("confirm")),1)])]),s("div",Ut,[s("div",zt,[s("div",Ot,i(e.$t("theme.appNameFontSize")),1)]),s("div",Lt,[s("button",{onClick:t[9]||(t[9]=a=>L(-1))},"-"),s("span",null,i(n.appLabelFontSize||10)+"px",1),s("button",{onClick:t[10]||(t[10]=a=>L(1))},"+")])])])]),s("div",Vt,[s("div",Rt,i(e.$t("theme.themePresets")),1),s("div",jt,[s("div",Bt,[s("div",Dt,[T(N,{options:G.value,modelValue:v(p),"onUpdate:modelValue":ue,textAlign:"left",style:{flex:"1"}},null,8,["options","modelValue"]),s("button",{class:"btn btn-secondary btn-sm",onClick:he},i(e.$t("save")),1),s("button",{class:"btn btn-danger btn-sm",onClick:fe},i(e.$t("delete")),1)])]),s("div",Mt,[s("div",Jt,[T(N,{options:Q.value,modelValue:v(m),"onUpdate:modelValue":ve,textAlign:"left",style:{flex:"1"}},null,8,["options","modelValue"]),s("button",{class:"btn btn-secondary btn-sm",onClick:be},i(e.$t("save")),1),s("button",{class:"btn btn-danger btn-sm",onClick:ge},i(e.$t("delete")),1)])]),s("div",Ht,[s("div",Wt,[s("div",Et,[s("div",qt,i(e.$t("theme.globalCss")),1),s("button",{class:"btn btn-secondary btn-sm",style:{"white-space":"nowrap"},onClick:_e},i(e.$t("confirm")),1)]),D(s("textarea",{class:"base-input","onUpdate:modelValue":t[11]||(t[11]=a=>u.value=a),placeholder:v(o)("theme.cssPlaceholder"),style:{width:"100%","margin-top":"10px"}},null,8,Gt),[[M,u.value]])])])])]),s("div",Qt,[s("div",Xt,i(e.$t("theme.importExport")),1),s("div",Yt,[s("div",Zt,[s("div",Kt,[s("button",{class:"btn btn-secondary big-btn",onClick:ye},i(e.$t("theme.exportPresets")),1),s("button",{class:"btn btn-secondary big-btn",onClick:Ce},i(e.$t("theme.importPresets")),1),s("input",{type:"file",ref_key:"importInput",ref:x,class:"hidden-input",accept:".json",onChange:we},null,544)])])])]),T(ze,{visible:w.value,"onUpdate:visible":t[12]||(t[12]=a=>w.value=a),title:_.title,bizType:_.bizType,type:"basic",onPreviewReady:K,onUploadComplete:ee},null,8,["visible","title","bizType"])]),_:1},8,["title"]))}},ns=ke(es,[["__scopeId","data-v-ab5c8ee5"]]);export{ns as default};
