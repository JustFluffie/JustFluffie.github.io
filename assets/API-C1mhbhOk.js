import{cc as ve,r as m,cd as z,_ as me,k as be,H as he,N as ge,m as fe,q as ke,E as we,s as _e,c as V,t as F,d as ye,w as D,y as s,a2 as xe,o as f,e,f as E,z as i,v as S,x as A,a as w,b as P,F as K,A as J,b$ as Pe,n as B,M as q}from"./index-BysHRnOZ.js";import{C as W}from"./CustomSelect-D40Rro3c.js";const Ce=ve("backup",()=>{const T=m(""),o=m(""),p=m(!1),g=m(null);function b(l={chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0}){const d={},r=localStorage.getItem("aiPhoneSingleChatData");if(r)try{const u=z.decompressFromUTF16(r),n=JSON.parse(u||r),c={};let h=!1;if(l.chat&&(c.messages=n.messages,h=!0),l.characters&&(c.characters=n.characters,c.userPersonas=n.userPersonas,c.favorites=n.favorites,h=!0),l.appearance&&(c.bubblePresets=n.bubblePresets,c.stickers=n.stickers,h=!0),h){const N=JSON.stringify(c),_=z.compressToUTF16(N);d.aiPhoneSingleChatData=_}}catch(u){console.error("Error processing single chat data for backup",u)}if(l.chat){const u=localStorage.getItem("aiPhoneMomentsData");u&&(d.aiPhoneMomentsData=u)}return l.settings&&["api_presets","api_activePresetName","api_imageHostProvider","api_imgbbApiKey","api_catboxUserHash","aiPhoneGlobalBackgroundActivity","aiPhoneGlobalProactiveScope","aiPhoneGlobalProactiveInterval","aiPhoneGlobalProactiveCooldown","aiPhoneGlobalProactiveDailyLimit","aiPhoneGlobalTriggerMode","aiPhoneGlobalProactiveIdleTime"].forEach(n=>{const c=localStorage.getItem(n);c!==null&&(d[n]=c)}),l.appearance&&["aiPhoneThemePresets","aiPhoneCurrentThemePreset","aiPhoneFontPresets","aiPhoneCurrentFontPreset","aiPhoneCssPresets","aiPhoneCurrentCssPreset"].forEach(n=>{const c=localStorage.getItem(n);c!==null&&(d[n]=c)}),l.worldbook&&["worldBooks","worldBookNextId"].forEach(n=>{const c=localStorage.getItem(n);c!==null&&(d[n]=c)}),JSON.stringify(d,null,2)}async function H(){if(T.value=localStorage.getItem("github_token")||"",!T.value){alert("请先设置 GitHub Token！");return}try{const l=await fetch("https://api.github.com/user/repos",{method:"POST",headers:{Authorization:`token ${T.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify({name:"phone-backup",private:!0,description:"Backup for Phone Vue App"})});if(l.ok){const d=await l.json();o.value=d.full_name,alert(`仓库 ${d.full_name} 创建成功！即将开始备份...`),await y()}else{const d=await l.json();if(d.errors&&d.errors[0].message==="name already exists on this account"){const r=await fetch("https://api.github.com/user",{headers:{Authorization:`token ${T.value}`}});if(r.ok){const u=await r.json();o.value=`${u.login}/phone-backup`,alert(`仓库已存在，已自动关联到 ${o.value}。即将开始备份...`),await y();return}}alert(`创建仓库失败: ${d.message}`)}}catch(l){console.error("Create repo failed:",l),alert(`创建仓库出错: ${l.message}`)}}async function y(){if(T.value=localStorage.getItem("github_token")||"",o.value=localStorage.getItem("github_repo")||"",!T.value||!o.value){alert("请先设置 GitHub Token 和仓库地址！");return}if(p.value){alert("正在备份中，请稍候...");return}p.value=!0,alert("开始备份...");try{const l=b(),d="phone_backup.json",[r,u]=o.value.split("/"),n=`https://api.github.com/repos/${r}/${u}/contents/${d}`;let c;try{const k=await fetch(n,{headers:{Authorization:`token ${T.value}`,Accept:"application/vnd.github.v3+json"}});k.ok&&(c=(await k.json()).sha)}catch{}const N={message:`Backup from phone-vue-app: ${new Date().toISOString()}`,content:btoa(l),sha:c},_=await fetch(n,{method:"PUT",headers:{Authorization:`token ${T.value}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},body:JSON.stringify(N)});if(_.ok)g.value=new Date,alert("备份成功！");else{const k=await _.json();console.error("GitHub API Error:",k),alert(`备份失败: ${k.message}`)}}catch(l){console.error("Backup to GitHub failed:",l),alert(`备份过程中发生错误: ${l.message}`)}finally{p.value=!1}}async function C(){alert("从 GitHub 恢复的功能尚未实现。")}function I(l){try{const d=b(l),r=new Blob([d],{type:"application/json"}),u=URL.createObjectURL(r),n=document.createElement("a");n.href=u,n.download=`phone_backup_${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(u),alert("备份文件已开始下载！")}catch(d){console.error("Export backup failed:",d),alert(`导出备份文件时出错: ${d.message}`)}}function U(){const l=document.createElement("input");l.type="file",l.accept="application/json",l.onchange=d=>{const r=d.target.files[0];if(!r)return;const u=new FileReader;u.onload=n=>{try{const c=JSON.parse(n.target.result);if(confirm("这将覆盖所有当前数据，确定要导入吗？")){localStorage.clear();for(const h in c)Object.hasOwnProperty.call(c,h)&&localStorage.setItem(h,c[h]);alert("数据导入成功！请刷新页面以应用更改。")}}catch(c){console.error("Import backup failed:",c),alert(`导入失败，请确保文件格式正确: ${c.message}`)}},u.readAsText(r)},l.click()}return{githubToken:T,githubRepo:o,isBackingUp:p,lastBackupTime:g,backupToGitHub:y,restoreFromGitHub:C,exportBackupFile:I,importBackupFile:U,createBackupRepo:H}}),Se={class:"card"},Be={class:"card-title"},Te={class:"card-content"},Ae={class:"api-item-row"},Ie={style:{flex:"1","min-width":"0"}},Ue={class:"api-item-col"},Ne={class:"form-label",for:"api-url"},$e=["placeholder"],De={class:"api-item-col"},He={class:"form-label",for:"api-key"},je=["placeholder"],Ge={class:"api-item-row"},Me={class:"list-item-title",style:{"font-weight":"normal","white-space":"nowrap"}},Fe={style:{flex:"1",display:"flex",gap:"10px","align-items":"center","min-width":"0"}},Oe={style:{flex:"1","min-width":"0",position:"relative"}},Re={key:0,value:"",disabled:""},Ee=["value"],Ve={class:"card"},Ke={class:"card-title"},Le={class:"card-title-note",style:{padding:"0 16px 10px","margin-top":"-10px",color:"var(--danger-color)"}},ze={class:"card-content"},Je={class:"api-item-row"},qe={class:"list-item-content"},We={class:"list-item-title"},Ze={class:"list-item-subtitle"},Qe={class:"api-item-row"},Xe={class:"list-item-content"},Ye={class:"list-item-title"},et={class:"api-item-row"},tt={class:"list-item-content"},ot={class:"list-item-title"},st={class:"api-item-row"},at={class:"list-item-content"},it={class:"list-item-title"},lt={class:"api-item-row"},nt={class:"list-item-content"},ct={class:"list-item-title"},rt={class:"api-item-row"},dt={class:"list-item-content"},pt={class:"list-item-title"},ut={class:"list-item-subtitle"},vt={class:"mode-selector"},mt={key:0,class:"api-item-row"},bt={class:"list-item-content"},ht={class:"list-item-title"},gt={class:"list-item-subtitle"},ft={class:"card"},kt={class:"card-title"},wt={class:"card-content"},_t={class:"api-item-row"},yt={class:"list-item-content"},xt={class:"list-item-title"},Pt={class:"list-item-subtitle"},Ct={class:"api-item-row"},St={class:"list-item-content"},Bt={class:"list-item-title"},Tt={class:"list-item-subtitle"},At={class:"card"},It={class:"card-title"},Ut={class:"card-content"},Nt={class:"api-item-col"},$t={class:"form-label",for:"github-token"},Dt={class:"input-hint"},Ht={style:{display:"flex",gap:"10px"}},jt=["placeholder"],Gt={class:"api-item-col"},Mt={class:"form-label",for:"github-repo"},Ft={style:{display:"flex",gap:"10px"}},Ot=["placeholder"],Rt=["disabled"],Et={class:"api-item-row"},Vt=["disabled"],Kt={key:0,style:{"font-size":"12px",color:"var(--text-tertiary)","margin-top":"10px"}},Lt={class:"card"},zt={class:"card-title"},Jt={class:"card-content"},qt={class:"api-item-row"},Wt={class:"list-item-content",style:{flex:"1","min-width":"0"}},Zt={class:"list-item-title"},Qt={class:"list-item-subtitle"},Xt={style:{width:"120px","flex-shrink":"0"}},Yt={class:"api-item-col"},eo={class:"form-label",for:"imgbb-api-key"},to={class:"input-hint"},oo={style:{display:"flex",gap:"10px"}},so=["placeholder"],ao={class:"api-item-col"},io={class:"form-label",for:"catbox-hash"},lo={class:"input-hint"},no={style:{display:"flex",gap:"10px"}},co=["placeholder"],ro={class:"card"},po={class:"card-title"},uo={class:"card-content"},vo={style:{"font-size":"13px",color:"var(--text-tertiary)","margin-bottom":"15px"}},mo={class:"api-item-row",style:{"border-bottom":"none","padding-bottom":"0"}},bo={class:"scope-list"},ho={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},go={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},fo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},ko={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},wo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},_o={class:"scope-list",style:{"max-height":"300px","overflow-y":"auto"}},yo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},xo={class:"scope-name"},Po=["onClick"],Co={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},So={class:"scope-name"},Bo={__name:"API",setup(T){const{t:o}=be(),p=he(),g=ge(),b=Ce(),H=fe(),y=ke(),C=we(),I=m(""),U=m(""),l=m(""),d=m(!1),r=m([]),u=m(5),n=m(30),c=m(10),h=m("always"),N=m(15),_=m(""),k=m(""),$=m("catbox"),j=m(""),G=m(""),Z=m([{value:"catbox",label:"Catbox"},{value:"imgbb",label:"ImgBB"}]);_e(()=>{d.value=g.globalBackgroundActivity,r.value=[...g.globalProactiveScope||[]],u.value=g.globalProactiveInterval,n.value=g.globalProactiveCooldown,c.value=g.globalProactiveDailyLimit,h.value=g.globalTriggerMode,N.value=g.globalProactiveIdleTime,_.value=localStorage.getItem("github_token")||"",k.value=localStorage.getItem("github_repo")||"",$.value=p.imageHostProvider,j.value=p.imgbbApiKey,G.value=p.catboxUserHash});const Q=V(()=>p.presets.find(v=>v.name===p.activePresetName)||null);F(Q,v=>{v&&(I.value=v.apiKey,U.value=v.apiUrl,l.value=v.model)},{immediate:!0,deep:!0}),F([I,U,l],()=>{p.activePresetName&&p.addPreset(p.activePresetName,{apiKey:I.value,apiUrl:U.value,model:l.value})}),F([d,r,u,n,c,h,N],()=>{g.globalBackgroundActivity=d.value,g.globalProactiveScope=r.value,g.globalProactiveInterval=u.value,g.globalProactiveCooldown=n.value,g.globalProactiveDailyLimit=c.value,g.globalTriggerMode=h.value,g.globalProactiveIdleTime=N.value},{deep:!0}),F([_,k],()=>{b.githubToken=_.value,b.githubRepo=k.value,localStorage.setItem("github_token",_.value),localStorage.setItem("github_repo",k.value)}),F([$,j,G],()=>{p.imageHostProvider=$.value,p.imgbbApiKey=j.value,p.catboxUserHash=G.value},{deep:!0});function X(){y.showToast(o("api.toast.settingsSaved"))}function Y(){y.showInput(o("api.prompt.saveAsPreset"),"",v=>{v&&(p.addPreset(v,{apiKey:I.value,apiUrl:U.value,model:l.value}),y.showToast(o("api.toast.presetSaved",{name:v})))},o("api.prompt.enterPresetName"))}function ee(){y.showConfirm(o("api.confirm.deletePreset"),o("api.confirm.deletePresetMsg",{name:p.activePresetName}),()=>{p.deletePreset(p.activePresetName),y.showToast(o("api.toast.presetDeleted"))})}async function te(){const v={apiUrl:U.value,apiKey:I.value};await p.fetchModels(v)}const oe=V(()=>{switch(C.permission){case"granted":return o("api.notificationsGranted");case"denied":return o("api.notificationsDenied");default:return o("api.notificationsDefault")}}),se=()=>{C.permission!=="granted"?C.requestPermission():C.desktopNotificationsEnabled=!C.desktopNotificationsEnabled},ae=()=>{if(!C.desktopNotificationsEnabled){y.showToast("请先开启“桌面通知”开关。","warning");return}if(C.permission!=="granted"){y.showToast("浏览器通知权限未授予，请点击开关重新授权。","warning");return}y.showToast("测试通知已发送，请检查系统通知。"),C.triggerNotification("测试通知","如果看到此消息，说明桌面通知功能正常。","/pwa-192x192.png",()=>{console.log("Test notification clicked!")})},ie=async()=>{b.githubToken=_.value,await b.createBackupRepo(),k.value=b.githubRepo},le=async()=>{b.githubToken=_.value,b.githubRepo=k.value,await b.backupToGitHub()};function ne(){window.open("https://github.com/settings/tokens/new?scopes=repo&description=Phone%20App%20Backup","_blank")}function ce(){window.open("https://api.imgbb.com/","_blank")}function re(){window.open("https://catbox.moe/user/","_blank")}function de(){y.showConfirm("确认清除所有数据？","此操作将永久删除所有本地存储的数据（包括聊天记录、API设置、背景图片等）。应用将重置为初始状态。请确保您已备份重要数据。",()=>{localStorage.clear(),window.location.reload()},{messageStyle:{color:"#FF3B30"},confirmText:"清除"})}const O=m(!1),x=m({chat:!0,characters:!0,settings:!0,appearance:!0,worldbook:!0});function M(v){x.value[v]=!x.value[v]}function pe(){b.exportBackupFile(x.value),O.value=!1}const R=m(!1),ue=V(()=>{const v=r.value||[];return v.includes("all")?o("api.scopeAll"):v.length===0?o("api.scopeNone"):o("api.scopeSelected",{count:v.length})});function L(v){const t=r.value;if(v==="all")t.includes("all")?r.value=[]:r.value=["all"];else if(t.includes("all"))r.value=[v];else{const a=t.indexOf(v);a>-1?t.splice(a,1):t.push(v),H.characters.length>0&&t.length===H.characters.length&&(r.value=["all"])}}return(v,t)=>(f(),ye(xe,{title:s(o)("api.title")},{action:D(()=>[e("button",{class:"header-save-btn",onClick:X},i(s(o)("save")),1)]),default:D(()=>[e("div",Se,[e("div",Be,i(s(o)("api.globalConfig")),1),e("div",Te,[e("div",Ae,[e("div",Ie,[E(W,{"model-value":s(p).activePresetName,options:s(p).presets.map(a=>({value:a.name,label:a.name})),"onUpdate:modelValue":t[0]||(t[0]=a=>s(p).switchPreset(a)),textAlign:"left",style:{width:"100%"}},null,8,["model-value","options"])]),e("button",{class:"btn btn-secondary btn-sm",onClick:Y},i(s(o)("api.saveAs")),1),e("button",{class:"btn btn-danger-light btn-sm",onClick:ee},i(s(o)("delete")),1)]),e("div",Ue,[e("label",Ne,i(s(o)("api.apiUrl")),1),S(e("input",{type:"text",id:"api-url",class:"base-input","onUpdate:modelValue":t[1]||(t[1]=a=>U.value=a),placeholder:s(o)("api.apiUrlPlaceholder"),autocomplete:"off"},null,8,$e),[[A,U.value]])]),e("div",De,[e("label",He,i(s(o)("api.apiKey")),1),S(e("input",{type:"password",id:"api-key",class:"base-input","onUpdate:modelValue":t[2]||(t[2]=a=>I.value=a),placeholder:s(o)("api.apiKeyPlaceholder"),autocomplete:"off"},null,8,je),[[A,I.value]])]),e("div",Ge,[e("div",Me,i(s(o)("api.model")),1),e("div",Fe,[e("div",Oe,[S(e("select",{class:"native-select","onUpdate:modelValue":t[3]||(t[3]=a=>l.value=a)},[s(p).models.length===0?(f(),w("option",Re,i(s(o)("api.modelPlaceholder")),1)):P("",!0),(f(!0),w(K,null,J(s(p).models,a=>(f(),w("option",{key:a,value:a},i(a),9,Ee))),128))],512),[[Pe,l.value]]),t[29]||(t[29]=e("div",{class:"select-arrow"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"6 9 12 15 18 9"})])],-1))]),e("button",{class:"btn btn-secondary btn-sm",onClick:te,style:{"white-space":"nowrap"}},i(s(o)("api.fetch")),1)])])])]),e("div",Ve,[e("div",Ke,i(s(o)("api.backgroundActivity")),1),e("div",Le,i(s(o)("api.backgroundActivityWarning")),1),e("div",ze,[e("div",Je,[e("div",qe,[e("div",We,i(s(o)("api.proactiveMessages")),1),e("div",Ze,i(s(o)("api.proactiveMessagesDesc")),1)]),e("div",{class:B(["toggle-switch",{active:d.value}]),onClick:t[4]||(t[4]=a=>d.value=!d.value)},null,2)]),d.value?(f(),w(K,{key:0},[e("div",Qe,[e("div",Xe,[e("div",Ye,i(s(o)("api.scope")),1)]),e("div",{class:"scope-selector",onClick:t[5]||(t[5]=a=>R.value=!0)},[e("span",null,i(ue.value),1),t[30]||(t[30]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"9 18 15 12 9 6"})],-1))])]),e("div",et,[e("div",tt,[e("div",ot,i(s(o)("api.interval")),1)]),S(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>u.value=a),class:"base-input base-input-short",placeholder:"5",autocomplete:"off"},null,512),[[A,u.value,void 0,{number:!0}]])]),e("div",st,[e("div",at,[e("div",it,i(s(o)("api.cooldown")),1)]),S(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>n.value=a),class:"base-input base-input-short",placeholder:"30",autocomplete:"off"},null,512),[[A,n.value,void 0,{number:!0}]])]),e("div",lt,[e("div",nt,[e("div",ct,i(s(o)("api.dailyLimit")),1)]),S(e("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>c.value=a),class:"base-input base-input-short",placeholder:"10",autocomplete:"off"},null,512),[[A,c.value,void 0,{number:!0}]])]),e("div",rt,[e("div",dt,[e("div",pt,i(s(o)("api.triggerMode")),1),e("div",ut,i(s(o)("api.triggerModeIdleHint")),1)]),e("div",vt,[e("div",{class:B(["mode-option",{active:h.value==="idle"}]),onClick:t[9]||(t[9]=a=>h.value="idle")},i(s(o)("api.triggerModeIdle")),3),e("div",{class:B(["mode-option",{active:h.value==="always"}]),onClick:t[10]||(t[10]=a=>h.value="always")},i(s(o)("api.triggerModeAlways")),3)])]),h.value==="idle"?(f(),w("div",mt,[e("div",bt,[e("div",ht,i(s(o)("api.idleTime")),1),e("div",gt,i(s(o)("api.idleTimeDesc")),1)]),S(e("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=a=>N.value=a),class:"base-input base-input-short",placeholder:"15",autocomplete:"off"},null,512),[[A,N.value,void 0,{number:!0}]])])):P("",!0)],64)):P("",!0)])]),e("div",ft,[e("div",kt,i(s(o)("api.notificationSettings")),1),e("div",wt,[e("div",_t,[e("div",yt,[e("div",xt,i(s(o)("api.desktopNotifications")),1),e("div",Pt,i(oe.value),1)]),e("div",{class:B(["toggle-switch",{active:s(C).desktopNotificationsEnabled}]),onClick:se},null,2)]),e("div",Ct,[e("div",St,[e("div",Bt,i(s(o)("api.testNotification")),1),e("div",Tt,i(s(o)("api.testNotificationDesc")),1)]),e("button",{class:"btn btn-secondary btn-sm",onClick:ae},i(s(o)("api.test")),1)])])]),e("div",At,[e("div",It,i(s(o)("api.githubBackup")),1),e("div",Ut,[e("div",Nt,[e("label",$t,i(s(o)("api.githubToken")),1),e("div",Dt,i(s(o)("api.githubTokenHint")),1),e("div",Ht,[S(e("input",{type:"password",id:"github-token",class:"base-input small-placeholder","onUpdate:modelValue":t[12]||(t[12]=a=>_.value=a),placeholder:s(o)("api.githubTokenPlaceholder"),style:{flex:"1"},autocomplete:"off"},null,8,jt),[[A,_.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ne},i(s(o)("api.getToken")),1)])]),e("div",Gt,[e("label",Mt,i(s(o)("api.repoAddress")),1),e("div",Ft,[S(e("input",{type:"text",id:"github-repo",class:"base-input","onUpdate:modelValue":t[13]||(t[13]=a=>k.value=a),placeholder:s(o)("api.repoAddressPlaceholder"),style:{flex:"1"},autocomplete:"off"},null,8,Ot),[[A,k.value]]),k.value?P("",!0):(f(),w("button",{key:0,class:"btn btn-secondary btn-sm",onClick:ie,disabled:!_.value},i(s(o)("api.createRepo")),9,Rt))])]),e("div",Et,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:le,disabled:s(b).isBackingUp},i(s(b).isBackingUp?s(o)("api.backingUp"):s(o)("api.backupNow")),9,Vt),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[14]||(t[14]=(...a)=>s(b).restoreFromGitHub&&s(b).restoreFromGitHub(...a))},i(s(o)("api.restoreBackup")),1)]),s(b).lastBackupTime?(f(),w("p",Kt,i(s(o)("api.lastBackup"))+" "+i(new Date(s(b).lastBackupTime).toLocaleString()),1)):P("",!0)])]),e("div",Lt,[e("div",zt,i(s(o)("api.imageHost")),1),e("div",Jt,[e("div",qt,[e("div",Wt,[e("div",Zt,i(s(o)("api.defaultImageHost")),1),e("div",Qt,i(s(o)("api.defaultImageHostDesc")),1)]),e("div",Xt,[E(W,{"model-value":$.value,options:Z.value,"onUpdate:modelValue":t[15]||(t[15]=a=>$.value=a),textAlign:"right"},null,8,["model-value","options"])])]),e("div",Yt,[e("label",eo,i(s(o)("api.imgbbApiKey")),1),e("div",to,i(s(o)("api.imgbbApiKeyHint")),1),e("div",oo,[S(e("input",{type:"password",id:"imgbb-api-key",class:"base-input small-placeholder","onUpdate:modelValue":t[16]||(t[16]=a=>j.value=a),placeholder:s(o)("api.imgbbApiKeyPlaceholder"),style:{flex:"1"},autocomplete:"off"},null,8,so),[[A,j.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:ce},i(s(o)("api.getImgbbApiKey")),1)])]),e("div",ao,[e("label",io,i(s(o)("api.catboxUserHash")),1),e("div",lo,i(s(o)("api.catboxUserHashHint")),1),e("div",no,[S(e("input",{type:"text",id:"catbox-hash",class:"base-input small-placeholder","onUpdate:modelValue":t[17]||(t[17]=a=>G.value=a),placeholder:s(o)("api.catboxUserHashPlaceholder"),style:{flex:"1"},autocomplete:"off"},null,8,co),[[A,G.value]]),e("button",{class:"btn btn-secondary btn-sm",onClick:re},i(s(o)("api.getCatboxUserHash")),1)])])])]),e("div",ro,[e("div",po,i(s(o)("api.dataBackup")),1),e("div",uo,[e("p",vo,i(s(o)("api.dataBackupDesc")),1),e("div",mo,[e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[18]||(t[18]=a=>O.value=!0)},i(s(o)("api.exportBackupFile")),1),e("button",{class:"btn btn-secondary",style:{flex:"1"},onClick:t[19]||(t[19]=(...a)=>s(b).importBackupFile&&s(b).importBackupFile(...a))},i(s(o)("api.importBackupFile")),1)])])]),e("div",{class:"danger-zone"},[e("button",{class:"btn btn-danger big-btn",onClick:de},[...t[31]||(t[31]=[e("div",{class:"danger-btn-content"},[e("div",{class:"danger-btn-title"},"清除所有数据"),e("div",{class:"danger-btn-desc"},"此操作将清除所有聊天记录、设置和本地数据，且无法恢复")],-1)])])]),E(q,{visible:O.value,"onUpdate:visible":t[25]||(t[25]=a=>O.value=a),title:"导出选项",bodyClass:"no-padding"},{footer:D(()=>[e("button",{class:"modal-btn confirm",onClick:pe},"确认导出")]),default:D(()=>[e("div",bo,[e("div",{class:"scope-item",onClick:t[20]||(t[20]=a=>M("chat"))},[e("div",{class:B(["scope-checkbox",{checked:x.value.chat}])},[x.value.chat?(f(),w("svg",ho,[...t[32]||(t[32]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),t[33]||(t[33]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"聊天数据"),e("span",{class:"scope-desc"},"包含聊天记录和朋友圈")],-1))]),e("div",{class:"scope-item",onClick:t[21]||(t[21]=a=>M("characters"))},[e("div",{class:B(["scope-checkbox",{checked:x.value.characters}])},[x.value.characters?(f(),w("svg",go,[...t[34]||(t[34]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),t[35]||(t[35]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"角色数据"),e("span",{class:"scope-desc"},"包含角色卡片、用户人设和收藏")],-1))]),e("div",{class:"scope-item",onClick:t[22]||(t[22]=a=>M("settings"))},[e("div",{class:B(["scope-checkbox",{checked:x.value.settings}])},[x.value.settings?(f(),w("svg",fo,[...t[36]||(t[36]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),t[37]||(t[37]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"API设置"),e("span",{class:"scope-desc"},"包含API配置、图床、后台设置")],-1))]),e("div",{class:"scope-item",onClick:t[23]||(t[23]=a=>M("appearance"))},[e("div",{class:B(["scope-checkbox",{checked:x.value.appearance}])},[x.value.appearance?(f(),w("svg",ko,[...t[38]||(t[38]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),t[39]||(t[39]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"外观主题"),e("span",{class:"scope-desc"},"包含主题、字体、气泡样式")],-1))]),e("div",{class:"scope-item",onClick:t[24]||(t[24]=a=>M("worldbook"))},[e("div",{class:B(["scope-checkbox",{checked:x.value.worldbook}])},[x.value.worldbook?(f(),w("svg",wo,[...t[40]||(t[40]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),t[41]||(t[41]=e("div",{class:"scope-content"},[e("span",{class:"scope-name"},"世界书"),e("span",{class:"scope-desc"},"包含世界书设定")],-1))])])]),_:1},8,["visible"]),E(q,{visible:R.value,"onUpdate:visible":t[28]||(t[28]=a=>R.value=a),title:s(o)("api.selectScope"),bodyClass:"no-padding"},{footer:D(()=>[e("button",{class:"modal-btn confirm",onClick:t[27]||(t[27]=a=>R.value=!1)},i(s(o)("confirm")),1)]),default:D(()=>[e("div",_o,[e("div",{class:"scope-item",onClick:t[26]||(t[26]=a=>L("all"))},[e("div",{class:B(["scope-checkbox",{checked:r.value&&r.value.includes("all")}])},[r.value&&r.value.includes("all")?(f(),w("svg",yo,[...t[42]||(t[42]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),e("span",xo,i(s(o)("api.scopeAll")),1)]),(f(!0),w(K,null,J(s(H).characters,a=>(f(),w("div",{key:a.id,class:"scope-item",onClick:To=>L(a.id)},[e("div",{class:B(["scope-checkbox",{checked:r.value&&r.value.includes(a.id)}])},[r.value&&r.value.includes(a.id)?(f(),w("svg",Co,[...t[43]||(t[43]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):P("",!0)],2),e("span",So,i(a.name),1)],8,Po))),128))])]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},Uo=me(Bo,[["__scopeId","data-v-6f4f1742"]]);export{Uo as default};
