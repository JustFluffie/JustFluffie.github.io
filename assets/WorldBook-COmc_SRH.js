import{_ as $,q as N,Z as M,R as z,c as V,r as D,l as R,h as _,j as a,a6 as T,o as m,f as d,b as y,e as k,d as e,S as c,E as j,B as p,n as C,M as q}from"./index-BT_lx314.js";import{C as A}from"./CustomSelect-DlX1dbXA.js";import{d as I}from"./vuedraggable.umd-C3Yw9sHi.js";const H={class:"card"},Z={class:"card-header"},F={class:"book-drag-handle icon-btn"},G=["value","onInput","placeholder"],J={class:"header-controls"},K=["onClick"],L={key:0,class:"card-content"},Q={class:"content-controls"},X={class:"priority-selector"},Y={class:"card-actions"},ee=["onClick"],oe=["onClick"],te={class:"entry-header"},le={class:"entry-drag-handle icon-btn"},ne=["value","onInput","placeholder"],ae={class:"entry-controls"},se=["onClick"],de=["onClick"],re={key:0,class:"entry-content"},ie=["value","onInput","placeholder"],ce=["value","onInput","placeholder"],ue={key:0,class:"empty-state"},pe={style:{"text-align":"center","padding-bottom":"25px"}},_e={__name:"WorldBook",setup(he){const{t}=N(),i=M(),{sortedWorldBooks:S}=z(i),O=V(()=>[{value:"1",label:t("worldbook.priorityOptions.high")},{value:"2",label:t("worldbook.priorityOptions.medium")},{value:"3",label:t("worldbook.priorityOptions.low")}]),g=l=>{switch(String(l)){case"1":return{label:t("worldbook.priorityOptions.high"),color:"red"};case"2":return{label:t("worldbook.priorityOptions.medium"),color:"blue"};case"3":return{label:t("worldbook.priorityOptions.low"),color:"green"};default:return{label:"",color:""}}},w=V({get:()=>S.value,set:l=>{}}),v=D(!1),f=D({type:null,bookIndex:null,entryIndex:null}),B=(l,s,o=null)=>{f.value={type:l,bookIndex:s,entryIndex:o},v.value=!0},W=()=>{const{type:l,bookIndex:s,entryIndex:o}=f.value;l==="book"?i.deleteWorldBook(s):l==="entry"&&i.deleteEntry(s,o),x()},x=()=>{v.value=!1,f.value={type:null,bookIndex:null,entryIndex:null}},E=(l,s)=>{i.updateBook(l,s)},b=(l,s,o)=>{i.updateEntry(l,s,o)},P=(l,s)=>{i.reorderEntries(l,{oldIndex:s.oldIndex,newIndex:s.newIndex})},U=l=>{i.onBookDragEnd({oldIndex:l.oldIndex,newIndex:l.newIndex})};return(l,s)=>(m(),R(T,{title:a(t)("worldbook.title")},{action:_(()=>[d(c,{name:"plus",onClick:a(i).addNewWorldBook,class:"header-action-icon"},null,8,["onClick"])]),default:_(()=>[d(a(I),{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=o=>w.value=o),"item-key":"id",handle:".book-drag-handle",onEnd:U},{item:_(({element:o,index:r})=>[e("div",H,[e("div",Z,[e("button",F,[d(c,{name:"drag-handle"})]),g(o.priority).label?(m(),y("span",{key:0,style:j({color:g(o.priority).color,marginRight:"8px",fontWeight:"bold",fontSize:"1.2em"})},p(g(o.priority).label),5)):k("",!0),e("input",{type:"text",value:o.title,onInput:n=>E(r,{title:n.target.value}),placeholder:a(t)("worldbook.titlePlaceholder"),class:"book-title-input"},null,40,G),e("div",J,[e("button",{onClick:n=>E(r,{collapsed:!o.collapsed}),class:"collapse-btn icon-btn"},[d(c,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:o.collapsed}])},null,8,["class"])],8,K)])]),o.collapsed?k("",!0):(m(),y("div",L,[e("div",Q,[e("div",X,[e("span",null,p(a(t)("worldbook.priority")),1),d(A,{class:"priority-custom-select",modelValue:String(o.priority),"onUpdate:modelValue":n=>a(i).setPriority(r,n),options:O.value,textAlign:"center"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Y,[e("button",{onClick:n=>a(i).addNewEntry(r),class:"add-entry-btn icon-btn"},[d(c,{name:"plus"})],8,ee),e("button",{onClick:n=>B("book",r),class:"delete-btn icon-btn"},[d(c,{name:"trash"})],8,oe)])]),d(a(I),{modelValue:o.entries,"onUpdate:modelValue":n=>o.entries=n,"item-key":"id",handle:".entry-drag-handle",onEnd:n=>P(r,n)},{item:_(({element:n,index:h})=>[e("div",{class:C(["entry-item",{disabled:!o.enabled}])},[e("div",te,[e("button",le,[d(c,{name:"drag-handle"})]),e("input",{type:"text",value:n.title,onInput:u=>b(r,h,{title:u.target.value}),placeholder:a(t)("worldbook.entryTitlePlaceholder"),class:"entry-title-input"},null,40,ne),e("div",ae,[e("button",{onClick:u=>B("entry",r,h),class:"delete-btn icon-btn"},[d(c,{name:"trash"})],8,se),e("button",{onClick:u=>b(r,h,{collapsed:!n.collapsed}),class:"collapse-btn icon-btn"},[d(c,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:n.collapsed}])},null,8,["class"])],8,de)])]),n.collapsed?k("",!0):(m(),y("div",re,[e("input",{type:"text",value:n.notes,onInput:u=>b(r,h,{notes:u.target.value}),placeholder:a(t)("worldbook.notesPlaceholder"),class:"base-input"},null,40,ie),e("textarea",{value:n.content,onInput:u=>b(r,h,{content:u.target.value}),placeholder:a(t)("worldbook.contentPlaceholder"),class:"base-input"},null,40,ce)]))],2)]),_:2},1032,["modelValue","onUpdate:modelValue","onEnd"])]))])]),_:1},8,["modelValue"]),w.value.length?k("",!0):(m(),y("div",ue,[e("p",null,p(a(t)("worldbook.empty")),1),e("p",null,p(a(t)("worldbook.emptyHint")),1)])),d(q,{visible:v.value,"onUpdate:visible":s[1]||(s[1]=o=>v.value=o),title:a(t)("worldbook.confirmDelete")},{footer:_(()=>[e("button",{onClick:x,class:"modal-btn cancel"},p(a(t)("cancel")),1),e("button",{onClick:W,class:"modal-btn danger"},p(a(t)("delete")),1)]),default:_(()=>[e("div",pe,p(a(t)("worldbook.confirmDeleteMsg")),1)]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},ye=$(_e,[["__scopeId","data-v-471f1422"]]);export{ye as default};
