import{_ as $,q as N,a0 as M,R as z,c as V,r as D,l as R,h,j as a,a7 as T,o as _,f as r,b as y,e as k,d as e,S as i,E as j,B as p,n as C,M as q}from"./index-BmT1rz7L.js";import{C as A}from"./CustomSelect-Dvrhg3LT.js";import{d as I}from"./vuedraggable.umd-BQ0Tc-pt.js";const H={class:"card"},F={class:"card-header"},G={class:"book-drag-handle icon-btn"},J=["value","onInput","placeholder"],K={class:"header-controls"},L=["onClick"],Q={key:0,class:"card-content"},X={class:"content-controls"},Y={class:"priority-selector"},Z={class:"card-actions"},ee=["onClick"],te=["onClick"],oe={class:"entry-header"},le={class:"entry-drag-handle icon-btn"},ne=["value","onInput","placeholder"],ae={class:"entry-controls"},se=["onClick"],re=["onClick"],de={key:0,class:"entry-content"},ce=["value","onInput","placeholder"],ie=["value","onInput","placeholder"],ue={key:0,class:"empty-state"},pe={style:{"text-align":"center","padding-bottom":"25px"}},he={__name:"WorldBook",setup(me){const{t:o}=N(),c=M(),{sortedWorldBooks:S}=z(c),O=V(()=>[{value:"1",label:o("worldbook.priorityOptions.high")},{value:"2",label:o("worldbook.priorityOptions.medium")},{value:"3",label:o("worldbook.priorityOptions.low")}]),g=l=>{switch(String(l)){case"1":return{label:o("worldbook.priorityOptions.high"),color:"red"};case"2":return{label:o("worldbook.priorityOptions.medium"),color:"blue"};case"3":return{label:o("worldbook.priorityOptions.low"),color:"green"};default:return{label:"",color:""}}},w=V({get:()=>S.value,set:l=>{}}),v=D(!1),f=D({type:null,bookIndex:null,entryIndex:null}),B=(l,s,t=null)=>{f.value={type:l,bookIndex:s,entryIndex:t},v.value=!0},W=()=>{const{type:l,bookIndex:s,entryIndex:t}=f.value;l==="book"?c.deleteWorldBook(s):l==="entry"&&c.deleteEntry(s,t),x()},x=()=>{v.value=!1,f.value={type:null,bookIndex:null,entryIndex:null}},E=(l,s)=>{c.updateBook(l,s)},b=(l,s,t)=>{c.updateEntry(l,s,t)},P=(l,s)=>{c.reorderEntries(l,{oldIndex:s.oldIndex,newIndex:s.newIndex})},U=l=>{c.onBookDragEnd({oldIndex:l.oldIndex,newIndex:l.newIndex})};return(l,s)=>(_(),R(T,{title:a(o)("worldbook.title")},{action:h(()=>[r(i,{name:"plus",onClick:a(c).addNewWorldBook,class:"header-action-icon"},null,8,["onClick"])]),default:h(()=>[r(a(I),{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=t=>w.value=t),"item-key":"id",handle:".book-drag-handle",onEnd:U,animation:"200","ghost-class":"ghost-card","force-fallback":!0},{item:h(({element:t,index:d})=>[e("div",H,[e("div",F,[e("button",G,[r(i,{name:"drag-handle"})]),g(t.priority).label?(_(),y("span",{key:0,style:j({color:g(t.priority).color,marginRight:"8px",fontWeight:"bold",fontSize:"1.2em"})},p(g(t.priority).label),5)):k("",!0),e("input",{type:"text",value:t.title,onInput:n=>E(d,{title:n.target.value}),placeholder:a(o)("worldbook.titlePlaceholder"),class:"book-title-input"},null,40,J),e("div",K,[e("button",{onClick:n=>E(d,{collapsed:!t.collapsed}),class:"collapse-btn icon-btn"},[r(i,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:t.collapsed}])},null,8,["class"])],8,L)])]),t.collapsed?k("",!0):(_(),y("div",Q,[e("div",X,[e("div",Y,[e("span",null,p(a(o)("worldbook.priority")),1),r(A,{class:"priority-custom-select",modelValue:String(t.priority),"onUpdate:modelValue":n=>a(c).setPriority(d,n),options:O.value,textAlign:"center"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Z,[e("button",{onClick:n=>a(c).addNewEntry(d),class:"add-entry-btn icon-btn"},[r(i,{name:"plus"})],8,ee),e("button",{onClick:n=>B("book",d),class:"delete-btn icon-btn"},[r(i,{name:"trash"})],8,te)])]),r(a(I),{modelValue:t.entries,"onUpdate:modelValue":n=>t.entries=n,"item-key":"id",handle:".entry-drag-handle",onEnd:n=>P(d,n),animation:"200","ghost-class":"ghost-entry","force-fallback":!0},{item:h(({element:n,index:m})=>[e("div",{class:C(["entry-item",{disabled:!t.enabled}])},[e("div",oe,[e("button",le,[r(i,{name:"drag-handle"})]),e("input",{type:"text",value:n.title,onInput:u=>b(d,m,{title:u.target.value}),placeholder:a(o)("worldbook.entryTitlePlaceholder"),class:"entry-title-input"},null,40,ne),e("div",ae,[e("button",{onClick:u=>B("entry",d,m),class:"delete-btn icon-btn"},[r(i,{name:"trash"})],8,se),e("button",{onClick:u=>b(d,m,{collapsed:!n.collapsed}),class:"collapse-btn icon-btn"},[r(i,{name:"chevron-down",class:C(["collapse-arrow",{collapsed:n.collapsed}])},null,8,["class"])],8,re)])]),n.collapsed?k("",!0):(_(),y("div",de,[e("input",{type:"text",value:n.notes,onInput:u=>b(d,m,{notes:u.target.value}),placeholder:a(o)("worldbook.notesPlaceholder"),class:"base-input"},null,40,ce),e("textarea",{value:n.content,onInput:u=>b(d,m,{content:u.target.value}),placeholder:a(o)("worldbook.contentPlaceholder"),class:"base-input"},null,40,ie)]))],2)]),_:2},1032,["modelValue","onUpdate:modelValue","onEnd"])]))])]),_:1},8,["modelValue"]),w.value.length?k("",!0):(_(),y("div",ue,[e("p",null,p(a(o)("worldbook.empty")),1),e("p",null,p(a(o)("worldbook.emptyHint")),1)])),r(q,{visible:v.value,"onUpdate:visible":s[1]||(s[1]=t=>v.value=t),title:a(o)("worldbook.confirmDelete")},{footer:h(()=>[e("button",{onClick:x,class:"modal-btn cancel"},p(a(o)("cancel")),1),e("button",{onClick:W,class:"modal-btn danger"},p(a(o)("delete")),1)]),default:h(()=>[e("div",pe,p(a(o)("worldbook.confirmDeleteMsg")),1)]),_:1},8,["visible","title"])]),_:1},8,["title"]))}},ye=$(he,[["__scopeId","data-v-ced36c73"]]);export{ye as default};
